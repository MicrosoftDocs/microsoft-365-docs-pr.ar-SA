---
title: التحقق من الكيانات على الأجهزة باستخدام الاستجابة المباشرة في Microsoft Defender لنقطة النهاية
description: الوصول إلى جهاز باستخدام اتصال shell آمن عن بعد للقيام بعمل التحقيق واتخاذ إجراءات استجابة فورية على جهاز في الوقت الحقيقي.
keywords: البعيد، shell، الاتصال، المباشر، الاستجابة، الوقت الحقيقي، الأمر، البرنامج النصي، المعالجة، البحث، التصدير، السجل، إسقاط، تنزيل، ملف،
ms.prod: m365-security
ms.mktglfcycl: deploy
ms.sitesec: library
ms.pagetype: security
ms.author: macapara
author: mjcaparas
ms.localizationpriority: medium
manager: dansimp
audience: ITPro
ms.collection: M365-security-compliance
ms.topic: article
ms.technology: mde
ms.openlocfilehash: 882454e00517624c3bc43e87308007b00ece9507
ms.sourcegitcommit: 2697938d2d4fec523b501c5e7b0b8ec8f34e59b0
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 03/12/2022
ms.locfileid: "63570390"
---
# <a name="investigate-entities-on-devices-using-live-response"></a>التحقق من الكيانات على الأجهزة باستخدام الاستجابة المباشرة

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]

**ينطبق على:**
- [خطة Microsoft Defender لنقطة النهاية 2](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)


> هل تريد تجربة Defender لنقطة النهاية؟ [التسجيل للحصول على تجربة مجانية.](https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-investigateip-abovefoldlink)

توفر الاستجابة المباشرة لفرق عمليات الأمان إمكانية الوصول الفوري إلى جهاز (يشار إليه أيضا بالآلة) باستخدام اتصال shell عن بعد. يمنحك ذلك القدرة على القيام بعمل تحقيقي معمق واتخاذ إجراءات استجابة فورية لاحتواء التهديدات المحددة في الوقت الحقيقي على الفور.

تم تصميم الاستجابة المباشرة لتحسين عمليات البحث من خلال تمكين فريق عمليات الأمان من تجميع بيانات الطب الشرعي وتشغيل البرامج النصية وإرسال الكيانات المريبة للتحليل، والاستجابة للتهديدات، والصيد الاستباقي للتهديدات الناشئة.

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE4qLUW]

باستخدام الاستجابة المباشرة، يمكن للمحللين تنفيذ كل المهام التالية:

- تشغيل الأوامر الأساسية والمتقدمة للقيام بعمل التحقق على جهاز.
- قم بتنزيل ملفات مثل عينات البرامج الضارة ونتائج برامج PowerShell النصية.
- تنزيل الملفات في الخلفية (جديد!).
- Upload برنامج PowerShell النصي أو قابل للتنفيذ في المكتبة وتشغيله على جهاز من مستوى مستأجر.
- اتخاذ إجراءات المعالجة أو التراجع عنها.

## <a name="before-you-begin"></a>قبل البدء

قبل أن تتمكن من بدء جلسة عمل على جهاز، تأكد من استيفاء المتطلبات التالية:

- **تحقق من أنك تقوم بتشغيل إصدار** معتمد من Windows.

  يجب أن تكون الأجهزة قيد تشغيل أحد الإصدارات التالية من Windows

  - **Windows 10 & 11**
    - [الإصدار 1909 أو](/windows/whats-new/whats-new-windows-10-version-1909) الإصدارات الأحدث
    - [الإصدار 1903 مع](/windows/whats-new/whats-new-windows-10-version-1903) [KB4515384](https://support.microsoft.com/help/4515384/windows-10-update-kb4515384)
    - [الإصدار 1809 (RS 5)](/windows/whats-new/whats-new-windows-10-version-1809) مع [KB4537818](https://support.microsoft.com/help/4537818/windows-10-update-kb4537818)
    - [الإصدار 1803 (RS 4)](/windows/whats-new/whats-new-windows-10-version-1803) مع [KB4537795](https://support.microsoft.com/help/4537795/windows-10-update-kb4537795)
    - [الإصدار 1709 (RS 3)](/windows/whats-new/whats-new-windows-10-version-1709) مع [KB4537816](https://support.microsoft.com/help/4537816/windows-10-update-kb4537816)

  - **macOS** - ينطبق فقط على المعاينة العامة، الحد الأدنى المطلوب للإصدار: 101.43.84 
  
   > [!NOTE]
   > يتم حاليا دعم أنظمة macOS المستندة إلى Intel فقط.
    

  - **Linux** - ينطبق فقط على المعاينة العامة، الحد الأدنى المطلوب للإصدار: 101.45.13 
    
  - **Windows Server 2012 R2** - مع [KB5005292](https://support.microsoft.com/topic/microsoft-defender-for-endpoint-update-for-edr-sensor-f8f69773-f17f-420f-91f4-a8e5167284ac)
  
  - **Windows Server 2016** - [مع KB5005292](https://support.microsoft.com/topic/microsoft-defender-for-endpoint-update-for-edr-sensor-f8f69773-f17f-420f-91f4-a8e5167284ac)

  - **Windows Server 2019**
    - الإصدار 1903 أو ([مع KB4515384) لاحقا](https://support.microsoft.com/help/4515384/windows-10-update-kb4515384)
    - الإصدار 1809 ( [مع KB4537818](https://support.microsoft.com/help/4537818/windows-10-update-kb4537818))
    
  - **Windows Server 2022**

       

- **تمكين الاستجابة المباشرة من صفحة الإعدادات المتقدمة**.

  ستحتاج إلى تمكين إمكانية الاستجابة المباشرة في [صفحة إعدادات](advanced-features.md) الميزات المتقدمة.

  > [!NOTE]
  > يمكن فقط للمستخدمين الذين لديهم أدوار إدارة الأمان أو المسؤول العام تحرير هذه الإعدادات.
  > 
  > يجب تمكين "التحقيق التلقائي" في [إعدادات الميزات المتقدمة](advanced-features.md) قبل تمكين الاستجابة المباشرة.

- **تمكين الاستجابة المباشرة للخوادم من صفحة الإعدادات المتقدمة** (مستحسن).

  > [!NOTE]
  > يمكن فقط للمستخدمين الذين لديهم أدوار إدارة الأمان أو المسؤول العام تحرير هذه الإعدادات.

- **تأكد من تعيين** مستوى المعالجة التلقائية للجهاز له.

  ستحتاج إلى تمكين، على الأقل، الحد الأدنى لمستوى المعالجة لمجموعة أجهزة معينة. وإلا فلن تتمكن من إنشاء جلسة استجابة مباشرة إلى عضو في تلك المجموعة.

  ستتلقى الخطأ التالي:

  ![صورة لرسالة خطأ.](images/live-response-error.png)

- **تمكين الاستجابة المباشرة غير الموقعة لتنفيذ البرنامج النصي** (اختياري).

  >[!IMPORTANT]
  >تنطبق عملية التحقق من التوقيع على البرامج النصية ل PowerShell فقط. 

  > [!WARNING]
  > قد يؤدي السماح باستخدام البرامج النصية غير الموقعة إلى زيادة تعرضك للتهديدات.

  لا يوصى بتشغيل البرامج النصية غير الموقعة حيث يمكن أن يزيد من تعرضك للتهديدات. إذا كان عليك استخدامها، فيجب تمكين الإعداد في [صفحة](advanced-features.md) إعدادات الميزات المتقدمة.

- **تأكد من أن لديك الأذونات المناسبة**.

  يمكن للمستخدمين الذين تم توفير الأذونات المناسبة لديهم فقط بدء جلسة عمل. لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء أدوار وإدارتها](user-roles.md).

  > [!IMPORTANT]
  > يتوفر خيار تحميل ملف إلى المكتبة فقط للمستخدمين الذين لديهم إذن "إدارة الإعدادات الأمان".
  > يكون الزر رمادي اللون للمستخدمين الذين لديهم أذونات مفوضة فقط.

  استنادا إلى الدور الذي تم منحه لك، يمكنك تشغيل أوامر الاستجابة المباشرة الأساسية أو المتقدمة. يتم التحكم في أذونات المستخدمين بواسطة الدور المخصص ل RBAC.

## <a name="live-response-dashboard-overview"></a>نظرة عامة حول لوحة معلومات الاستجابة المباشرة

عند بدء جلسة استجابة مباشرة على جهاز، يتم فتح لوحة معلومات. توفر لوحة المعلومات معلومات حول جلسة العمل مثل ما يلي:

- روبوت Who جلسة العمل
- عند بدء جلسة العمل
- مدة جلسة العمل

تمنحك لوحة المعلومات أيضا إمكانية الوصول إلى:

- قطع اتصال جلسة العمل
- Upload الملفات إلى المكتبة
- وحدة تحكم الأوامر
- سجل الأوامر

## <a name="initiate-a-live-response-session-on-a-device"></a>بدء جلسة استجابة مباشرة على جهاز

1. سجل الدخول Microsoft 365 Defender المدخل.

2. انتقل إلى **نقاط النهاية > مخزون الجهاز** وحدد جهازا للتحقق منه. يتم فتح صفحة الأجهزة.

3. ابدأ جلسة الاستجابة المباشرة عن طريق تحديد **بدء جلسة استجابة مباشرة**. يتم عرض وحدة تحكم الأوامر. انتظر أثناء اتصال جلسة العمل للجهاز.

4. استخدم الأوامر المضمنة للقيام بعمل التحقيق. لمزيد من المعلومات، راجع [أوامر الاستجابة المباشرة](#live-response-commands).

5. بعد إكمال التحقيق، حدد **قطع اتصال جلسة العمل**، ثم حدد **تأكيد**.

## <a name="live-response-commands"></a>أوامر الاستجابة المباشرة

استنادا إلى الدور الذي تم منحه لك، يمكنك تشغيل أوامر الاستجابة المباشرة الأساسية أو المتقدمة. يتم التحكم في أذونات المستخدم بواسطة الأدوار المخصصة ل RBAC. لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء أدوار وإدارتها](user-roles.md).

> [!NOTE]
> الاستجابة المباشرة هي واجهة تفاعلية مستندة إلى السحابة، على هذا النحو، قد تختلف تجربة أمر معينة في وقت الاستجابة وفقا لجودة الشبكة وتحميل النظام بين المستخدم النهائي والجهاز الهدف.

### <a name="basic-commands"></a>الأوامر الأساسية

تتوفر الأوامر التالية لأدوار المستخدمين الذين تم منحهم القدرة على تشغيل **أوامر الاستجابة** المباشرة الأساسية. لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء أدوار وإدارتها](user-roles.md).

<br>

****
| الأمر  | الوصف  | Windows Windows Server  | macOS  | Linux  |
|---|---|---|---|---|
| cd  | تغيير الدليل الحالي.  | Y  | Y  | Y  |
| cls  | يمسح شاشة وحدة التحكم.  | Y  | Y  | Y  |
| الاتصال  | بدء جلسة استجابة مباشرة على الجهاز.  | Y  | Y  | Y  |
| الاتصالات  | إظهار كل الاتصالات النشطة.  | Y  | N  | N  |
| dir  | يعرض قائمة بالملفات والدلائح الفرعية في الدليل.  | Y  | Y  | Y  |
| برامج التشغيل  | إظهار جميع برامج التشغيل المثبتة على الجهاز.  | Y  | N  | N  |
| fg `<command ID>`  | ضع المهمة المحددة في المقدمة في المقدمة، مما يجعلها المهمة الحالية.  ملاحظة: يأخذ fg "معرّف الأمر" متوفرا من المهام، وليس PID  | Y  | Y  | Y  |
| fileinfo  | الحصول على معلومات حول ملف.  | Y  | Y  | Y  |
| findfile  | تحديد موقع الملفات باسم معين على الجهاز.  | Y  | Y  | Y  |
| getfile <file_path>  | تنزيل ملف.  | Y  | Y  | Y  |
| تعليمات  | يوفر معلومات تعليمات لأوامر الاستجابة المباشرة.  | Y  | Y  | Y  |
| الوظائف  | يعرض المهام قيد التشغيل حاليا، وم ID الخاصة بها وحالتها.  | Y  | Y  | Y  |
| الثبات  | إظهار جميع أساليب الثبات المعروفة على الجهاز.  | Y  | N  | N  |
| العمليات  | إظهار جميع العمليات التي يتم تشغيلها على الجهاز.  | Y  | Y  | Y  |
| السجل  | يعرض قيم التسجيل.  | Y  | N  | N  |
| scheduledtasks  | إظهار كل المهام المجدولة على الجهاز.  | Y  | N  | N  |
| الخدمات  | إظهار جميع الخدمات على الجهاز.  | Y  | N  | N  |
| متشعبات بدء التشغيل  | إظهار كل الملفات المعروفة في مجلدات بدء التشغيل على الجهاز.  | Y  | N  | N  |
| الحالة  | إظهار حالة أمر معين وإخراجه.  | Y  | N  | N  |
| تتبع  | تعيين وضع التسجيل في المحطة الطرفية لتصحيح الأخطاء.  | Y  | Y  | Y  |

### <a name="advanced-commands"></a>الأوامر المتقدمة

تتوفر الأوامر التالية لأدوار المستخدم التي تم منحها القدرة على تشغيل **أوامر** استجابة مباشرة متقدمة. لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء أدوار وإدارتها](user-roles.md).

<br>

****

| الأمر  | الوصف  | Windows Windows Server  | macOS  | Linux  |
|---|---|---|---|---|
| تحليل  | يحلل الكيان بمحركات متعددة لتجريمه للوصول إلى قرار.  | Y  | N  | N  |
| تجميع  | تجميع حزمة التحليلات الجنائية من الجهاز  | N  | Y  | Y  |
| عزل  | قطع اتصال الجهاز بالشبكة مع الاحتفاظ باتصال خدمة Defender for Endpoint  | N  | Y  | N  |
| الإصدار  | إصدار جهاز من عزل الشبكة  | N  | Y  | N  |
| تشغيل  | تشغيل برنامج PowerShell النصي من المكتبة على الجهاز.  | Y  | Y  | Y  |
| مكتبة  | يسرد الملفات التي تم تحميلها إلى مكتبة الاستجابة المباشرة.  | Y  | Y  | Y  |
| putfile  | يضع ملفا من المكتبة على الجهاز. يتم حفظ الملفات في مجلد عمل، كما يتم حذفها عند إعادة تشغيل الجهاز بشكل افتراضي.  | Y  | Y  | Y  |
| remediate  | معالجة كيان على الجهاز. سيختلف إجراء المعالجة استنادا إلى نوع الكيان: ملف: حذف معالجة: إيقاف، حذف ملف صورة الخدمة: إيقاف، حذف إدخال سجل ملف الصورة: حذف مهمة مجدولة: إزالة عنصر مجلد بدء التشغيل: حذف ملف ملاحظة: يحتوي هذا الأمر على أمر متطلبات أساسية. يمكنك استخدام الأمر -auto بالتزامن مع remediate لتشغيل أمر المتطلبات الأساسية تلقائيا.  | Y  | Y  | Y  |
| المسح الضوئي | يقوم بتشغيل فحص برنامج الحماية من الفيروسات للمساعدة في تحديد البرامج الضارة و إصلاحها. | N | Y | Y |
| التراجع  | استعادة كيان تم إصلاحه.  | Y  | Y  | Y  |


## <a name="use-live-response-commands"></a>استخدام أوامر الاستجابة المباشرة

تتبع الأوامر التي يمكنك استخدامها في وحدة التحكم مبادئ مماثلة Windows [الأوامر](/windows-server/administration/windows-commands/windows-commands#BKMK_c).

توفر الأوامر المتقدمة مجموعة أكثر فعالية من الإجراءات التي تسمح لك لاتخاذ إجراءات أكثر فعالية مثل تنزيل ملف وتحميله وتشغيل البرامج النصية على الجهاز واتخاذ إجراءات المعالجة على كيان.

### <a name="get-a-file-from-the-device"></a>الحصول على ملف من الجهاز

بالنسبة إلى السيناريوهات التي ترغب في الحصول على ملف من جهاز تقوم بالتحري عنه، يمكنك استخدام `getfile` الأمر. يسمح لك ذلك بحفظ الملف من الجهاز لمزيد من التحقيق.

> [!NOTE]
> تنطبق حدود أحجام الملفات التالية:
>
> - `getfile` الحد: 3 غيغابايت
> - `fileinfo` الحد: 30 غيغابايت
> - `library` الحد: 250 MB

### <a name="download-a-file-in-the-background"></a>تنزيل ملف في الخلفية

لتمكين فريق عمليات الأمان من متابعة التحقق من جهاز متأثّر، يمكن الآن تنزيل الملفات في الخلفية.

- لتنزيل ملف في الخلفية، في وحدة التحكم المباشرة في أمر الاستجابة، اكتب `download <file_path> &`.
- إذا كنت تنتظر تنزيل ملف، يمكنك نقله إلى الخلفية باستخدام Ctrl + Z.
- لإحضار ملف إلى المقدمة، في وحدة التحكم المباشرة في أمر الاستجابة، اكتب `fg <command_id>`.

فيما يلي بعض الأمثلة:

<br>

****

|الأمر|ما الذي يقوم به|
|---|---|
|`getfile "C:\windows\some_file.exe" &`|بدء تنزيل ملف يسمى *some_file.exeفي الخلفية* .|
|`fg 1234`|إرجاع تنزيل باستخدام "المرجع *1234"* الأمر إلى المقدمة.|
|

### <a name="put-a-file-in-the-library"></a>وضع ملف في المكتبة

تحتوي الاستجابة المباشرة على مكتبة حيث يمكنك وضع الملفات فيها. تخزن المكتبة الملفات (مثل البرامج النصية) التي يمكن تشغيلها في جلسة استجابة مباشرة على مستوى المستأجر.

تسمح الاستجابة المباشرة بتشغيل برامج PowerShell النصية، ولكن يجب أولا وضع الملفات في المكتبة قبل أن تتمكن من تشغيلها.

يمكنك الحصول على مجموعة من برامج PowerShell النصية التي يمكن تشغيلها على الأجهزة التي تبدأ جلسات الاستجابة المباشرة بها.

#### <a name="to-upload-a-file-in-the-library"></a>لتحميل ملف في المكتبة

1. انقر **Upload الملف إلى المكتبة**.

2. انقر **فوق** استعراض وحدد الملف.

3. توفير وصف مختصر.

4. حدد ما إذا كنت تريد الكتابة فوق ملف بالاسم نفسه.

5. إذا كنت تريد أن تكون، فتعرف على المعلمات المطلوبة في البرنامج النصي، حدد خانة الاختيار معلمات البرنامج النصي. في الحقل النصي، أدخل مثالا ووصفا.

6. انقر **فوق تأكيد**.

7. (اختياري) للتحقق من تحميل الملف إلى المكتبة، قم بتشغيل `library` الأمر.

### <a name="cancel-a-command"></a>إلغاء أمر

في أي وقت أثناء جلسة العمل، يمكنك إلغاء أمر بالضغط على CTRL + C.

> [!WARNING]
> لن يوقف استخدام هذا الاختصار الأمر في جانب الوكيل. سيلغي الأمر في المدخل فقط. وبالتالي، قد يستمر تغيير العمليات مثل "إعادة المعالجة"، بينما يتم إلغاء الأمر.

## <a name="run-a-script"></a>تشغيل برنامج نصي

قبل أن تتمكن من تشغيل برنامج PowerShell/Bash النصي، يجب أولا تحميله إلى المكتبة.

بعد تحميل البرنامج النصي إلى المكتبة `run` ، استخدم الأمر لتشغيل البرنامج النصي.

إذا كنت تخطط لاستخدام برنامج PowerShell نصي غير موقع في جلسة العمل، ستحتاج إلى تمكين الإعداد في [صفحة](advanced-features.md) إعدادات الميزات المتقدمة.

> [!WARNING]
> قد يؤدي السماح باستخدام البرامج النصية غير الموقعة إلى زيادة تعرضك للتهديدات.

## <a name="apply-command-parameters"></a>تطبيق معلمات الأوامر

- عرض تعليمات وحدة التحكم للتعرف على معلمات الأوامر. للتعرف على أمر فردي، يمكنك تشغيل:

  ```powershell
  help <command name>
  ```

- عند تطبيق المعلمات على الأوامر، لاحظ أنه يتم التعامل مع المعلمات استنادا إلى ترتيب ثابت:

  ```powershell
  <command name> param1 param2
  ```

- عند تحديد معلمات خارج الترتيب الثابت، حدد اسم المعلمة بواسم الواسم قبل توفير القيمة:

  ```powershell
  <command name> -param2_name param2
  ```

- عند استخدام الأوامر التي لها أوامر المتطلبات الأساسية، يمكنك استخدام الأعلام:

  ```powershell
  <command name> -type file -id <file path> - auto
  ```

  أو

  ```powershell
  remediate file <file path> - auto`
  ```

## <a name="supported-output-types"></a>أنواع الإخراج المعتمدة

تدعم الاستجابة المباشرة أنواع إخراجات تنسيق JSON وال جدول. لكل أمر، يوجد سلوك إخراج افتراضي. يمكنك تعديل الإخراج بتنسيق الإخراج المفضل لديك باستخدام الأوامر التالية:

- `-output json`
- `-output table`

> [!NOTE]
> يتم عرض عدد أقل من الحقول بتنسيق جدول بسبب المساحة المحدودة. لرؤية المزيد من التفاصيل في الإخراج، يمكنك استخدام الأمر إخراج JSON بحيث يتم عرض المزيد من التفاصيل.

## <a name="supported-output-pipes"></a>مواسير الإخراج المعتمدة

تدعم الاستجابة المباشرة نقل الإخراج إلى CLI والملف. CLI هو سلوك الإخراج الافتراضي. يمكنك نقل الإخراج إلى ملف باستخدام الأمر التالي: [الأمر] > [اسم الملف].txt.

على سبيل المثال:

```console
processes > output.txt
```

## <a name="view-the-command-log"></a>عرض سجل الأوامر

حدد علامة **التبويب سجل الأوامر** لرؤية الأوامر المستخدمة على الجهاز أثناء جلسة عمل. يتم تعقب كل أمر بتفاصيل كاملة مثل:

- الم ID
- سطر الأوامر
- المدة
- شريط الحالة والإدخال أو الإخراج الجانبي

## <a name="limitations"></a>القيود

- تقتصر جلسات الاستجابة المباشرة على 25 جلسة استجابة مباشرة في كل مرة.
- القيمة غير النشطة لجلسة الاستجابة المباشرة هي 30 دقيقة.
- أوامر الاستجابة المباشرة الفردية لها حد زمني 10 `getfile`دقائق، باستثناء ، `findfile`و `run`، و ، التي لها حد 30 دقيقة.
- يمكن للمستخدم بدء ما يصل إلى 10 جلسات متزامنة.
- يمكن أن يكون الجهاز في جلسة عمل واحدة فقط في كل مرة.
- تنطبق حدود أحجام الملفات التالية:
  - `getfile` الحد: 3 غيغابايت
  - `fileinfo` الحد: 10 غيغابايت
  - `library` الحد: 250 MB

## <a name="related-article"></a>مقالة ذات صلة

- [أمثلة أوامر الاستجابة المباشرة](live-response-command-examples.md)
