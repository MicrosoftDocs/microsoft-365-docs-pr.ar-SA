---
title: التحقيق في الكيانات على الأجهزة باستخدام الاستجابة المباشرة في Microsoft Defender لنقطة النهاية
description: الوصول إلى جهاز باستخدام اتصال shell عن بعد آمن للقيام بعمل التحقيق واتخاذ إجراءات استجابة فورية على جهاز في الوقت الحقيقي.
keywords: عن بعد، shell، connection، live، response، في الوقت الحقيقي، الأمر، البرنامج النصي، المعالجة، التتبع، التصدير، السجل، الإفلات، التنزيل، الملف،
ms.prod: m365-security
ms.mktglfcycl: deploy
ms.sitesec: library
ms.pagetype: security
ms.author: macapara
author: mjcaparas
ms.localizationpriority: medium
manager: dansimp
audience: ITPro
ms.collection: M365-security-compliance
ms.topic: article
ms.technology: mde
ms.openlocfilehash: 1f387696797d52805495777be0850ebe135fd38a
ms.sourcegitcommit: f30616b90b382409f53a056b7a6c8be078e6866f
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 05/03/2022
ms.locfileid: "65173105"
---
# <a name="investigate-entities-on-devices-using-live-response"></a>التحقيق في الكيانات على الأجهزة باستخدام الاستجابة المباشرة

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]

**ينطبق على:**
- [Defender for Endpoint الخطة 2](https://go.microsoft.com/fwlink/p/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

> هل تريد تجربة Defender لنقطة النهاية؟ [التسجيل للحصول على إصدار تجريبي مجاني.](https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-investigateip-abovefoldlink)

توفر الاستجابة المباشرة لفرق عمليات الأمان وصولا فوريا إلى جهاز (يشار إليه أيضا باسم جهاز) باستخدام اتصال shell عن بعد. وهذا يمنحك القدرة على القيام بعمل تحقيقي متعمق واتخاذ إجراءات استجابة فورية لاحتواء التهديدات المحددة في الوقت الحقيقي على الفور.

تم تصميم الاستجابة المباشرة لتعزيز التحقيقات من خلال تمكين فريق عمليات الأمان لديك من جمع البيانات الجنائية وتشغيل البرامج النصية وإرسال الكيانات المشبوهة للتحليل ومعالجة التهديدات والبحث الاستباقي عن التهديدات الناشئة.

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE4qLUW]

مع الاستجابة المباشرة، يمكن للمحللين القيام بجميع المهام التالية:

- تشغيل الأوامر الأساسية والمتقدمة للقيام بأعمال التحقيق على جهاز.
- قم بتنزيل ملفات مثل عينات البرامج الضارة ونتائج برامج PowerShell النصية.
- قم بتنزيل الملفات في الخلفية (جديد!).
- Upload برنامج نصي PowerShell أو قابل للتنفيذ إلى المكتبة وتشغيله على جهاز من مستوى المستأجر.
- اتخاذ إجراءات المعالجة أو التراجع عنها.

## <a name="before-you-begin"></a>قبل البدء

قبل أن تتمكن من بدء جلسة عمل على جهاز، تأكد من استيفاء المتطلبات التالية:

- **تحقق من أنك تقوم بتشغيل إصدار معتمد من Windows**.

  يجب أن تكون الأجهزة قيد التشغيل أحد الإصدارات التالية من Windows

  - **Windows 10 & 11**
    - [الإصدار 1909](/windows/whats-new/whats-new-windows-10-version-1909) أو الإصدارات الأحدث
    - [الإصدار 1903](/windows/whats-new/whats-new-windows-10-version-1903) مع [KB4515384](https://support.microsoft.com/help/4515384/windows-10-update-kb4515384)
    - [الإصدار 1809 (RS 5)](/windows/whats-new/whats-new-windows-10-version-1809) [مع KB4537818](https://support.microsoft.com/help/4537818/windows-10-update-kb4537818)
    - [الإصدار 1803 (RS 4)](/windows/whats-new/whats-new-windows-10-version-1803) مع [KB4537795](https://support.microsoft.com/help/4537795/windows-10-update-kb4537795)
    - [الإصدار 1709 (RS 3)](/windows/whats-new/whats-new-windows-10-version-1709) مع [KB4537816](https://support.microsoft.com/help/4537816/windows-10-update-kb4537816)

  - **macOS** - ينطبق فقط على المعاينة العامة، الحد الأدنى من الإصدار المطلوب: 101.43.84

   > [!NOTE]
   > حاليا يتم دعم أنظمة macOS المستندة إلى Intel فقط.

  - **Linux** - ينطبق فقط على المعاينة العامة، الحد الأدنى من الإصدار المطلوب: 101.45.13

  - **Windows Server 2012 R2** - مع [KB5005292](https://support.microsoft.com/topic/microsoft-defender-for-endpoint-update-for-edr-sensor-f8f69773-f17f-420f-91f4-a8e5167284ac)

  - **Windows Server 2016** - مع [KB5005292](https://support.microsoft.com/topic/microsoft-defender-for-endpoint-update-for-edr-sensor-f8f69773-f17f-420f-91f4-a8e5167284ac)

  - **Windows Server 2019**
    - الإصدار 1903 أو (مع [KB4515384](https://support.microsoft.com/help/4515384/windows-10-update-kb4515384)) لاحقا
    - الإصدار 1809 (مع [KB4537818](https://support.microsoft.com/help/4537818/windows-10-update-kb4537818))

  - **Windows Server 2022**

- **تمكين الاستجابة المباشرة من صفحة الإعدادات المتقدمة**.

  ستحتاج إلى تمكين إمكانية الاستجابة المباشرة في صفحة [إعدادات الميزات المتقدمة](advanced-features.md) .

  > [!NOTE]
  > يمكن فقط للمستخدمين الذين لديهم أدوار إدارة الأمان أو المسؤول العمومي تحرير هذه الإعدادات.
  >
  > يجب تمكين التحقيق التلقائي في [إعدادات الميزات المتقدمة](advanced-features.md) قبل تمكين الاستجابة المباشرة.

- **تمكين الاستجابة المباشرة للخوادم من صفحة الإعدادات المتقدمة** (مستحسن).

  > [!NOTE]
  > يمكن فقط للمستخدمين الذين لديهم أدوار إدارة الأمان أو المسؤول العمومي تحرير هذه الإعدادات.

- **تأكد من أن الجهاز لديه مستوى معالجة تلقائية معين له**.

  ستحتاج إلى تمكين الحد الأدنى لمستوى المعالجة لمجموعة أجهزة معينة، على الأقل. وإلا فلن تتمكن من إنشاء جلسة استجابة مباشرة إلى عضو في تلك المجموعة.

  ستتلقى الخطأ التالي:

  :::image type="content" source="images/live-response-error.png" alt-text="رسالة الخطأ" lightbox="images/live-response-error.png":::

- **تمكين تنفيذ البرنامج النصي غير الموقع للاستجابة المباشرة** (اختياري).

  >[!IMPORTANT]
  >ينطبق التحقق من التوقيع فقط على البرامج النصية PowerShell.

  > [!WARNING]
  > قد يؤدي السماح باستخدام البرامج النصية غير الموقعة إلى زيادة تعرضك للتهديدات.

  لا يوصى بتشغيل البرامج النصية غير الموقعة لأنه يمكن أن يزيد من تعرضك للتهديدات. ومع ذلك، إذا كان عليك استخدامها، فستحتاج إلى تمكين الإعداد في صفحة [إعدادات الميزات المتقدمة](advanced-features.md) .

- **تأكد من أن لديك الأذونات المناسبة**.

  يمكن فقط للمستخدمين الذين تم تزويدهم بالأذونات المناسبة بدء جلسة عمل. لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء الأدوار وإدارتها](user-roles.md).

  > [!IMPORTANT]
  > يتوفر خيار تحميل ملف إلى المكتبة فقط للمستخدمين الذين لديهم إذن "إدارة الإعدادات الأمان".
  > يظهر الزر باللون الرمادي للمستخدمين الذين لديهم أذونات مفوضة فقط.

  اعتمادا على الدور الذي تم منحك، يمكنك تشغيل أوامر الاستجابة المباشرة الأساسية أو المتقدمة. يتم التحكم في أذونات المستخدمين بواسطة دور RBAC المخصص.

## <a name="live-response-dashboard-overview"></a>نظرة عامة على لوحة معلومات الاستجابة المباشرة

عند بدء جلسة استجابة مباشرة على جهاز، يتم فتح لوحة معلومات. توفر لوحة المعلومات معلومات حول جلسة العمل مثل ما يلي:

- روبوت Who إنشاء جلسة العمل
- عند بدء جلسة العمل
- مدة جلسة العمل

كما تمنحك لوحة المعلومات إمكانية الوصول إلى:

- قطع اتصال جلسة العمل
- Upload الملفات إلى المكتبة
- وحدة تحكم الأوامر
- سجل الأوامر

## <a name="initiate-a-live-response-session-on-a-device"></a>بدء جلسة استجابة مباشرة على جهاز

1. سجل الدخول إلى مدخل Microsoft 365 Defender.

2. انتقل إلى **نقاط النهاية > مخزون الجهاز** وحدد جهازا للتحقيق فيه. يتم فتح صفحة الأجهزة.

3. ابدأ جلسة الاستجابة المباشرة عن طريق تحديد **بدء جلسة الاستجابة المباشرة**. يتم عرض وحدة تحكم الأوامر. انتظر حتى تتصل الجلسة بالجهاز.

4. استخدم الأوامر المضمنة للقيام بعمل التحقيق. لمزيد من المعلومات، راجع [أوامر الاستجابة المباشرة](#live-response-commands).

5. بعد الانتهاء من التحقيق، حدد **"قطع الاتصال بجلسة** العمل"، ثم حدد **"تأكيد**".

## <a name="live-response-commands"></a>أوامر الاستجابة المباشرة

اعتمادا على الدور الذي تم منحك، يمكنك تشغيل أوامر الاستجابة المباشرة الأساسية أو المتقدمة. يتم التحكم في أذونات المستخدم بواسطة أدوار RBAC المخصصة. لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء الأدوار وإدارتها](user-roles.md).

> [!NOTE]
> الاستجابة المباشرة هي shell تفاعلية مستندة إلى السحابة، على هذا النحو، قد تختلف تجربة الأوامر المحددة في وقت الاستجابة اعتمادا على جودة الشبكة وتحميل النظام بين المستخدم النهائي والجهاز المستهدف.

### <a name="basic-commands"></a>الأوامر الأساسية

تتوفر الأوامر التالية لأدوار المستخدم التي يتم منحها القدرة على تشغيل أوامر الاستجابة المباشرة **الأساسية** . لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء الأدوار وإدارتها](user-roles.md).

| الامر  | الوصف  | خادم Windows وخادم Windows  | ماك  | ينكس  |
|---|---|---|---|---|
| القرص المضغوط  | تغيير الدليل الحالي.  | Y  | Y  | Y  |
| Cls  | مسح شاشة وحدة التحكم.  | Y  | Y  | Y  |
| الاتصال  | بدء جلسة استجابة مباشرة للجهاز.  | Y  | Y  | Y  |
| اتصالات  | إظهار كافة الاتصالات النشطة.  | Y  | N  | N  |
| دير  | يعرض قائمة بالملفات والدلائل الفرعية في دليل.  | Y  | Y  | Y  |
| برامج تشغيل  | إظهار كافة برامج التشغيل المثبتة على الجهاز.  | Y  | N  | N  |
| جي `<command ID>`  | ضع المهمة المحددة في المقدمة، مما يجعلها المهمة الحالية.  ملاحظة: يأخذ fg "معرف الأمر" المتوفر من المهام، وليس PID  | Y  | Y  | Y  |
| fileinfo  | الحصول على معلومات حول ملف.  | Y  | Y  | Y  |
| البحث عن ملف  | تحديد موقع الملفات بواسطة اسم معين على الجهاز.  | Y  | Y  | Y  |
| <file_path> getfile  | تنزيل ملف.  | Y  | Y  | Y  |
| تعليمات  | يوفر معلومات التعليمات لأوامر الاستجابة المباشرة.  | Y  | Y  | Y  |
| وظائف  | إظهار المهام قيد التشغيل حاليا، ومعرفها وحالتها.  | Y  | Y  | Y  |
| استمرار  | إظهار جميع أساليب الثبات المعروفة على الجهاز.  | Y  | N  | N  |
| العمليات  | إظهار كافة العمليات التي تعمل على الجهاز.  | Y  | Y  | Y  |
| التسجيل  | إظهار قيم التسجيل.  | Y  | N  | N  |
| المهام المجدولة  | إظهار كافة المهام المجدولة على الجهاز.  | Y  | N  | N  |
| خدمات  | إظهار كافة الخدمات على الجهاز.  | Y  | N  | N  |
| مجلدات بدء التشغيل  | إظهار كافة الملفات المعروفة في مجلدات بدء التشغيل على الجهاز.  | Y  | N  | N  |
| حاله  | يعرض حالة الأمر المحدد وإخراجه.  | Y  | N  | N  |
| تتبع  | تعيين وضع تسجيل المحطة الطرفية لتصحيح الأخطاء.  | Y  | Y  | Y  |

### <a name="advanced-commands"></a>الأوامر المتقدمة

تتوفر الأوامر التالية لأدوار المستخدم التي يتم منحها القدرة على تشغيل أوامر الاستجابة المباشرة **المتقدمة** . لمزيد من المعلومات حول تعيينات الأدوار، راجع [إنشاء الأدوار وإدارتها](user-roles.md).

| الامر  | الوصف  | خادم Windows وخادم Windows  | ماك  | ينكس  |
|---|---|---|---|---|
| تحليل  | تحليل الكيان باستخدام محركات التجهم المختلفة للوصول إلى حكم.  | Y  | N  | N  |
| جمع  | يجمع حزمة الطب الشرعي من الجهاز  | N  | Y  | Y  |
| عزل  | قطع اتصال الجهاز بالشبكة مع الاحتفاظ بالاتصال بخدمة Defender for Endpoint  | N  | Y  | N  |
| الافراج عن  | تحرير جهاز من عزل الشبكة  | N  | Y  | N  |
| تشغيل  | تشغيل برنامج نصي PowerShell من المكتبة على الجهاز.  | Y  | Y  | Y  |
| مكتبه  | سرد الملفات التي تم تحميلها إلى مكتبة الاستجابة المباشرة.  | Y  | Y  | Y  |
| Putfile  | وضع ملف من المكتبة إلى الجهاز. يتم حفظ الملفات في مجلد عمل ويتم حذفها عند إعادة تشغيل الجهاز بشكل افتراضي.  | Y  | Y  | Y  |
| اصلاح  | معالجة كيان على الجهاز. سيختلف إجراء المعالجة استنادا إلى نوع الكيان: الملف: عملية الحذف: إيقاف، حذف خدمة ملف الصورة: إيقاف، حذف إدخال سجل ملفات الصور: حذف المهمة المجدولة: إزالة عنصر مجلد بدء التشغيل: حذف ملاحظة الملف: يحتوي هذا الأمر على أمر متطلب أساسي. يمكنك استخدام الأمر -auto بالتزامن مع المعالجة لتشغيل أمر المتطلبات الأساسية تلقائيا.  | Y  | Y  | Y  |
| المسح الضوئي | تشغيل فحص مكافحة الفيروسات للمساعدة في تحديد البرامج الضارة ومعالجتها. | N | Y | Y |
| التراجع عن  | استعادة كيان تمت معالجتها.  | Y  | Y  | Y  |

## <a name="use-live-response-commands"></a>استخدام أوامر الاستجابة المباشرة

تتبع الأوامر التي يمكنك استخدامها في وحدة التحكم مبادئ مماثلة للأوامر [Windows](/windows-server/administration/windows-commands/windows-commands#BKMK_c).

توفر الأوامر المتقدمة مجموعة أكثر قوة من الإجراءات التي تسمح لك باتخاذ إجراءات أكثر قوة مثل تنزيل ملف وتحميله، وتشغيل البرامج النصية على الجهاز، واتخاذ إجراءات المعالجة على كيان.

### <a name="get-a-file-from-the-device"></a>الحصول على ملف من الجهاز

بالنسبة للسيناريوهات التي تريد فيها الحصول على ملف من جهاز تحقق فيه، يمكنك استخدام `getfile` الأمر. يسمح لك هذا بحفظ الملف من الجهاز لمزيد من التحقيق.

> [!NOTE]
> تنطبق حدود حجم الملف التالية:
>
> - `getfile` الحد: 3 غيغابايت
> - `fileinfo` الحد: 30 غيغابايت
> - `library` الحد: 250 ميغابايت

### <a name="download-a-file-in-the-background"></a>تنزيل ملف في الخلفية

لتمكين فريق عمليات الأمان من متابعة التحقيق في جهاز متأثر، يمكن الآن تنزيل الملفات في الخلفية.

- لتنزيل ملف في الخلفية، في وحدة تحكم أمر الاستجابة المباشرة، اكتب `download <file_path> &`.
- إذا كنت تنتظر تنزيل ملف، يمكنك نقله إلى الخلفية باستخدام Ctrl + Z.
- لجلب تنزيل ملف إلى المقدمة، في وحدة تحكم أمر الاستجابة المباشرة، اكتب `fg <command_id>`.

فيما يلي بعض الأمثلة:

<br>

****

|الامر|ما الذي يفعله|
|---|---|
|`getfile "C:\windows\some_file.exe" &`|بدء تنزيل ملف مسمى *some_file.exe* في الخلفية.|
|`fg 1234`|إرجاع تنزيل مع معرف الأمر *1234* إلى المقدمة.|
|

### <a name="put-a-file-in-the-library"></a>وضع ملف في المكتبة

تحتوي الاستجابة المباشرة على مكتبة حيث يمكنك وضع الملفات فيها. تخزن المكتبة الملفات (مثل البرامج النصية) التي يمكن تشغيلها في جلسة استجابة مباشرة على مستوى المستأجر.

تسمح الاستجابة المباشرة بتشغيل البرامج النصية PowerShell، ولكن يجب أولا وضع الملفات في المكتبة قبل أن تتمكن من تشغيلها.

يمكنك الحصول على مجموعة من البرامج النصية PowerShell التي يمكن تشغيلها على الأجهزة التي تبدأ بها جلسات الاستجابة المباشرة.

#### <a name="to-upload-a-file-in-the-library"></a>لتحميل ملف في المكتبة

1. انقر فوق **Upload ملف إلى مكتبة**.

2. انقر فوق **"استعراض"** وحدد الملف.

3. قدم وصفا موجزا.

4. حدد ما إذا كنت تريد الكتابة فوق ملف بنفس الاسم.

5. إذا كنت ترغب في ذلك، فتعرف على المعلمات المطلوبة للبرنامج النصي، حدد خانة الاختيار معلمات البرنامج النصي. في حقل النص، أدخل مثالا ووصفا.

6. انقر فوق **"تأكيد**".

7. (اختياري) للتحقق من تحميل الملف إلى المكتبة، قم بتشغيل `library` الأمر.

### <a name="cancel-a-command"></a>إلغاء أمر

في أي وقت أثناء جلسة عمل، يمكنك إلغاء أمر بالضغط على CTRL + C.

> [!WARNING]
> لن يؤدي استخدام هذا الاختصار إلى إيقاف الأمر في جانب العامل. سيتم إلغاء الأمر في المدخل فقط. لذلك، قد يستمر تغيير العمليات مثل "المعالجة"، بينما يتم إلغاء الأمر.

## <a name="run-a-script"></a>تشغيل برنامج نصي

قبل أن تتمكن من تشغيل برنامج نصي PowerShell/Bash، يجب أولا تحميله إلى المكتبة.

بعد تحميل البرنامج النصي إلى المكتبة، استخدم `run` الأمر لتشغيل البرنامج النصي.

إذا كنت تخطط لاستخدام برنامج نصي PowerShell غير موقع في جلسة العمل، فستحتاج إلى تمكين الإعداد في صفحة [إعدادات الميزات المتقدمة](advanced-features.md) .

> [!WARNING]
> قد يؤدي السماح باستخدام البرامج النصية غير الموقعة إلى زيادة تعرضك للتهديدات.

## <a name="apply-command-parameters"></a>تطبيق معلمات الأوامر

- عرض تعليمات وحدة التحكم للتعرف على معلمات الأوامر. للتعرف على أمر فردي، قم بتشغيل:

  ```powershell
  help <command name>
  ```

- عند تطبيق المعلمات على الأوامر، لاحظ أنه تتم معالجة المعلمات بناء على ترتيب ثابت:

  ```powershell
  <command name> param1 param2
  ```

- عند تحديد معلمات خارج الترتيب الثابت، حدد اسم المعلمة بواسطة واصلة قبل توفير القيمة:

  ```powershell
  <command name> -param2_name param2
  ```

- عند استخدام الأوامر التي تحتوي على أوامر المتطلبات الأساسية، يمكنك استخدام العلامات:

  ```powershell
  <command name> -type file -id <file path> - auto
  ```

  او

  ```powershell
  remediate file <file path> - auto`
  ```

## <a name="supported-output-types"></a>أنواع الإخراج المعتمدة

تدعم الاستجابة المباشرة أنواع إخراج تنسيقات الجدول وJSON. لكل أمر، هناك سلوك إخراج افتراضي. يمكنك تعديل الإخراج بتنسيق الإخراج المفضل لديك باستخدام الأوامر التالية:

- `-output json`
- `-output table`

> [!NOTE]
> يتم عرض عدد أقل من الحقول بتنسيق الجدول بسبب المساحة المحدودة. للاطلاع على مزيد من التفاصيل في الإخراج، يمكنك استخدام أمر إخراج JSON بحيث يتم عرض المزيد من التفاصيل.

## <a name="supported-output-pipes"></a>أنابيب الإخراج المدعومة

تدعم الاستجابة المباشرة أنابيب الإخراج إلى CLI والملف. CLI هو سلوك الإخراج الافتراضي. يمكنك توجيه الإخراج إلى ملف باستخدام الأمر التالي: [command] > [filename].txt.

على سبيل المثال:

```console
processes > output.txt
```

## <a name="view-the-command-log"></a>عرض سجل الأوامر

حدد علامة تبويب **سجل الأوامر** للاطلاع على الأوامر المستخدمة على الجهاز أثناء جلسة العمل. يتم تعقب كل أمر بتفاصيل كاملة مثل:

- المعرّف
- سطر الأوامر
- مده
- شريط جانبي للحالة والإخراج أو الإخراج

## <a name="limitations"></a>القيود

- تقتصر جلسات الاستجابة المباشرة على 25 جلسة استجابة مباشرة في كل مرة.
- قيمة المهلة غير النشطة لجلسة الاستجابة المباشرة هي 30 دقيقة.
- أوامر الاستجابة المباشرة الفردية لها حد زمني يبلغ 10 دقائق، باستثناء `getfile`، `findfile`و `run`، والتي لها حد 30 دقيقة.
- يمكن للمستخدم بدء ما يصل إلى 10 جلسات متزامنة.
- يمكن أن يكون الجهاز في جلسة واحدة فقط في كل مرة.
- تنطبق حدود حجم الملف التالية:
  - `getfile` الحد: 3 غيغابايت
  - `fileinfo` الحد: 30 غيغابايت
  - `library` الحد: 250 ميغابايت

## <a name="related-article"></a>مقالة ذات صلة

- [أمثلة أوامر الاستجابة المباشرة](live-response-command-examples.md)
