---
title: مرجع الحماية من استغلال
keywords: عوامل تخفيف المخاطر والثغرات الأمنية والثغرة الأمنية وتخفيف المخاطر والهجمة والهجمات وأدوات تجربة تخفيف المخاطر المحسنة
description: تفاصيل حول كيفية عمل ميزة الحماية من الاستغلال في Windows
ms.pagetype: security
ms.prod: m365-security
ms.mktglfcycl: manage
ms.sitesec: library
ms.localizationpriority: medium
audience: ITPro
author: denisebmsft
ms.author: deniseb
ms.reviewer: cjacks
manager: dansimp
ms.custom: asr
ms.technology: mde
ms.topic: article
ms.collection: m365-security-compliance
ms.date: 10/19/2021
ms.openlocfilehash: f6889cb12f1a152abe3dbb7d748d52e118547ab3
ms.sourcegitcommit: bdd6ffc6ebe4e6cb212ab22793d9513dae6d798c
ms.translationtype: HT
ms.contentlocale: ar-SA
ms.lasthandoff: 03/08/2022
ms.locfileid: "63573316"
---
# <a name="exploit-protection-reference"></a>مرجع الحماية من استغلال

[!INCLUDE [Microsoft 365 Defender rebranding](../../includes/microsoft-defender.md)]


**ينطبق على:**
- [Defender for Endpoint الخطة 2](https://go.microsoft.com/fwlink/?linkid=2154037)
- [Microsoft 365 Defender](https://go.microsoft.com/fwlink/?linkid=2118804)

> هل تريد تجربة Defender لنقطة النهاية؟ [التسجيل للحصول على إصدار تجريبي مجاني.](https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&ru=https://aka.ms/MDEp2OpenTrial?ocid=docs-wdatp-enablesiem-abovefoldlink)

توفر الحماية من الهجمات حماية متقدمة للتطبيقات التي يمكن لمحترفي تكنولوجيا المعلومات تطبيقها بعد قيام المطور بتجميع البرنامج وتوزيعه.

تساعدك هذه المقالة على فهم كيفية عمل الحماية من الهجمات، على مستوى النهج وعلى مستوى عوامل التخفيف من المخاطر الفردي، لمساعدتك على إنشاء نهج الحماية من الهجمات وتطبيقه بنجاح.

## <a name="how-mitigations-are-applied"></a>كيفية تطبيق عوامل التخفيف من المخاطر

يتم تطبيق عوامل تخفيف المخاطر الخاصة بالحماية من الهجمات لكل تطبيق.

يتم تكوين عوامل تخفيف المخاطر عبر إدخال تسجيل لكل برنامج تقوم بتكوين الحماية له. يتم تخزين هذه الإعدادات في إدخال سجل **MitigationOptions** لكل برنامج (**HKEY_LOCAL_MACHINE \ SOFTWARE \ Microsoft \ Windows NT \ CurrentVersion \ خيارات تنفيذ ملف الصورة \ *ImageFileName* \ MitigationOptions**). وهي سارية المفعول عند إعادة تشغيل البرنامج وتظل فعالة حتى تقوم بتغييرها وإعادة تشغيل البرنامج مرة أخرى.

> [!IMPORTANT]
> تسمح لك خيارات تنفيذ ملف الصورة فقط بتحديد اسم ملف أو مسار، وليس رقم إصدار أو تصميم أو أي اختلاف آخر. احذر من استهداف عوامل تخفيف المخاطر للتطبيقات التي تحتوي على أسماء أو مسارات فريدة، وتطبيقها فقط على الأجهزة التي اختبرت هذا الإصدار وتصميم التطبيق هذا.

إذا قمت بتكوين عوامل تقليل الحماية من الهجمات باستخدام ملف تكوين XML، إما عبر PowerShell أو نهج المجموعة أو MDM، عند معالجة ملف تكوين XML هذا، فسيتم تكوين إعدادات التسجيل الفردية لك.

عند عدم فرض النهج الذي يقوم بتوزيع ملف XML، لن تتم إزالة الإعدادات التي تم نشرها بواسطة ملف تكوين XML هذا تلقائيًا. لإزالة إعدادات الحماية من الهجمات، قم بتصدير تكوين XML من Windows 10 نظيف أو جهاز Windows 11، وقم بنشر ملف XML الجديد هذا. بدلًا من ذلك، توفر Microsoft ملف XML كجزء من الخطوط الأساسية الخاصة بأمان Windows لإعادة تعيين إعدادات الحماية من الهجمات.

لإعادة تعيين إعدادات الحماية من الهجمات باستخدام PowerShell، يمكنك استخدام الأمر التالي:

```powershell
Set-ProcessMitigation -PolicyFilePath EP-reset.xml
```
فيما يلي EP-reset.xml الموزع مع الخطوط الأساسية الخاصة بأمان Windows:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<MitigationPolicy>
  <AppConfig Executable="ONEDRIVE.EXE">
    <DEP OverrideDEP="false" />
    <ASLR OverrideRelocateImages="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
  </AppConfig>
  <AppConfig Executable="firefox.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
  </AppConfig>
  <AppConfig Executable="fltldr.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
    <ChildProcess OverrideChildProcess="false" />
  </AppConfig>
  <AppConfig Executable="GROOVE.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
    <ImageLoad OverrideBlockRemoteImages="false" />
    <ChildProcess OverrideChildProcess="false" />
  </AppConfig>
  <AppConfig Executable="Acrobat.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="AcroRd32.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="chrome.exe">
    <DEP OverrideDEP="false" />
  </AppConfig>
  <AppConfig Executable="EXCEL.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="iexplore.exe">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="INFOPATH.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="java.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="javaw.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="javaws.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="LYNC.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="MSACCESS.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="MSPUB.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="OIS.EXE">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="OUTLOOK.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="plugin-container.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="POWERPNT.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="PPTVIEW.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="VISIO.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="VPREVIEW.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="WINWORD.EXE">
    <DEP OverrideDEP="false" />
    <ASLR ForceRelocateImages="true" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="wmplayer.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
  <AppConfig Executable="wordpad.exe">
    <DEP OverrideDEP="false" />
    <Payload OverrideEnableExportAddressFilter="false" OverrideEnableExportAddressFilterPlus="false" OverrideEnableImportAddressFilter="false" OverrideEnableRopStackPivot="false" OverrideEnableRopCallerCheck="false" OverrideEnableRopSimExec="false" />
  </AppConfig>
</MitigationPolicy>
```

## <a name="mitigation-reference"></a>مرجع عوامل تخفيف المخاطر

تشرح الأقسام التالية بالتفصيل إجراءات الحماية التي يوفرها كل عامل تخفيف المخاطر للحماية من الهجمات واعتبارات توافق تخفيف المخاطر وخيارات التكوين المتوفرة.

## <a name="arbitrary-code-guard"></a>حماية التعليمات البرمجية العشوائية

### <a name="description"></a>الوصف

تساعد حماية التعليمات البرمجية العشوائية على الحماية من مهاجم ضار يقوم بتحميل الرمز الذي يختاره في الذاكرة من خلال ثغرة أمان الذاكرة والقدرة على تنفيذ هذا الرمز.

تحمي حماية التعليمات البرمجية العشوائية أحد التطبيقات من تنفيذ التعليمات البرمجية التي تم إنشاؤها ديناميكيًا (التعليمات البرمجية التي لم يتم تحميلها، على سبيل المثال، من exe نفسه أو dll). تعمل حماية التعليمات البرمجية العشوائية عن طريق منع وضع علامة قابل للتنفيذ على الذاكرة. عندما يحاول أحد التطبيقات [تخصيص الذاكرة](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc)، نتحقق من علامات الحماية. (يمكن تخصيص الذاكرة مع علامات الحماية للقراءة والكتابة و/أو التنفيذ.) إذا حاول التخصيص تضمين علامة الحماية [*للتنفيذ*](/windows/win32/memory/memory-protection-constants)، فسيفشل تخصيص الذاكرة ويرجع رمز خطأ (STATUS_DYNAMIC_CODE_BLOCKED). وبالمثل، إذا حاول أحد التطبيقات [تغيير علامات الحماية للذاكرة](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) التي تم تخصيصها بالفعل وتتضمن علامة الحماية [*للتنفيذ*](/windows/win32/memory/memory-protection-constants)، فسيفشل تغيير الإذن ويرجع رمز خطأ (STATUS_DYNAMIC_CODE_BLOCKED).

من خلال منع تعيين علامة *التنفيذ*، يمكن لميزة منع تنفيذ البيانات في Windows 10 وWindows 11 الحماية من مؤشر الإرشادات الذي يتم تعيينه إلى تلك الذاكرة وتشغيل هذا الرمز.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

تمنع حماية التعليمات البرمجية العشوائية تخصيص أي ذاكرة كقابلة للتنفيذ، مما يعرض مشكلة توافق مع نهج مثل المحول البرمجي في الوقت المناسب (JIT). على سبيل المثال، ستقوم معظم المستعرضات الحديثة بتجميع JavaScript في التعليمات البرمجية الأصلية لتحسين الأداء. لدعم هذا التخفيف، ستحتاج إلى إعادة الحماية لنقل التحويل البرمجي JIT خارج العملية المحمية. ولن تتوافق التطبيقات الأخرى التي ينشئ تصميمها تعليمة برمجية ديناميكيًا من البرامج النصية أو اللغات الوسيطة الأخرى بشكل مماثل مع هذا التخفيف.

### <a name="configuration-options"></a>خيارات التكوين

**السماح بإلغاء اشتراك مؤشر الترابط** - يمكنك تكوين التخفيف للسماح لمؤشر ترابط فردي بإلغاء الاشتراك في هذه الحماية. يجب أن يكون المطور قد كتب التطبيق بمعرفة بتخفيف هذه المخاطر، وتسمى واجهة برمجة التطبيقات [**SetThreadInformation**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadinformation) مع تعيين المعلمة *ThreadInformation* إلى **ThreadDynamicCodePolicy** لكي يسمح له بتنفيذ التعليمات البرمجية الديناميكية على مؤشر الترابط هذا.

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="block-low-integrity-images"></a>حظر الصور منخفضة التكامل

### <a name="description"></a>الوصف

يؤدي حظر صور التكامل المنخفضة إلى منع التطبيق من تحميل الملفات غير الموثوق بها، عادة بسبب تنزيلها من الإنترنت من مستعرض آلية تحديد الوصول.

سيؤدي تقليل المخاطر هذا إلى حظر تحميل الصور إذا كانت الصورة تحتوي على إدخال التحكم في الوصول (ACE) الذي يمنح حق الوصول إلى عمليات IL المنخفضة والتي لا تحتوي على تسمية ثقة ACE. يتم تنفيذه بواسطة إدارة الذاكرة، التي تمنع تعيين الملف إلى الذاكرة. إذا حاول أحد التطبيقات تعيين صورة تكامل منخفضة، فسيؤدي ذلك إلى حدوث خطأ STATUS_ACCESS_DENIED. للحصول على تفاصيل حول كيفية عمل مستويات التكامل، راجع ["التحكم في التكامل الإلزامي](/windows/win32/secauthz/mandatory-integrity-control)".

### <a name="compatibility-considerations"></a>اعتبارات التوافق

سيؤدي حظر صور التكامل المنخفضة إلى منع التطبيق من تحميل الملفات التي تم تنزيلها من الإنترنت. إذا كان سير عمل التطبيق يتطلب تحميل الصور التي تم تنزيلها، فسترغب في التأكد من تنزيلها من عملية ذات ثقة أعلى، أو إعادة وصفها صراحة لتطبيق التخفيف من المخاطر هذا.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="block-remote-images"></a>حظر الصور البعيدة

### <a name="description"></a>الوصف

يساعد حظر الصور البعيدة في منع التطبيق من تحميل الملفات المستضافة على جهاز بعيد، مثل مشاركة UNC. يساعد حظر الصور البعيدة على الحماية من تحميل الثنائيات في الذاكرة الموجودة على جهاز خارجي يتحكم به المهاجم.

سيؤدي هذا التخفيف إلى حظر تحميل الصور إذا تم تحديد الصورة على جهاز بعيد. يتم تنفيذه بواسطة إدارة الذاكرة، التي تمنع تعيين الملف إلى الذاكرة. إذا حاول أحد التطبيقات تعيين ملف بعيد، فسيؤدي ذلك إلى حدوث خطأ STATUS_ACCESS_DENIED.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

سيؤدي حظر الصور البعيدة إلى منع التطبيق من تحميل الصور من الأجهزة البعيدة. إذا كان تطبيقك يقوم بتحميل الملفات أو المكونات الإضافية من الأجهزة البعيدة، فلن يكون متوافقًا مع هذا التخفيف.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="block-untrusted-fonts"></a>حظر الخطوط غير الموثوقة

### <a name="description"></a>الوصف

يؤدي حظر الخطوط غير الموثوق بها إلى تقليل خطر حدوث خلل في تحليل الخطوط مما يؤدي إلى قدرة المهاجم على تشغيل التعليمات البرمجية على الجهاز. سيتم تحميل الخطوط المثبتة في دليل windows\fonts فقط للمعالجة بواسطة GDI.

يتم تنفيذ هذا التخفيف داخل GDI، الذي يتحقق من موقع الملف. إذا لم يكن الملف في دليل خطوط النظام، فلن يتم تحميل الخط لتحليله وسيفشل هذا الاتصال.

هذا التخفيف بالإضافة إلى التخفيف المضمن المتوفر في Windows 10 1607 والإصدار الأحدث، وWindows 11، الذي ينقل تحليل الخط خارج kernel وإلى حاوية تطبيق وضع المستخدم. ونتيجة لذلك، يحدث أي استغلال يستند إلى تحليل الخط في سياق معزول وبيئة الاختبار المعزولة، مما يقلل من المخاطر بشكل ملحوظ. للحصول على تفاصيل حول هذا التخفيف، راجع لمدونة [تعزيز Windows 10 مع تخفيف الهجمات لثغرة أمنية أولية](https://www.microsoft.com/security/blog/2017/01/13/hardening-windows-10-with-zero-day-exploit-mitigations/).

### <a name="compatibility-considerations"></a>اعتبارات التوافق

الاستخدام الأكثر شيوعًا للخطوط خارج دليل خطوط النظام هو [مع خطوط الويب](/typography/fonts/font-faq#web). تستخدم المستعرضات الحديثة، مثل Microsoft Edge، DirectWrite بدلا من GDI، ولا تتأثر. ومع ذلك، يمكن أن تتأثر المستعرضات القديمة، مثل Internet Explorer 11 (ووضع IE في Microsoft Edge الجديد)، خاصة مع تطبيقات مثل Office 365، التي تستخدم صور الخطوط لعرض واجهة المستخدم.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="code-integrity-guard"></a>حماية تكامل التعليمات البرمجية

### <a name="description"></a>الوصف

يضمن "حماية تكامل التعليمات البرمجية" توقيع كل الثنائيات التي تم تحميلها في عملية رقميًا من قبل Microsoft. تتضمن حماية تكامل التعليمات البرمجية توقيعات [WHQL](/windows-hardware/drivers/install/whql-release-signature) (معامل الجودة في Microsoft)، مما سيسمح بتشغيل برامج التشغيل المعتمدة من قبل WHQL داخل العملية.

يتم تنفيذ هذا التخفيف داخل إدارة الذاكرة، مما يمنع تعيين الثنائي إلى الذاكرة. إذا حاولت تحميل ثنائي لم يتم توقيعه من قبل Microsoft، فسترجع أداة إدارة الذاكرة الخطأ STATUS_INVALID_IMAGE_HASH. من خلال الحظر على مستوى إدارة الذاكرة، يمنع هذا كلا الثنائيين المحملين بواسطة العملية والثنائيات التي تم إدخالها في العملية.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

هذا التخفيف يحظر أي ثنائي لم يتم توقيعه من قبل Microsoft. وعلى هذا النحو، لن يكون متوافقًا مع معظم البرامج التابعة لجهة خارجية، إلا إذا تم توزيع هذا البرنامج بواسطة Microsoft Store (وتم توقيعه رقميًا)، ويتم تحديد خيار السماح بتحميل الصور الموقعة بواسطة Microsoft Store.

### <a name="configuration-options"></a>خيارات التكوين

**السماح أيضا بتحميل الصور الموقعة بواسطة Microsoft Store** - سيتم توقيع التطبيقات التي يتم توزيعها بواسطة Microsoft Store رقميًا بواسطة Microsoft Store، وستسمح إضافة هذا التكوين بتحميل الثنائيات التي مرت بعملية مصادقة المتجر بواسطة التطبيق.

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="control-flow-guard-cfg"></a>حماية تدفق التحكم (CFG)

### <a name="description"></a>الوصف

يعمل التحكم في حماية التدفق (CFG) على تقليل مخاطر المهاجمين الذين يستخدمون الثغرات الأمنية في تلف الذاكرة من خلال حماية عمليات استدعاء الوظائف غير المباشرة. على سبيل المثال، قد يستخدم المهاجم ثغرة أمنية تجاوز المخزن المؤقت للكتابة فوق الذاكرة التي تحتوي على مؤشر دالة، واستبدال مؤشر الدالة هذا بمؤشر للتعليمات البرمجية القابلة للتنفيذ التي يختارها (والتي قد تكون تم إدخالها أيضا في البرنامج).

يتم توفير هذا التخفيف عن طريق إدخال فحص آخر في وقت التحويل البرمجي. قبل كل استدعاء دالة غير مباشر، تتم إضافة إرشادات أخرى تتحقق من أن الهدف هو هدف استدعاء صالح قبل استدعائه. إذا لم يكن الهدف هدف استدعاء صالح، فسيتم إنهاء التطبيق. على هذا النحو، يمكن للتطبيقات التي تم تجميعها برمجيا باستخدام دعم CFG الاستفادة من هذا التخفيف.

يتم توفير التحقق من وجود هدف صالح بواسطة kernel في Windows. عند تحميل الملفات القابلة للتنفيذ، يتم استخراج بيانات التعريف لأهداف المكالمات غير المباشرة في وقت التحميل ويتم وضع علامة عليها كأهداف استدعاء صالحة. بالإضافة إلى ذلك، عند تخصيص الذاكرة ووضع علامة عليها كقابلة للتنفيذ (مثل التعليمات البرمجية التي تم إنشاؤها)، يتم أيضا وضع علامة على مواقع الذاكرة هذه كأهداف استدعاء صالحة، لدعم آليات مثل التحويل البرمجي JIT.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

نظرا لأنه يجب تجميع التطبيقات لدعم CFG، فإنها تعلن ضمنيا توافقها معها. لذلك، يجب أن تعمل معظم التطبيقات مع تمكين التخفيف هذا. نظرا لأن هذه الاختبارات تم تجميعها برمجيا في الثنائي، فإن التكوين الذي يمكنك تطبيقه هو فقط لتعطيل عمليات التحقق داخل kernel في Windows. بمعنى آخر، يكون التخفيف قيد التشغيل بشكل افتراضي، ولكن يمكنك تكوين kernel ل Windows لإرجاع "نعم" دائما إذا حددت لاحقا وجود مشكلة توافق لم يكتشفها مطور التطبيق في اختباره، والتي من المفترض أن تكون نادرة.

### <a name="configuration-options"></a>خيارات التكوين

**استخدام CFG صارم** - في الوضع المقيد، يجب تجميع جميع الثنائيات التي تم تحميلها في العملية برمجيا ل Control Flow Guard (أو ليس بها أي تعليمات برمجية قابلة للتنفيذ - مثل dlls للمورد) ليتم تحميلها.

> [!Note]
> لا تحتوي **حماية تدفق عنصر التحكم** على وضع تدقيق. يتم تجميع الثنائيات مع تمكين التخفيف هذا.

## <a name="data-execution-prevention-dep"></a>منع تنفيذ التعليمات البرمجية (DEP)

### <a name="description"></a>الوصف

يمنع منع تنفيذ البيانات (DEP) تنفيذ الذاكرة التي لم يتم تخصيصها صراحة كملف تنفيذي. تساعد ميزة "منع تنفيذ التعليمات البرمجية" على الحماية من المهاجم الذي يقوم بإدخال تعليمات برمجية ضارة في العملية، على سبيل المثال من خلال تجاوز المخزن المؤقت، ثم تنفيذ هذا الرمز.

إذا حاولت تعيين مؤشر الإرشادات إلى عنوان ذاكرة لم يتم وضع علامة عليه كملف تنفيذي، فسيطرح المعالج استثناء (انتهاك الحماية العامة)، مما يتسبب في تعطل التطبيق.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

تم تمكين ميزة "منع تنفيذ التعليمات البرمجية" لكل من x64 و ARM و ARM-64 بشكل افتراضي، ولا يمكن تعطيلها. بما أنه لن يتم تنفيذ أي تطبيق بدون "منع تنفيذ التعليمات البرمجية"، فمن المفترض وجود توافق.

تحتوي جميع ثنائيات x86 (32 بت) على ميزة "منع تنفيذ التعليمات البرمجية" ممكنة بشكل افتراضي، ولكن يمكن تعطيل ميزة "منع تنفيذ التعليمات البرمجية" لكل عملية. قد لا تكون بعض التطبيقات القديمة، عادة التطبيقات المطورة قبل Windows XP SP2، متوافقة مع DEP. تقوم هذه التطبيقات عادة بإنشاء التعليمات البرمجية ديناميكيا (على سبيل المثال، تجميع JIT) أو الارتباط بمكتبات قديمة (مثل الإصدارات القديمة من ATL) التي تقوم بإنشاء التعليمات البرمجية ديناميكيا.

### <a name="configuration-options"></a>خيارات التكوين

**تمكين مضاهاة ATL Thunk** - يؤدي خيار التكوين هذا إلى تعطيل مضاهاة ATL Thunk. تم تصميم ATL، مكتبة قوالب ActiveX، لتكون صغيرة وسريعة قدر الإمكان. لتقليل الحجم الثنائي، سيستخدم تقنية تسمى *twinking*. عادة ما يتم التفكير في استخدام Toneking للتفاعل بين تطبيقات 32 بت و16 بت، ولكن لا توجد مكونات 16 بت ل ATL هنا. بدلا من ذلك، لتحسين الحجم الثنائي، ستقوم ATL بتخزين رمز الجهاز في ذاكرة لا تتم محاذاتها مع الكلمات (إنشاء ثنائي أصغر)، ثم استدعاء هذا الرمز مباشرة. لا تقوم مكونات ATL التي تم تجميعها باستخدام Visual Studio 7.1 أو إصدار سابق (Visual Studio 2003) بتخصيص هذه الذاكرة كقابلة للتنفيذ - يحل مضاهاة thunk مشكلة التوافق هذه. غالبا ما تحتاج التطبيقات التي تحتوي على نموذج ملحق ثنائي (مثل Internet Explorer 11) إلى تمكين مضاهاة ATL Thunk.

## <a name="disable-extension-points"></a>تعطيل نقاط الملحق

### <a name="description"></a>الوصف

يؤدي هذا التخفيف إلى تعطيل نقاط الامتداد المختلفة للتطبيق، والتي قد يتم استخدامها لإنشاء استمرارية أو رفع امتيازات المحتوى الضار.

يشمل ذلك:

- **AppInit DLLs** - كلما بدأت عملية، سيقوم النظام بتحميل DLL المحدد إلى سياق العملية التي بدأت حديثا قبل استدعاء دالة نقطة الإدخال الخاصة به. [يمكن العثور على تفاصيل حول AppInit DLLs هنا](/windows/win32/winmsg/about-window-classes#application-global-classes). مع تطبيق هذا التخفيف، لا يتم تحميل AppInit DLLs. بدءا من Windows 7، يجب توقيع AppInit DLLs رقميا، [كما هو موضح هنا](/windows/win32/win7appqual/appinit-dlls-in-windows-7-and-windows-server-2008-r2). بالإضافة إلى ذلك، بدءا من Windows 8، لن يتم تحميل AppInit DLLs إذا تم تمكين SecureBoot، [كما هو موضح هنا](/windows/win32/dlls/secure-boot-and-appinit-dlls).
- **IMEs القديمة** - يسمح محرر أسلوب الإدخال (IME) للمستخدم بكتابة نص بلغة تحتوي على أحرف أكثر من التي يمكن تمثيلها على لوحة المفاتيح. يمكن للجهات الخارجية إنشاء IMEs. قد يحصل محرر أسلوب الإدخال الضار على بيانات اعتماد أو معلومات حساسة أخرى من لقطة الإدخال هذه. ستعمل بعض IMEs، التي يشار إليها ب IMEs القديمة، فقط على تطبيقات سطح مكتب Windows، وليس تطبيقات UWP. سيؤدي هذا التخفيف أيضا إلى منع تحميل محرر أسلوب الإدخال القديم هذا إلى تطبيق سطح مكتب Windows المحدد.
- **خطافات أحداث Windows** - يمكن للتطبيق استدعاء [واجهة برمجة تطبيقات SetWinEventHook](/windows/win32/api/winuser/nf-winuser-setwineventhook) لتسجيل الاهتمام بحدث يحدث. يتم تحديد DLL ويمكن إدخاله في العملية. يفرض التخفيف هذا الخطاف ليتم نشره في عملية التسجيل بدلا من التشغيل قيد المعالجة من خلال مكتبة الارتباط الديناميكي (DLL) التي تم إدخالها.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

يتم استخدام معظم نقاط الملحقات هذه بشكل غير متكرر نسبيا، لذلك يكون تأثير التوافق صغيرا عادة، لا سيما على مستوى تطبيق فردي. الاعتبار الوحيد هو إذا كان المستخدمون يستخدمون IMEs قديمة تابعة لجهة خارجية لن تعمل مع التطبيق المحمي.

### <a name="configuration-options"></a>خيارات التكوين

لا توجد خيارات تكوين لتخفيف هذه المخاطر.

> [!Note]
> **لا يحتوي تعطيل نقاط الملحق** على وضع تدقيق.

## <a name="disable-win32k-system-calls"></a>تعطيل مكالمات نظام Win32k

### <a name="description"></a>الوصف

يوفر Win32k.sys مساحة هجوم واسعة لمهاجم. كمكون لوضع kernel، يتم استهدافه بشكل متكرر كموجه الهروب للتطبيقات التي تم وضع آلية تحديد الوصول عليها. يمنع التخفيف هذا الاستدعاءات إلى win32k.sys عن طريق حظر مؤشر ترابط من تحويل نفسه إلى مؤشر ترابط GUI، والذي يتم منحه بعد ذلك حق الوصول لاستدعاء دالات Win32k. مؤشر الترابط ليس واجهة GUI عند إنشائه، ولكنه يتم تحويله عند أول استدعاء إلى win32k.sys، أو من خلال استدعاء API ل [IsGuiThread](/windows/win32/api/winuser/nf-winuser-isguithread).

### <a name="compatibility-considerations"></a>اعتبارات التوافق

تم تصميم هذا التخفيف للعمليات التي تكون عمليات غير مخصصة لواجهة المستخدم. على سبيل المثال، ستستخدم العديد من المستعرضات الحديثة عزل العملية وتضمين العمليات غير المتعلقة بواجهة المستخدم. سيتأثر أي تطبيق يعرض واجهة المستخدم الرسومية (GUI) باستخدام عملية واحدة بهذا التخفيف.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="do-not-allow-child-processes"></a>عدم السماح بالعمليات التابعة

### <a name="description"></a>الوصف

يمنع التخفيف هذا أحد التطبيقات من إنشاء تطبيقات تابعة جديدة. إحدى التقنيات الشائعة التي يستخدمها المتطفلون هي بدء عملية موثوق بها على الجهاز باستخدام إدخال ضار (هجوم "تعيش على الأرض")، والذي غالبا ما يتطلب تشغيل تطبيق آخر على الجهاز. إذا لم تكن هناك أي أسباب قانونية وراء قيام أحد التطبيقات بتشغيل عملية تابعة، فإن التخفيف من حدة هذا يقلل من خط الهجوم المحتمل هذا. يتم تطبيق التخفيف عن طريق تعيين خاصية على الرمز المميز للعملية، مما يؤدي إلى حظر إنشاء رمز مميز للعملية التابعة مع رسالة الخطأ STATUS_CHILD_PROCESS_BLOCKED.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

إذا قام تطبيقك بتشغيل التطبيقات التابعة لأي سبب، مثل دعم الارتباطات التشعبية التي تقوم بتشغيل مستعرض أو مستعرض خارجي، أو التي تقوم بتشغيل أدوات مساعدة أخرى على الكمبيوتر، فسيتم قطع هذه الوظيفة مع تطبيق التخفيف هذا.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="export-address-filtering"></a>تصدير عوامل تصفية العنوان (EAF)

### <a name="description"></a>الوصف

تعمل تصفية عنوان التصدير (EAF) على تقليل مخاطر التعليمات البرمجية الضارة التي تنظر إلى جدول عنوان التصدير لكافة الوحدات النمطية التي تم تحميلها للعثور على الوحدات النمطية التي تحتوي على واجهات برمجة تطبيقات مفيدة للهجوم. هذا أسلوب شائع يستخدمه shellcode. للتخفيف من مخاطر مثل هذا الهجوم، يحمي هذا التخفيف ثلاث وحدات نمطية شائعة الهجوم:

- ntdll.dll
- kernelbase.dll
- kernel32.dll

يحمي التخفيف صفحة الذاكرة في [دليل التصدير الذي يشير إلى [جدول عنوان التصدير](/windows/win32/debug/pe-format#export-address-table). سيتم تطبيق الحماية [PAGE_GUARD](/windows/win32/memory/creating-guard-pages) على صفحة الذاكرة هذه. عندما يحاول شخص ما الوصول إلى هذه الذاكرة، سيتم إنشاء STATUS_GUARD_PAGE_VIOLATION. يعالج التخفيف هذا الاستثناء، وإذا لم تجتز إرشادات الوصول عملية التحقق من الصحة، فسيتم إنهاء العملية.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

هذا التخفيف هو في الأساس مشكلة للتطبيقات مثل مصححات الأخطاء أو تطبيقات آلية تحديد الوصول أو التطبيقات التي تستخدم DRM أو التطبيقات التي تطبق تقنية مكافحة تصحيح الأخطاء.

### <a name="configuration-options"></a>خيارات التكوين

**التحقق من صحة الوصول إلى الوحدات النمطية التي يتم إساءة استخدامها بشكل شائع من قبل عمليات الاستغلال** - يضيف هذا الخيار، المعروف أيضا باسم EAF+، الحماية للوحدات النمطية الأخرى التي تتعرض للهجوم بشكل شائع:

- `mshtml.dll`
- `flash*.ocx`
- `jscript*.ocx`
- `vbscript.dll`
- `vgx.dll`
- `mozjs.dll`
- `xul.dll`
- `acrord32.dll`
- `acrofx32.dll`
- `acroform.api`

بالإضافة إلى ذلك، من خلال تمكين EAF+، يضيف التخفيف هذا الحماية PAGE_GUARD إلى الصفحة التي تحتوي على رأس "MZ"، أول بايتين [لرأس DOS في ملف PE](/windows/win32/debug/pe-format#ms-dos-stub-image-only)، وهو جانب آخر من محتوى الذاكرة المعروفة الذي يمكن أن يبحث عنه shellcode لتحديد الوحدات النمطية التي قد تهم الذاكرة.

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="force-randomization-for-images-mandatory-aslr"></a>فرض إعادة الترتيب العشوائي للصور (ASLR إلزامي)

### <a name="description"></a>الوصف

تخفف عشوائية تخطيط مساحة العنوان (ASLR) من مخاطر المهاجم باستخدام معرفته لتخطيط ذاكرة النظام من أجل تنفيذ التعليمات البرمجية الموجودة بالفعل في ذاكرة العملية وتم وضع علامة عليها بالفعل كملف تنفيذي. يمكن أن يقلل هذا من مخاطر المهاجم باستخدام أساليب مثل هجمات العودة إلى libc، حيث يقوم المتطفل بتعيين السياق ثم تعديل عنوان الإرجاع لتنفيذ التعليمات البرمجية الموجودة مع السياق الذي يناسب غرض الخصم.

يفرض ASLR الإلزامي إعادة قاعدة لكافة DLL داخل العملية. يمكن للمطور تمكين ASLR باستخدام خيار [/DYNAMICBASE](/cpp/build/reference/dynamicbase-use-address-space-layout-randomization) linker، وهذا التخفيف له نفس التأثير.

عندما تقوم إدارة الذاكرة بتعيين الصورة في العملية، ستقوم ASLR الإلزامية بإعادة إنشاء قوائم DLL و EXEs التي لم تشترك في ASLR. لاحظ، على الرغم من ذلك، أن إعادة التكبير هذه لا تحتوي على إنتروبيا، وبالتالي يمكن وضعها في موقع يمكن التنبؤ به في الذاكرة. بالنسبة إلى الموقع العشوائي والمعاد تعيينه للثنائيات، يجب إقران هذا التخفيف [بتخصيصات الذاكرة العشوائية (ASLR من الأسفل إلى الأعلى)](#randomize-memory-allocations-bottom-up-aslr).

### <a name="compatibility-considerations"></a>اعتبارات التوافق

عادة ما يكون تأثير التوافق ل ASLR مقيدا بالتطبيقات القديمة التي تم إنشاؤها باستخدام المحولات البرمجية التي قامت بإنشاء افتراضات حول العنوان الأساسي لملف ثنائي أو قد جردت معلومات تغيير الموقع الأساسية. يمكن أن يؤدي ذلك إلى أخطاء غير متوقعة حيث يحاول تدفق التنفيذ الانتقال إلى الموقع المتوقع، بدلا من الموقع الفعلي، في الذاكرة.

### <a name="configuration-options"></a>خيارات التكوين

**عدم السماح بالصور المجردة** - يحظر هذا الخيار تحميل الصور التي تم تجريد معلومات تغيير الموقع منها. يحتوي تنسيق ملف Windows PE على عناوين مطلقة، ويقوم المحول البرمجي أيضا بإنشاء جدول [تغيير موقع أساسي يمكن أن يستخدمه المحمل للبحث عن كل مراجع الذاكرة النسبية وإزاحتها، بحيث يمكن تحديثها إذا لم يتم تحميل الثنائي على عنوانه الأساسي المفضل. تقوم بعض التطبيقات القديمة بسحب هذه المعلومات في إصدارات الإنتاج، وبالتالي لا يمكن إعادة إنشاء هذه الثنائيات. يؤدي هذا التخفيف إلى منع تحميل هذه الثنائيات (بدلا من السماح لها بالتحميل على عنوانها الأساسي المفضل).

> [!Note]
> **فرض العشوائية للصور (ASLR الإلزامي)** ليس له وضع تدقيق.

## <a name="import-address-filtering-iaf"></a>استيراد عوامل تصفية العنوان (IAF)

### <a name="description"></a>الوصف

يساعد تقليل مخاطر تصفية عنوان الاستيراد (IAF) على تقليل مخاطر تغيير الخصم لتدفق التحكم في أحد التطبيقات عن طريق تعديل جدول عنوان الاستيراد (IAT) لإعادة التوجيه إلى التعليمات البرمجية العشوائية لاختيار المهاجم عند استدعاء هذه الدالة. يمكن للمهاجم استخدام هذا النهج لسرقة التحكم، أو لاعتراض المكالمات وفحصها وحظرها لواجهات برمجة التطبيقات الحساسة.

سيتم تطبيق [حماية PAGE_GUARD](/windows/win32/memory/creating-guard-pages) على صفحات الذاكرة لكافة واجهات برمجة التطبيقات المحمية. عندما يحاول شخص ما الوصول إلى هذه الذاكرة، سيتم إنشاء STATUS_GUARD_PAGE_VIOLATION. يعالج التخفيف هذا الاستثناء، وإذا لم تجتز إرشادات الوصول عملية التحقق من الصحة، فسيتم إنهاء العملية.

يحمي هذا التخفيف واجهات برمجة تطبيقات Windows التالية:

- `GetProcAddress`
- `GetProcAddressForCaller`
- `LoadLibraryA`
- `LoadLibraryExA`
- `LoadLibraryW`
- `LoadLibraryExW`
- `LdrGetProcedureAddress`
- `LdrGetProcedureAddressEx`
- `LdrGetProcedureAddressForCaller`
- `LdrLoadDll`
- `VirtualProtect`
- `VirtualProtectEx`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `NtProtectVirtualMemory`
- `CreateProcessA`
- `CreateProcessW`
- `WinExec`
- `CreateProcessAsUserA`
- `CreateProcessAsUserW`
- `GetModuleHandleA`
- `GetModuleHandleW`
- `RtlDecodePointer`
- `DecodePointer`

### <a name="compatibility-considerations"></a>اعتبارات التوافق

قد يتم اكتشاف التطبيقات المشروعة التي تقوم باعتراض واجهة برمجة التطبيقات بواسطة هذا التخفيف ويتسبب في تعطل بعض التطبيقات. تتضمن الأمثلة برامج الأمان وشرائح توافق التطبيقات.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="randomize-memory-allocations-bottom-up-aslr"></a>ترتيب تخصيصات الذاكرة عشوائيًا (ASLR من أسفل لأعلى)

### <a name="description"></a>الوصف

تضيف تخصيصات الذاكرة العشوائية (ASLR من الأسفل إلى الأعلى) إنتروبيا إلى عمليات تغيير الموقع، بحيث يكون موقعها عشوائيا وبالتالي أقل قابلية للتنبؤ. يتطلب التخفيف هذا أن يصبح ASLR الإلزامي ساري المفعول.

يضع حجم مساحة العنوان 32 بت قيودا عملية على الإنتروبيا التي يمكن إضافتها، وبالتالي تجعل تطبيقات 64 بت من الصعب على المهاجم تخمين موقع في الذاكرة.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

تتوافق معظم التطبيقات المتوافقة مع ASLR الإلزامي (rebasing) أيضًا مع الإدخالات الأخرى الخاصة ب ASLR من الأسفل إلى الأعلى. قد تواجه بعض التطبيقات مشاكل في اقتطاع المؤشر إذا كانت تحفظ المؤشرات المحلية في متغيرات 32 بت (توقع عنوان أساسي أقل من 4 غيغابايت)، وبالتالي ستكون غير متوافقة مع خيار الإدخال العالي (الذي يمكن تعطيله).

### <a name="configuration-options"></a>خيارات التكوين

**لا تستخدم إنتروبيا مرتفعة** - يقوم هذا الخيار بتعطيل استخدام ASLR عالي الإنتروب، الذي يضيف 24 بت من الإنتروب (1 تيرابايت من التباين) إلى التخصيص من الأسفل إلى الأعلى لتطبيقات 64 بت.

> [!Note]
> لا يحتوي **تخصيصات الذاكرة العشوائية (ASLR من أسفل إلى أعلى)** على وضع تدقيق.

## <a name="simulate-execution-simexec"></a>محاكاة التنفيذ (SimExec)

### <a name="description"></a>الوصف

يعد تنفيذ محاكاة (SimExec) تقليلا لتطبيقات 32 بت فقط. يساعد هذا في التحقق من أن المكالمات إلى واجهات برمجة التطبيقات الحساسة ستعود إلى وظائف المتصل المشروعة. يقوم بذلك عن طريق اعتراض المكالمات في واجهات برمجة التطبيقات الحساسة، ثم محاكاة تنفيذ واجهات برمجة التطبيقات هذه من خلال السير عبر إرشادات لغة التجميع المرمزة التي تبحث عن إرشادات RET، والتي يجب أن تعود إلى المتصل. ثم يفحص هذه الدالة وينتقل إلى الخلف في الذاكرة للعثور على إرشادات CALL السابقة لتحديد ما إذا كانت الدالة وإرشادات CALL مطابقة، وأنه لم يتم اعتراض RET.

واجهات برمجة التطبيقات التي تم اعتراضها بواسطة هذا التخفيف هي:

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

إذا تم اكتشاف أداة ROP ذكية، يتم إنهاء العملية.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

يمكن أن تتسبب التطبيقات التي تقوم باعتراض واجهة برمجة التطبيقات، لا سيما برامج الأمان، في حدوث مشاكل في التوافق مع هذا التخفيف.

هذا التخفيف غير متوافق مع التخفيف من الحماية من التعليمات البرمجية العشوائية.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="validate-api-invocation-callercheck"></a>التحقق من صحة استدعاء واجهة برمجة التطبيقات API (CallerCheck)

### <a name="description"></a>الوصف

يعد التحقق من صحة استدعاء API (CallerCheck) تقليلا لتقنيات البرمجة الموجهة للإرجاع (ROP) التي تتحقق من استدعاء واجهات برمجة التطبيقات الحساسة من متصل صالح. يفحص التخفيف هذا عنوان المرسل الذي تم تمريره، ثم يقوم بفك التجميع للخلف بشكل عمودي للعثور على مكالمة أعلى عنوان الإرجاع لتحديد ما إذا كان هدف الاستدعاء يطابق المعلمة التي تم تمريرها إلى الدالة.

واجهات برمجة التطبيقات التي تم اعتراضها بواسطة هذا التخفيف هي:

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

إذا تم اكتشاف أداة ROP ذكية، يتم إنهاء العملية.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

يمكن أن تتسبب التطبيقات التي تقوم باعتراض واجهة برمجة التطبيقات، لا سيما برامج الأمان، في حدوث مشاكل في التوافق مع هذا التخفيف.

هذا التخفيف غير متوافق مع التخفيف من الحماية من التعليمات البرمجية العشوائية.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="validate-exception-chains-sehop"></a>التحقق من صحة سلاسل الاستثناء (SEHOP)

### <a name="description"></a>الوصف

التحقق من صحة سلاسل الاستثناءات (SEHOP) هو تقليل من مخاطر استخدام معالج *الاستثناء المركب (SEH) فوق* تقنية الاستغلال. [معالجة الاستثناءات المنظمة](/windows/win32/debug/structured-exception-handling) هي العملية التي يمكن للتطبيق من خلالها طلب معالجة استثناء معين. يتم تسلسل معالجات الاستثناءات معا، بحيث إذا اختار معالج استثناء واحد عدم معالجة استثناء معين، يمكن تمريره إلى معالج الاستثناء التالي في السلسلة حتى يقرر أحد المعالجات معالجته. نظرا لأن قائمة المعالج ديناميكية، يتم تخزينها على المكدس. يمكن للمهاجم استخدام ثغرة أمنية في تجاوز المكدس للكتابة فوق معالج الاستثناء باستخدام مؤشر للتعليمات البرمجية لاختيار المهاجم.

يعتمد التخفيف هذا على تصميم SEH، حيث يحتوي كل إدخال SEH على كل من مؤشر لمعالج الاستثناء، بالإضافة إلى مؤشر إلى المعالج التالي في سلسلة الاستثناءات. يتم استدعاء التخفيف هذا بواسطة مرسل الاستثناء، الذي يتحقق من صحة سلسلة SEH عند استدعاء استثناء. يتحقق من أن:

- تقع كل سجلات سلسلة الاستثناءات ضمن حدود المكدس
- تمت محاذاة كافة سجلات الاستثناءات
- لا توجد أي مؤشرات معالج استثناء تشير إلى المكدس
- لا توجد أي مؤشرات للخلف
- تنتهي سلسلة الاستثناءات بمعالج استثناء نهائي معروف

إذا فشلت عمليات التحقق من الصحة هذه، فسيتم إجهاض معالجة الاستثناء، ولن تتم معالجة الاستثناء.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

تعد مشاكل التوافق مع SEHOP نادرة نسبيا. من غير الشائع أن يتخذ التطبيق تبعية لتلف سلسلة الاستثناءات. ومع ذلك، تتأثر بعض التطبيقات بالتغييرات الدقيقة في التوقيت، والتي قد تظهر كشرط تعارض يكشف عن خطأ ترابط متعدد في التطبيق.

### <a name="configuration-options"></a>خيارات التكوين

> [!Note]
> **لا يحتوي التحقق من صحة سلاسل الاستثناءات (SEHOP)** على وضع تدقيق.

## <a name="validate-handle-usage"></a>التحقق من صحة استخدام المؤشر

### <a name="description"></a>الوصف

*التحقق من صحة استخدام المعالجة* هو تقليل يساعد على الحماية من المهاجم باستخدام مقبض موجود للوصول إلى عنصر محمي. [المؤشر](/windows/win32/sysinfo/handles-and-objects) هو مرجع لعنصر محمي. إذا كانت تعليمات التطبيق البرمجية تشير إلى مؤشر غير صالح، فقد يشير ذلك إلى أن الخصم يحاول استخدام مقبض قام بتسجيله مسبقا (ولكن عدد مراجع التطبيق الذي لن يكون على علم به). إذا حاول التطبيق استخدام عنصر غير صالح، بدلا من إرجاع قيمة خالية ببساطة، فسيطرح التطبيق استثناء (STATUS_INVALID_HANDLE).

يتم تطبيق هذا التخفيف تلقائيا على تطبيقات متجر Windows.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

من المحتمل أن تتأثر التطبيقات التي لم تكن تتعقب مراجع المؤشرات بدقة، والتي لم تكن تقوم بالتفاف هذه العمليات في معالجات الاستثناءات، بهذا التخفيف.

### <a name="configuration-options"></a>خيارات التكوين

> [!Note]
> **لا يحتوي "التحقق من صحة استخدام المعالجة** " على وضع تدقيق.

## <a name="validate-heap-integrity"></a>التحقق من صحة تكامل كومة الذاكرة المؤقتة

### <a name="description"></a>الوصف

يعمل *تقليل تكامل كومة الذاكرة المؤقتة للتحقق من الصحة* على زيادة مستوى الحماية للتخفيف من حدة كومة الذاكرة المؤقتة في Windows، عن طريق التسبب في إنهاء التطبيق إذا تم الكشف عن تلف كومة الذاكرة المؤقتة. تتضمن عوامل التخفيف ما يلي:

- منع تحرير مقبض HEAP
- إجراء تحقق آخر من الصحة على رؤوس الكتلة الموسعة لتخصيصات كومة الذاكرة الخاصة بكعب الذاكرة
- التحقق من أن تخصيصات كومة الذاكرة المؤقتة لم يتم بالفعل وضع علامة عليها كغير مستخدمة
- إضافة صفحات حماية إلى التخصيصات الكبيرة ومقاطع كومة الذاكرة المؤقتة والفئات الفرعية التي تتجاوز الحد الأدنى للحجم

### <a name="compatibility-considerations"></a>اعتبارات التوافق

يتم بالفعل تطبيق التخفيف هذا بشكل افتراضي على تطبيقات 64 بت وتطبيقات 32 بت التي تستهدف نظام التشغيل Windows Vista أو الإصدارات الأحدث. التطبيقات القديمة من Windows XP أو الإصدارات السابقة هي الأكثر عرضة للخطر، على الرغم من أن مشاكل التوافق نادرة.

### <a name="configuration-options"></a>خيارات التكوين

> [!Note]
> **لا يحتوي التحقق من صحة تكامل كومة الذاكرة المؤقتة** على وضع تدقيق.

## <a name="validate-image-dependency-integrity"></a>التحقق من صحة تكامل تبعية الصورة

### <a name="description"></a>الوصف

يساعد *التحقق من صحة تقليل تبعية الصورة* على الحماية من الهجمات التي تحاول استبدال التعليمات البرمجية ل dlls المرتبطة بشكل ثابت بواسطة ثنائيات Windows. تسيء تقنية زرع DLL آلية البحث الخاصة بالمحمل لإدخال تعليمات برمجية ضارة، والتي يمكن استخدامها لتشغيل التعليمات البرمجية الضارة في سياق مرتفع. عندما يقوم المحمل بتحميل ثنائي موقع من Windows، ثم يقوم بتحميل أي dlls يعتمد عليها الثنائي، سيتم التحقق من هذه الثنائيات للتأكد من أنها موقعة رقميا أيضا كثنائي Windows. إذا فشل التحقق من التوقيع، فلن يتم تحميل dll، وسيتم طرح استثناء، مما يؤدي إلى إرجاع حالة STATUS_INVALID_IMAGE_HASH.

### <a name="compatibility-considerations"></a>اعتبارات التوافق

مشاكل التوافق غير شائعة. ستتأثر التطبيقات التي تعتمد على استبدال ثنائيات Windows بإصدارات خاصة محلية، وهناك أيضا خطر صغير من الكشف عن أخطاء التوقيت الدقيقة في التطبيقات متعددة مؤشرات الترابط.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).

## <a name="validate-stack-integrity-stackpivot"></a>التحقق من صحة تكامل المكدس (StackPivot)

### <a name="description"></a>الوصف

يساعد *التخفيف من صحة تكامل المكدس (StackPivot)* على الحماية من هجوم Stack Pivot، وهو هجوم ROP حيث يقوم المهاجم بإنشاء مكدس زائف في ذاكرة كومة الذاكرة المؤقتة، ثم يخدع التطبيق للعودة إلى المكدس الزائف الذي يتحكم في تدفق التنفيذ.

يؤدي التخفيف من المخاطر إلى اعتراض العديد من واجهات برمجة التطبيقات ل Windows، ويفحص قيمة مؤشر المكدس. إذا لم يقع عنوان مؤشر المكدس بين الجزء السفلي والأعلى من المكدس، فسيتم تسجيل حدث، وإذا لم يكن في وضع التدقيق، فسيتم إنهاء العملية.

واجهات برمجة التطبيقات التي تم اعتراضها بواسطة هذا التخفيف هي:

- `LoadLibraryA`
- `LoadLibraryW`
- `LoadLibraryExA`
- `LoadLibraryExW`
- `LdrLoadDll`
- `VirtualAlloc`
- `VirtualAllocEx`
- `NtAllocateVirtualMemory`
- `VirtualProtect`
- `VirtualProtectEx`
- `NtProtectVirtualMemory`
- `HeapCreate`
- `RtlCreateHeap`
- `CreateProcessA`
- `CreateProcessW`
- `CreateProcessInternalA`
- `CreateProcessInternalW`
- `NtCreateUserProcess`
- `NtCreateProcess`
- `NtCreateProcessEx`
- `CreateRemoteThread`
- `CreateRemoteThreadEx`
- `NtCreateThreadEx`
- `WriteProcessMemory`
- `NtWriteVirtualMemory`
- `WinExec`
- `CreateFileMappingA`
- `CreateFileMappingW`
- `CreateFileMappingNumaW`
- `NtCreateSection`
- `MapViewOfFile`
- `MapViewOfFileEx`
- `MapViewOfFileFromApp`
- `LdrGetProcedureAddressForCaller`

### <a name="compatibility-considerations"></a>اعتبارات التوافق

ستتأثر التطبيقات التي تستخدم مكدسات مزيفة، وهناك أيضا خطر صغير من الكشف عن أخطاء التوقيت الدقيقة في التطبيقات متعددة مؤشرات الترابط.
يمكن أن تتسبب التطبيقات التي تقوم باعتراض واجهة برمجة التطبيقات، لا سيما برامج الأمان، في حدوث مشاكل في التوافق مع هذا التخفيف.

هذا التخفيف غير متوافق مع التخفيف من الحماية من التعليمات البرمجية العشوائية.

### <a name="configuration-options"></a>خيارات التكوين

**التدقيق فقط** - يمكنك تمكين هذا التخفيف في وضع التدقيق لقياس تأثير التوافق المحتمل على أحد التطبيقات. يمكن بعد ذلك عرض أحداث التدقيق إما في عارض الحدث أو باستخدام "التعقب المتقدم" في [Microsoft Defender for Endpoint](/microsoft-365/security/defender/advanced-hunting-overview).
