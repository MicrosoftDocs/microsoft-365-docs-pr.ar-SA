---
title: التهديدات بدون ملفات
ms.reviewer: ''
description: تعرف على فئات التهديدات والبرامج الضارة بدون ملفات التي تعيش على الأرض
keywords: البرامج الضارة بدون ملفات، تعيش خارج الأرض، lolbins، amsi، مراقبة السلوك، مسح الذاكرة، حماية قطاع التشغيل، الأمان، البرامج الضارة، Windows Defender ATP، الحماية من الفيروسات، AV، MICROSOFT Defender ATP، حماية الجيل التالي
ms.prod: m365-security
ms.mktglfcycl: secure
ms.sitesec: library
ms.localizationpriority: medium
ms.author: dansimp
author: dansimp
manager: dansimp
audience: ITPro
ms.collection: M365-security-compliance
ms.topic: article
search.appverid: met150
ms.technology: m365d
ms.openlocfilehash: 97545714ff468c7be238585ab5d137a1ac93a5f9
ms.sourcegitcommit: b3530441288b2bc44342e00e9025a49721796903
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 03/20/2022
ms.locfileid: "63705913"
---
# <a name="fileless-threats"></a>التهديدات بدون ملفات

ما هي التهديدات بدون ملفات بالضبط؟ يشير مصطلح "بدون ملف" إلى أن الخطر لا يأتي في ملف، مثل الجزء الخلفي الذي يعيش فقط في ذاكرة جهاز. ومع ذلك، لا يوجد تعريف واحد للبرامج الضارة بدون ملفات. يتم استخدام المصطلح على نطاق واسع، وفي بعض الأحيان لوصف عائلات البرامج الضارة التي تعتمد على الملفات لتشغيلها.

تتضمن الهجمات [مراحل متعددة](https://attack.mitre.org/wiki/ATT&CK_Matrix) لوظائف مثل التنفيذ أو الثبات أو سرقة المعلومات. قد تكون بعض أجزاء سلسلة الهجمات غير ملفية، بينما قد تتضمن أجزاء أخرى نظام الملفات في شكل ما.

للوضوح، يتم تجميع التهديدات بدون ملفات في فئات مختلفة.

![رسم تخطيطي شامل للبرامج الضارة بدون ملفات.](../../media/security-intelligence-images/fileless-malware.png)<br>
*الشكل 1. رسم تخطيطي شامل للبرامج الضارة بدون ملفات*

يمكن تصنيف التهديدات بدون ملفات حسب نقطة الإدخال الخاصة بها، والتي تشير إلى كيفية وصول البرامج الضارة بدون ملفات على جهاز. ويمكنهم الوصول عبر استغلال، أو عبر أجهزة مهينة، أو عبر التنفيذ المنتظم للتطبيقات والبرامج النصية.

بعد ذلك، سرد شكل نقطة الإدخال. على سبيل المثال، يمكن أن تستند استغلالات إلى ملفات أو بيانات شبكة، وأجهزة PCI الطرفية هي نوع من متجهات الأجهزة، والبرامج النصية والنصية القابلة للتنفيذ هي الفئات الفرعية لمتجه التنفيذ.

وأخيرا، صنف مضيف الإصابة. على سبيل المثال، قد يحتوي تطبيق Flash على مجموعة متنوعة من التهديدات مثل استغلال، برنامج ثابت بسيط قابل للتنفيذ، وضار من جهاز.

يساعدك التصنيف على تقسيم الأنواع المختلفة من التهديدات بدون ملفات وتصنيفها. بعضها أكثر خطورة ولكن أيضا أكثر صعوبة في التنفيذ، بينما يستخدم البعض الآخر بشكل أكثر شيوعا على الرغم من (أو بالتحديد بسبب) عدم التقدم بشكل كبير.

من هذا التصنيف، يمكنك فهم ثلاثة أنواع رئيسية من التهديدات بدون ملفات استنادا إلى عدد بصمات الأصابع التي قد تتركها على الأجهزة المصابة.

## <a name="type-i-no-file-activity-performed"></a>النوع الأول: لم يتم تنفيذ أي نشاط ملف

يمكن اعتبار البرامج الضارة التي لا تحتاج إلى ملف بالكامل واحدة لا تتطلب أبدا كتابة ملف على القرص. كيف يمكن لمثل هذه البرامج الضارة إصابة جهاز في المقام الأول؟ مثال على ذلك هو المكان الذي يتلقى فيه الجهاز الهدف حزم الشبكة الضارة التي تستغل ثغرة أمنية فييوبلو. تسمح الثغرة الأمنية بتثبيت الجزء الخلفي DoublePulsar، الذي ينتهي به الأمر بالسكن فقط في ذاكرة النواة. في هذه الحالة، لا يوجد ملف أو أي بيانات مكتوبة على ملف.

قد يكون للجهاز الذي تم اختراقه تعليمات برمجية ضارة مختفية في البرامج الثابتة للجهاز (مثل BIOS) أو جهاز USB طرفي (مثل هجوم BadUSB) أو في البرامج الثابتة لبطاقة شبكة. لا تتطلب كل هذه الأمثلة ملفا على القرص لتشغيله، ويمكن أن تعيش في الذاكرة فقط من الناحية النظرية. سوف تبقى التعليمات البرمجية الضارة بعد إعادة التشغيل وإعادة تثبيت القرص وإعادة تثبيت نظام التشغيل.

قد يكون الكشف عن حالات الإصابة بهذا النوع من الفيروسات صعبا بشكل خاص لأن معظم منتجات الحماية من الفيروسات لا تملك القدرة على فحص البرامج الثابتة. في الحالات التي يكون فيها المنتج لديه القدرة على فحص البرامج الثابتة الضارة والكشف عنها، لا تزال هناك تحديات كبيرة مقترنة ب المعالجة من التهديدات على هذا المستوى. يتطلب هذا النوع من البرامج الضارة بدون ملفات مستويات عالية من التطور ويعتمد في أغلب الأحيان على تكوين أجهزة أو برامج معينة. إنه ليس متجه هجوم يمكن استغلاله بسهولة وموثوقية. وعلى الرغم من خطورة التهديدات من هذا النوع، غير شائعة وغير عملية لمعظم الهجمات.

## <a name="type-ii-indirect-file-activity"></a>النوع الثاني: نشاط الملف غير المباشر

هناك طرق أخرى يمكن للبرامج الضارة من خلالها تحقيق حالة الحضور بدون ملفات على جهاز دون الحاجة إلى بذل جهد هندسي كبير. لا تكتب البرامج الضارة بدون ملفات من هذا النوع الملفات مباشرة على نظام الملفات، ولكن يمكن أن تستخدم الملفات بشكل غير مباشر. على سبيل المثال، مع تثبيت مهاجمي [Poshspy backdoor](https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html) أمر PowerShell ضار داخل مستودع WMI وتكوين عامل تصفية WMI لتشغيل الأمر بشكل دوري.

من الممكن تنفيذ مثل هذا التثبيت عبر سطر الأوامر دون الحاجة إلى أن يكون هناك بالفعل خط خلفي على الملف. يمكن تثبيت البرامج الضارة وتشغيلها من الناحية النظرية دون لمس نظام الملفات. ومع ذلك، يتم تخزين مستودع WMI على ملف فعلي في منطقة تخزين مركزية يديرها مدير كائن CIM، ويحتوي عادة على بيانات شرعية. على الرغم من أن سلسلة الإصابة تستخدم ملفا فعليا من الناحية التقنية، إلا أنه يعتبر هجوم بدون ملف لأن مستودع WMI هو حاوية بيانات متعددة الأغراض لا يمكن الكشف عنها وإزالتها.

## <a name="type-iii-files-required-to-operate"></a>النوع الثالث: الملفات المطلوبة للعمل

يمكن أن يكون لبعض البرامج الضارة نوع من الثبات بدون ملفات، ولكن ليس من دون استخدام الملفات لتشغيلها. مثال على هذا السيناريو هو Kovter، الذي ينشئ معالج فعل shell مفتوح في السجل لملحق ملف عشوائي. سيؤدي فتح ملف بهذا الملحق إلى تنفيذ برنامج نصي من خلال الأداة mshta.exe.

![صورة لمفتاح التسجيل الخاص ب Kovter.](../../media/security-intelligence-images/kovter-reg-key.png)<br>
*الشكل 2. مفتاح التسجيل الخاص ب Kovter*

عند استدعاء الفعل المفتوح، يتم تشغيل الأمر المقترن من السجل، مما يؤدي إلى تنفيذ برنامج نصي صغير. يقرأ هذا البرنامج النصي البيانات من مفتاح تسجيل آخر وينفذها، مما يؤدي بدوره إلى تحميل الحمولة النهائية. ومع ذلك، لكي يتم تشغيل الفعل المفتوح في المقام الأول، يجب على Kovter إسقاط ملف بنفس الملحق الذي يستهدفه الفعل (في المثال أعلاه، الملحق هو .bbf5590fd). كما يجب تعيين مفتاح تشغيل تلقائي تم تكوينه لفتح مثل هذا الملف عند بدء تشغيل الجهاز.

يعتبر Kovter خطرا بدون ملف لأن نظام الملفات ليس له أي استخدام عملي. تحتوي الملفات ذات الملحقات العشوائية على بيانات غير هام غير قابلة للاستخدام في التحقق من وجود الخطر. الملفات التي تخزن السجل هي حاويات لا يمكن الكشف عنها وحذفها إذا كان المحتوى الضار موجودا.

## <a name="categorizing-fileless-threats-by-infection-host"></a>تصنيف التهديدات غير الملفية من قبل مضيف الإصابة

بعد وصف الفئات العريضة، يمكننا الآن التعمق في التفاصيل وتقديم تصنيف تفصيلي لمضيفي الإصابة. يتناول هذا التصنيف الشامل بانوراما ما يشار إليه عادة بالبرامج الضارة غير الملف. فهو يدفع جهودنا للبحث عن ميزات حماية جديدة وتطويرها لتحييد فئات الهجمات وضمان عدم حصول البرامج الضارة على أفضلية في سباق الأسلحة.

### <a name="exploits"></a>استغلالات

مستند **إلى** الملف (النوع الثالث: قابل للتنفيذ وفلاش وجافا والمستندات): قد يستغل الملف الأولي نظام التشغيل والمستعرض ومحرك Java ومحرك Flash وغير ذلك لتنفيذ رمز shellcode وتسليم حمولة في الذاكرة. على الرغم من أن الحمولة بدون ملف، فإن متجه الإدخال الأولي هو ملف.

**مستند إلى الشبكة** (النوع الأول): يمكن أن يحقق اتصال الشبكة الذي يستفيد من ثغرة في الجهاز الهدف تنفيذ التعليمات البرمجية في سياق تطبيق أو النواة. مثال على ذلك هو WannaCry، الذي يستغل ثغرة أمنية تم إصلاحها مسبقا في بروتوكول SMB لتقديم نقطة عودة داخل ذاكرة kernel.

### <a name="hardware"></a>الأجهزة

**مستندة إلى الجهاز** (النوع الأول: بطاقة الشبكة، القرص الثابت): تتطلب الأجهزة مثل الأقراص الثابتة وبطاقات الشبكة مجموعات شرائح وبرامج مخصصة لكي تعمل. تسمى البرامج المقيمة والمجرية في مجموعة شرائح الجهاز البرامج الثابتة. على الرغم من أن هذه المهمة معقدة، إلا أنه يمكن إصابة البرامج الثابتة بالبرامج الضارة، كما تم ضبط مجموعة المعادلات [التجسسية وهي تقوم بذلك](https://www.kaspersky.com/blog/equation-hdd-malware/7623/).

**وحدات المعالجة المركزية (TYPE** I) المستندة إلى CPU: وحدات المعالجة المركزية الحديثة معقدة وقد تتضمن أنظمة فرعية تقوم بتشغيل البرامج الثابتة لأغراض الإدارة. قد تكون هذه البرامج الثابتة عرضة للاختطاف والسماح بتنفيذ التعليمات البرمجية الضارة التي يمكن أن تعمل من داخل وحدة المعالجة المركزية (CPU). في ديسمبر 2017، قام باحثان ب إنشاء التقارير حول ثغرة أمنية يمكن أن تسمح للمهاجمين بتنفيذ التعليمات البرمجية داخل "محرك الإدارة" [(ME)](https://en.wikipedia.org/wiki/Intel_Management_Engine) الحالي في أي وحدة CPU حديثة من Intel. في هذه الأثناء، تم ملاحظة أن المجموعة المهاجمة PLATINUM لديها القدرة على استخدام تقنية الإدارة النشطة [(AMT)](https://en.wikipedia.org/wiki/Intel_Active_Management_Technology) من Intel لإجراء اتصالات الشبكة [](https://cloudblogs.microsoft.com/microsoftsecure/2017/06/07/platinum-continues-to-evolve-find-ways-to-maintain-invisibility/)غير المرئية، متجاوزة نظام التشغيل المثبت. تعد ME و AMT أساسا أجهزة كمبيوتر صغيرة تعمل داخل وحدة المعالجة المركزية (CPU) وتعمل على مستوى منخفض جدا. ونظرا لأن الغرض من هذه التقنيات هو توفير إمكانية الإدارة عن بعد، فإنها تملك إمكانية الوصول المباشر إلى الأجهزة، وهي مستقلة عن نظام التشغيل، ويمكن تشغيلها حتى إذا تم إيقاف تشغيل الكمبيوتر.

إلى جانب كون وحدات المعالجة المركزية عرضة للتأثر على مستوى البرامج الثابتة، يمكن تصنيع وحدات المعالجة المركزية (CP) باستخدام دوائر خلفية يتم إدراجها مباشرة في دائرة الأجهزة. لقد تم إجراء أبحاث [حول هذا الهجوم وثبت](https://www.emsec.rub.de/media/crypto/veroeffentlichungen/2015/03/19/beckerStealthyExtended.pdf) أنه ممكن في الماضي. تم الإعراب عن أن نماذج معينة من معالجات x86 تحتوي على نواة CPU ثانوية مضمنة مثل RISC يمكن أن توفر بشكل فعال نقطة خلف يمكن للتطبيقات العادية من خلالها الحصول على تنفيذ متميز.[](https://www.theregister.co.uk/2018/08/10/via_c3_x86_processor_backdoor/)

**مستندة إلى** USB (النوع الأول): يمكن إعادة برمجة أجهزة USB بجميع أنواعها باستخدام البرامج الثابتة الضارة القادرة على التفاعل مع نظام التشغيل بطرق خبيثة. على سبيل المثال، تسمح تقنية [BadUSB](https://arstechnica.com/information-technology/2014/07/this-thumbdrive-hacks-computers-badusb-exploit-makes-devices-turn-evil/) باستخدام عصا USB المعاد برمجته للعمل كلوحة مفاتيح ترسل الأوامر إلى الأجهزة عبر ضغطات المفاتيح، أو كبطاقة شبكة يمكنها إعادة توجيه حركة المرور كما تريد.

**استنادا إلى BIOS** (النوع الأول): إن برنامج BIOS هو برنامج ثابت يتم تشغيله داخل مجموعة شرائح. يتم تنفيذه عند تشغيل الجهاز، وتهيئ الأجهزة، ثم نقل التحكم إلى قطاع التشغيل. يعد BIOS مكونا مهما يعمل على مستوى منخفض وينفذ قبل قطاع التشغيل. من الممكن إعادة برمجة البرامج الثابتة ل BIOS باستخدام التعليمات البرمجية الضارة، كما حدث في الماضي باستخدام [Mebromi rootkit](https://www.webroot.com/blog/2011/09/13/mebromi-the-first-bios-rootkit-in-the-wild/).

**مستندة إلى Hypervisor** (النوع الأول): توفر وحدات المعالجة المركزية الحديثة دعم hypervisor للأجهزة، مما يسمح لنظام التشغيل بإنشاء أجهزة ظاهرية قوية. يتم تشغيل جهاز ظاهري في بيئة محاكية مقيدة، ويجهل من الناحية النظرية المحاكي. قد تنفذ البرامج الضارة التي ت تولي الجهاز جهازا تشعبيا صغيرا لإخفاء نفسه خارج نطاق نظام التشغيل قيد التشغيل. لقد تم تدخير البرامج الضارة من هذا النوع في الماضي، وفي النهاية تم ملاحظة تشعبات الجذر الحقيقية، على [](http://seclists.org/fulldisclosure/2017/Jun/29)الرغم من أن القليل معروف حتى الآن.

### <a name="execution-and-injection"></a>التنفيذ والحقن

**مستند إلى الملف** (النوع الثالث: القابلة للتنفيذ، DLLs، ملفات LNK، المهام المجدولة): هذا هو متجه التنفيذ القياسي. يمكن تشغيل برنامج بسيط قابل للتنفيذ كبرامج ضارة في المرحلة الأولى لتشغيل حمل إضافي في الذاكرة، أو يتم إدخاله في عمليات تشغيل شرعية أخرى.

**مستندة** إلى الماكرو (النوع الثالث: Office المستندات): لغة [VBA](/office/vba/Library-Reference/Concepts/getting-started-with-vba-in-office) هي أداة مرنة وقوية تم تصميمها لأتمتة مهام التحرير وإضافة وظائف ديناميكية إلى المستندات. على هذا النحو، يمكن أن يسيء المتطفلون تنفيذ عمليات ضارة مثل فك تشفير أو تشغيل أو إدخال حمل قابل للتنفيذ أو حتى تنفيذ برامج الفدية الضارة بالكامل، كما في حالة [qkG](https://blog.trendmicro.com/trendlabs-security-intelligence/qkg-filecoder-self-replicating-document-encrypting-ransomware/). يتم تنفيذ وحدات الماكرو في سياق عملية Office (على سبيل المثال، Winword.exe) وتنفيذها بلغة النصية. لا يوجد أي برنامج ثنائي قابل للتنفيذ يمكن أن يفحصه برنامج الحماية من الفيروسات. بينما Office التطبيقات موافقة صريحة من المستخدم لتنفيذ وحدات الماكرو من مستند، إلا أن المهاجمين يستخدمون تقنيات الهندسة الاجتماعية لخدع المستخدمين للسماح ل وحدات الماكرو بتنفيذها.

**المستندة إلى** البرنامج النصي (النوع الثاني: الملف والخدمة والسجل و WMI repo و shell): تتوفر لغات البرمجة النصية JavaScript و VBScript و PowerShell بشكل افتراضي على Windows الأساسية. البرامج النصية لها نفس مزايا وحدات الماكرو، فهي ملفات نصية (وليس ملفات ثنائية قابلة للتنفيذ) ويمكن تشغيلها في سياق المترجم (مثل wscript.exe، powershell.exe)، وهو مكون شرعي ونظيف. تعد البرامج النصية متعددة الاستخدامات ويمكن تشغيلها من ملف (بالنقر نقرا مزدوجا فوقها) أو تنفيذها مباشرة على سطر أوامر مترجم. يسمح التشغيل على سطر الأوامر للبرامج الضارة بترميز البرامج النصية الضارة ك خدمات التشغيل التلقائي داخل مفاتيح [](https://www.gdatasoftware.com/blog/2014/07/23947-poweliks-the-persistent-malware-without-a-file) التسجيل التلقائية لاشتراكات أحداث [WMI](https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html) من إعادة تشغيل WMI. علاوة على ذلك، يمكن للمهاجم الذي حصل على حق الوصول إلى جهاز موبوء إدخال البرنامج النصي في موجه الأوامر.

**مستند إلى** القرص (النوع الثاني: سجل التشغيل): سجل التشغيل هو أول قطاع للقرص أو مستوى الصوت، ويحتوي على التعليمات البرمجية القابلة للتنفيذ المطلوبة لبدء عملية التشغيل لنظام التشغيل. يمكن للتهديدات [مثل Petya](https://cloudblogs.microsoft.com/microsoftsecure/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/?source=mmpc) إصابة سجل التشغيل عن طريق الكتابة فوقه باستخدام التعليمات البرمجية الضارة. عند تشغيل الجهاز، ستتحكم البرامج الضارة على الفور. يتواجد سجل التشغيل خارج نظام الملفات، ولكن يمكن الوصول إليه بواسطة نظام التشغيل. لدى منتجات الحماية من الفيروسات الحديثة القدرة على فحصها واستعادتها.

## <a name="defeating-fileless-malware"></a>هزم البرامج الضارة بدون ملفات

في Microsoft، نقوم بمراقبة مشهد الأمان بشكل نشط لتحديد اتجاهات التهديدات الجديدة وتطوير الحلول للحد من فئات التهديدات. نحن نعمل على توفير الحماية الدائمة الفعالة ضد مجموعة واسعة من التهديدات. من خلال واجهة مسح البرامج الضارة (AMSI) ومراقبة السلوك وفحص الذاكرة وحماية قطاع التشغيل، يمكن ل [Microsoft Defender ل Endpoint](/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint) فحص التهديدات بدون ملفات حتى مع التهكم الكثيف. تسمح لنا تقنيات التعلم الآلي في السحابة بمقياس هذه الحماية من التهديدات الجديدة والناشئة.

لمعرفة المزيد، اقرأ: بعيدا عن الرؤية وليس غير مرئي: هزم البرامج الضارة بدون ملفات من خلال مراقبة السلوك [و AMSI وAV من الجيل التالي](https://cloudblogs.microsoft.com/microsoftsecure/2018/09/27/out-of-sight-but-not-invisible-defeating-fileless-malware-with-behavior-monitoring-amsi-and-next-gen-av/)

## <a name="additional-resources-and-information"></a>موارد ومعلومات إضافية

تعرف على [كيفية نشر قدرات الحماية من المخاطر عبر Microsoft 365 E5](/microsoft-365/solutions/deploy-threat-protection).
