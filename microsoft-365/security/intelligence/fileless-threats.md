---
title: التهديدات بدون ملفات
ms.reviewer: ''
description: التعرف على فئات التهديدات والبرامج الضارة التي لا تحتوي على ملفات والتي تعيش خارج الأرض
keywords: البرامج الضارة بلا ملفات، بلا ملفات، تعيش خارج الأرض، lolbins، amsi، مراقبة السلوك، فحص الذاكرة، حماية قطاع التمهيد، الأمان، البرامج الضارة، Windows Defender ATP، برنامج الحماية من الفيروسات، AV، Microsoft Defender ATP، حماية الجيل التالي
ms.prod: m365-security
ms.mktglfcycl: secure
ms.sitesec: library
ms.localizationpriority: medium
ms.author: dansimp
author: dansimp
manager: dansimp
audience: ITPro
ms.collection: M365-security-compliance
ms.topic: article
search.appverid: met150
ms.technology: m365d
ms.openlocfilehash: 4db82cfc20bb1e27b2ef9a75793170c451c3868a
ms.sourcegitcommit: 85ce5fd0698b6f00ea1ea189634588d00ea13508
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 04/06/2022
ms.locfileid: "64665327"
---
# <a name="fileless-threats"></a>التهديدات بدون ملفات

ما هي التهديدات بلا ملف بالضبط؟ يشير مصطلح "fileless" إلى أن التهديد لا يأتي في ملف، مثل الخلفية التي تعيش فقط في ذاكرة الجهاز. ومع ذلك، لا يوجد تعريف واحد للبرامج الضارة بلا ملفات. يستخدم المصطلح على نطاق واسع، وأحيانا لوصف عائلات البرامج الضارة التي تعتمد على الملفات للعمل.

تتضمن الهجمات [عدة مراحل](https://attack.mitre.org/wiki/ATT&CK_Matrix) لوظائف مثل التنفيذ أو الثبات أو سرقة المعلومات. قد تكون بعض أجزاء سلسلة الهجوم بلا ملف، بينما قد تتضمن أجزاء أخرى نظام الملفات في شكل ما.

وللتوضيح، يتم تجميع التهديدات بلا ملف في فئات مختلفة.

![رسم تخطيطي شامل للبرامج الضارة بلا ملفات.](../../media/security-intelligence-images/fileless-malware.png)<br>
*الشكل 1. رسم تخطيطي شامل للبرامج الضارة بلا ملفات*

يمكن تصنيف التهديدات بلا ملف حسب نقطة الدخول الخاصة بها، والتي تشير إلى كيفية وصول البرامج الضارة بلا ملف على جهاز. يمكنهم الوصول عبر مهاجمة، أو من خلال الأجهزة المخترقة، أو عبر التنفيذ المنتظم للتطبيقات والبرامج النصية.

بعد ذلك، قم بإدراج نموذج نقطة الإدخال. على سبيل المثال، يمكن أن تستند المهاجمات إلى الملفات أو بيانات الشبكة، وأجهزة PCI الطرفية هي نوع من متجه الأجهزة، والبرامج النصية والملفات التنفيذية هي فئات فرعية من خط متجه التنفيذ.

وأخيرا، قم بتصنيف مضيف العدوى. على سبيل المثال، قد يحتوي تطبيق Flash على مجموعة متنوعة من التهديدات مثل مهاجمة، برنامج ثابت بسيط قابل للتنفيذ، وضار من جهاز.

يساعدك التصنيف على تقسيم وتصنيف الأنواع المختلفة من التهديدات بلا ملف. بعضها أكثر خطورة ولكن أيضا أكثر صعوبة في التنفيذ، بينما يستخدم البعض الآخر بشكل أكثر شيوعا على الرغم من (أو على وجه التحديد بسبب) عدم التقدم كثيرا.

من هذا التصنيف، يمكنك جمع ثلاثة أنواع رئيسية من التهديدات بلا ملف استنادا إلى مقدار بصمة الإصبع التي قد تتركها على الأجهزة المصابة.

## <a name="type-i-no-file-activity-performed"></a>النوع الأول: لم يتم تنفيذ أي نشاط ملف

يمكن اعتبار البرامج الضارة بلا ملف بالكامل البرامج الضارة التي لا تتطلب أبدا كتابة ملف على القرص. كيف يمكن أن تؤدي هذه البرامج الضارة إلى إصابة الجهاز في المقام الأول؟ أحد الأمثلة على ذلك هو المكان الذي يتلقى فيه الجهاز الهدف حزم شبكة ضارة تستغل ثغرة أمنية في Blue. تسمح الثغرة الأمنية بتثبيت المرجع DoublePulsar، الذي ينتهي به الأمر في ذاكرة النواة فقط. في هذه الحالة، لا يوجد ملف أو أي بيانات مكتوبة على ملف.

قد يحتوي الجهاز الذي تم اختراقه أيضا على تعليمات برمجية ضارة مختفية في البرامج الثابتة للجهاز (مثل BIOS) أو جهاز USB طرفي (مثل هجوم BadUSB) أو في البرنامج الثابت لبطاقة الشبكة. لا تتطلب كل هذه الأمثلة ملفا على القرص لتشغيله، ويمكن أن تعيش نظريا فقط في الذاكرة. يمكن للتعليمات البرمجية الضارة البقاء على إعادة التشغيل، وإعادة تنسيق القرص، وإعادة تثبيت نظام التشغيل.

قد يكون من الصعب بشكل خاص اكتشاف العدوى من هذا النوع لأن معظم منتجات الحماية من الفيروسات ليس لديها القدرة على فحص البرامج الثابتة. في الحالات التي يكون فيها للمنتج القدرة على فحص البرامج الثابتة الضارة واكتشافها، لا تزال هناك تحديات كبيرة مرتبطة بمعالجة التهديدات على هذا المستوى. يتطلب هذا النوع من البرامج الضارة بلا ملفات مستويات عالية من التطور وغالبا ما يعتمد على تكوين أجهزة أو برامج معينة. إنها ليست خطا متجها للهجوم يمكن استغلاله بسهولة وموثوقية. على الرغم من خطورتها، فإن التهديدات من هذا النوع غير شائعة وليست عملية لمعظم الهجمات.

## <a name="type-ii-indirect-file-activity"></a>النوع الثاني: نشاط الملف غير المباشر

هناك طرق أخرى يمكن أن تحقق البرامج الضارة وجودا بدون ملف على جهاز دون الحاجة إلى جهد هندسي كبير. لا تكتب البرامج الضارة بلا ملفات من هذا النوع الملفات مباشرة على نظام الملفات، ولكن يمكن أن ينتهي بها الأمر باستخدام الملفات بشكل غير مباشر. على سبيل المثال، مع تثبيت مهاجمي [Poshspy backdoor](https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html) أمر PowerShell ضار داخل مستودع WMI وتكوين عامل تصفية WMI لتشغيل الأمر بشكل دوري.

من الممكن تنفيذ مثل هذا التثبيت عبر سطر الأوامر دون الحاجة إلى وجود خلفية بالفعل على الملف. يمكن تثبيت البرامج الضارة وتشغيلها نظريا دون لمس نظام الملفات. ومع ذلك، يتم تخزين مستودع WMI على ملف فعلي في منطقة تخزين مركزية تديرها إدارة عناصر CIM، وعادة ما يحتوي على بيانات شرعية. على الرغم من أن سلسلة العدوى تستخدم من الناحية الفنية ملفا ماديا، فإنها تعتبر هجوم بلا ملف لأن مستودع WMI هو حاوية بيانات متعددة الأغراض لا يمكن اكتشافها وإزالتها.

## <a name="type-iii-files-required-to-operate"></a>النوع الثالث: الملفات المطلوبة للعمل

يمكن أن يكون لبعض البرامج الضارة نوع من الثبات بدون ملف، ولكن ليس دون استخدام الملفات للعمل. مثال على هذا السيناريو هو Kovter، الذي ينشئ معالج فعل مفتوح shell في السجل لملحق ملف عشوائي. سيؤدي فتح ملف باستخدام هذا الملحق إلى تنفيذ برنامج نصي من خلال الأداة المشروعة mshta.exe.

![صورة لمفتاح تسجيل Kovter.](../../media/security-intelligence-images/kovter-reg-key.png)<br>
*الشكل 2. مفتاح التسجيل الخاص ب Kovter*

عند استدعاء الفعل المفتوح، يتم تشغيل الأمر المقترن من السجل، ما يؤدي إلى تنفيذ برنامج نصي صغير. يقرأ هذا البرنامج النصي البيانات من مفتاح تسجيل آخر وينفذه، ما يؤدي بدوره إلى تحميل الحمولة النهائية. ومع ذلك، لتشغيل الفعل المفتوح في المقام الأول، يجب على Dbter إسقاط ملف بنفس الملحق المستهدف بواسطة الفعل (في المثال أعلاه، الملحق هو .bbf5590fd). كما يجب تعيين مفتاح تشغيل تلقائي تم تكوينه لفتح مثل هذا الملف عند بدء تشغيل الجهاز.

يعتبر Kovter تهديدا بلا ملف لأن نظام الملفات ليس له أي استخدام عملي. تحتوي الملفات ذات الملحقات العشوائية على بيانات غير هامة غير قابلة للاستخدام في التحقق من وجود التهديد. الملفات التي تخزن السجل هي حاويات لا يمكن اكتشافها وحذفها إذا كان المحتوى الضار موجودا.

## <a name="categorizing-fileless-threats-by-infection-host"></a>تصنيف التهديدات بلا ملف حسب مضيف العدوى

بعد وصف الفئات الواسعة، يمكننا الآن التعمق في التفاصيل وتقديم تصنيف تفصيلي لمضيفي العدوى. يغطي هذا التصنيف الشامل بانوراما لما يشار إليه عادة بالبرامج الضارة بلا ملفات. فهو يدفع جهودنا للبحث عن ميزات حماية جديدة وتطويرها تحييد فئات الهجمات وضمان عدم حصول البرامج الضارة على اليد العليا في سباق الذراعين.

### <a name="exploits"></a>يستغل

**مستند إلى الملف** (النوع الثالث: قابل للتنفيذ و Flash وJava ومستندات): قد يستغل الملف الأولي نظام التشغيل والمستعرض ومحرك Java ومحرك Flash وما إلى ذلك لتنفيذ رمز shellcode وتسليم حمولة في الذاكرة. في حين أن الحمولة غير ملف، فإن متجه الإدخال الأولي هو ملف.

**المستندة إلى الشبكة** (النوع الأول): يمكن لاتصال الشبكة الذي يستفيد من ثغرة أمنية في الجهاز الهدف تحقيق تنفيذ التعليمات البرمجية في سياق تطبيق أو نواة. مثال على ذلك هو WannaCry، الذي يستغل ثغرة أمنية تم إصلاحها مسبقا في بروتوكول SMB لتقديم خلفية داخل ذاكرة kernel.

### <a name="hardware"></a>الأجهزة

**مستند إلى الجهاز** (النوع الأول: بطاقة الشبكة والقرص الثابت): تتطلب الأجهزة مثل الأقراص الثابتة وبطاقات الشبكة مجموعات شرائح وبرامج مخصصة لتعمل. تسمى البرامج الموجودة والمشغلة في مجموعة شرائح الجهاز البرامج الثابتة. على الرغم من أن المهمة المعقدة، يمكن أن يكون البرنامج الثابت مصابا بالبرامج الضارة، كما [تم اكتشاف أن مجموعة برمجة برمجة المعادلات تقوم بذلك](https://www.kaspersky.com/blog/equation-hdd-malware/7623/).

**المستندة إلى وحدة المعالجة المركزية** (النوع الأول): وحدات المعالجة المركزية الحديثة معقدة وقد تتضمن أنظمة فرعية تقوم بتشغيل البرامج الثابتة لأغراض الإدارة. قد يكون هذا البرنامج الثابت عرضة للسرقة ويسمح بتنفيذ تعليمات برمجية ضارة من شأنها أن تعمل من داخل وحدة المعالجة المركزية. في ديسمبر 2017، أبلغ اثنان من الباحثين عن ثغرة أمنية يمكن أن تسمح للمهاجمين بتنفيذ التعليمات البرمجية داخل [محرك الإدارة (ME)](https://en.wikipedia.org/wiki/Intel_Management_Engine) الموجود في أي وحدة معالجة مركزية حديثة من Intel. وفي الوقت نفسه، تمت ملاحظة أن مجموعة المهاجمين PLATINUM لديها القدرة على استخدام [تقنية الإدارة النشطة (AMT)](https://en.wikipedia.org/wiki/Intel_Active_Management_Technology) من Intel لإجراء [اتصالات شبكة غير مرئية](https://cloudblogs.microsoft.com/microsoftsecure/2017/06/07/platinum-continues-to-evolve-find-ways-to-maintain-invisibility/)، وتجاوز نظام التشغيل المثبت. ME وAMT هي في الأساس أجهزة كمبيوتر مصغرة مستقلة تعيش داخل وحدة المعالجة المركزية وتعمل على مستوى منخفض جدا. لأن الغرض من هذه التقنيات هو توفير إمكانية الإدارة عن بعد، فإنها تتمتع بالوصول المباشر إلى الأجهزة، وهي مستقلة عن نظام التشغيل، ويمكن تشغيلها حتى إذا تم إيقاف تشغيل الكمبيوتر.

بالإضافة إلى كونها عرضة للخطر على مستوى البرامج الثابتة، يمكن تصنيع وحدات المعالجة المركزية مع أدوات خلفية مدرجة مباشرة في دوائر الأجهزة. لقد [تم البحث عن هذا الهجوم وأثبت أنه ممكن](https://www.emsec.rub.de/media/crypto/veroeffentlichungen/2015/03/19/beckerStealthyExtended.pdf) في الماضي. تم الإبلاغ عن أن نماذج معينة من معالجات x86 تحتوي على وحدة أساسية ثانوية مضمنة تشبه RISC والتي يمكن أن [توفر بشكل فعال خلفية](https://www.theregister.co.uk/2018/08/10/via_c3_x86_processor_backdoor/) يمكن للتطبيقات العادية من خلالها الحصول على تنفيذ متميز.

**المستندة إلى USB** (النوع الأول): يمكن إعادة برمجة أجهزة USB من جميع الأنواع باستخدام برامج ثابتة ضارة قادرة على التفاعل مع نظام التشغيل بطرق شائنة. على سبيل المثال، تسمح [تقنية BadUSB](https://arstechnica.com/information-technology/2014/07/this-thumbdrive-hacks-computers-badusb-exploit-makes-devices-turn-evil/) لعصا USB التي تمت إعادة برمجتها بالعمل كوحة مفاتيح ترسل الأوامر إلى الأجهزة عبر ضغطات المفاتيح، أو كبطاقة شبكة يمكنها إعادة توجيه نسبة استخدام الشبكة كما تريد.

**المستندة إلى BIOS** (النوع الأول): BIOS هو برنامج ثابت يعمل داخل مجموعة شرائح. يتم التنفيذ عند تشغيل جهاز، وتهيئة الأجهزة، ثم نقل التحكم إلى قطاع التمهيد. BIOS هو مكون مهم يعمل على مستوى منخفض وينفذ قبل قطاع التمهيد. من الممكن إعادة برمجة البرنامج الثابت BIOS باستخدام تعليمات برمجية ضارة، كما حدث في الماضي مع [Mebromi rootkit](https://www.webroot.com/blog/2011/09/13/mebromi-the-first-bios-rootkit-in-the-wild/).

**المستندة إلى Hypervisor** (النوع الأول): توفر وحدات المعالجة المركزية الحديثة دعم برنامج تشغيل الأجهزة، ما يسمح لنظام التشغيل بإنشاء أجهزة ظاهرية قوية. يعمل الجهاز الظاهري في بيئة محدودة ومحاكاة، وهو من الناحية النظرية غير مدرك للمحاكاة. قد تقوم البرامج الضارة التي تتولى جهازا بتنفيذ برنامج hypervisor صغير لإخفاء نفسه خارج نطاق نظام التشغيل قيد التشغيل. تمت مراعاة البرامج الضارة من هذا النوع في الماضي، وفي النهاية [تمت ملاحظة](http://seclists.org/fulldisclosure/2017/Jun/29) جذرات hypervisor الحقيقية، على الرغم من أن القليل منها معروف حتى الآن.

### <a name="execution-and-injection"></a>التنفيذ والإيقن

**المستندة إلى الملفات** (النوع الثالث: الملفات التنفيذية وDLLs وملفات LNK والمهام المجدولة): هذا هو متجه التنفيذ القياسي. يمكن تشغيل برنامج تنفيذي بسيط كبرمجيات ضارة من المرحلة الأولى لتشغيل حمولة إضافية في الذاكرة، أو إدخالها في عمليات تشغيل شرعية أخرى.

**مستندة إلى الماكرو** (النوع الثالث: Office المستندات): [لغة VBA](/office/vba/Library-Reference/Concepts/getting-started-with-vba-in-office) هي أداة مرنة وقوية مصممة لأتمتة مهام التحرير وإضافة وظائف ديناميكية إلى المستندات. على هذا النحو، يمكن إساءة استخدامه من قبل المهاجمين لتنفيذ عمليات ضارة مثل فك ترميز حمولة قابلة للتنفيذ أو تشغيلها أو إدخالها، أو حتى تنفيذ برامج فدية كاملة، كما في [حالة qkG](https://blog.trendmicro.com/trendlabs-security-intelligence/qkg-filecoder-self-replicating-document-encrypting-ransomware/). يتم تنفيذ وحدات الماكرو في سياق عملية Office (على سبيل المثال، Winword.exe) ويتم تنفيذها بلغة برمجة نصية. لا يوجد قابل للتنفيذ ثنائي يمكن أن يقوم برنامج الحماية من الفيروسات بفحصه. بينما تتطلب تطبيقات Office موافقة صريحة من المستخدم لتنفيذ وحدات الماكرو من مستند، يستخدم المهاجمون تقنيات الهندسة الاجتماعية لخداع المستخدمين للسماح بتنفيذ وحدات الماكرو.

**المستندة إلى البرنامج النصي** (النوع الثاني: الملف والخدمة والتسجيل ومستودع WMI و shell): تتوفر لغات البرمجة النصية JavaScript وVBScript وPowerShell بشكل افتراضي على الأنظمة الأساسية Windows. تتمتع البرامج النصية بنفس مزايا وحدات الماكرو، فهي ملفات نصية (ليست الملفات التنفيذية الثنائية) ويتم تشغيلها في سياق المترجم (مثل wscript.exe، powershell.exe)، وهو مكون نظيف وشرعي. البرامج النصية متعددة الاستخدامات ويمكن تشغيلها من ملف (بالنقر المزدوج فوقها) أو تنفيذها مباشرة على سطر الأوامر للمترجم. يسمح التشغيل على سطر الأوامر للبرامج الضارة بترميز البرامج النصية الضارة كخدمات التشغيل التلقائي داخل [مفاتيح التسجيل التشغيل التلقائي](https://www.gdatasoftware.com/blog/2014/07/23947-poweliks-the-persistent-malware-without-a-file) مثل [اشتراكات حدث WMI](https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html) من مستودع WMI. علاوة على ذلك، يمكن للمهاجم الذي حصل على حق الوصول إلى جهاز مصاب إدخال البرنامج النصي في موجه الأوامر.

**المستند إلى القرص** (النوع الثاني: سجل التمهيد): سجل التمهيد هو القطاع الأول من القرص أو وحدة التخزين، ويحتوي على التعليمات البرمجية القابلة للتنفيذ المطلوبة لبدء عملية التمهيد لنظام التشغيل. يمكن لتهديدات مثل [Petya](https://cloudblogs.microsoft.com/microsoftsecure/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/?source=mmpc) إصابة سجل التمهيد عن طريق الكتابة فوقه باستخدام تعليمات برمجية ضارة. عند تشغيل الجهاز، تكتسب البرامج الضارة السيطرة على الفور. يوجد سجل التمهيد خارج نظام الملفات، ولكن يمكن الوصول إليه من قبل نظام التشغيل. منتجات مكافحة الفيروسات الحديثة لديها القدرة على مسحها واستعادتها.

## <a name="defeating-fileless-malware"></a>إلحاق البرامج الضارة بلا ملفات

في Microsoft، نراقب بشكل نشط مشهد الأمان لتحديد اتجاهات التهديدات الجديدة وتطوير حلول للتخفيف من فئات التهديدات. نحن نجهز حماية دائمة فعالة ضد مجموعة واسعة من التهديدات. من خلال واجهة فحص مكافحة البرامج الضارة (AMSI)، ومراقبة السلوك، ومسح الذاكرة، وحماية قطاع التشغيل، [يمكن Microsoft Defender لنقطة النهاية](/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint) فحص التهديدات بلا ملف حتى مع التعتيم الثقيل. تتيح لنا تقنيات التعلم الآلي في السحابة توسيع نطاق هذه الحماية من التهديدات الجديدة والناشئة.

لمعرفة المزيد، اقرأ: [بعيدا عن الأنظار ولكن ليس غير مرئي: إلحاق البرامج الضارة بلا ملف مع مراقبة السلوك، وAMSI، وال الجيل التالي من AV](https://cloudblogs.microsoft.com/microsoftsecure/2018/09/27/out-of-sight-but-not-invisible-defeating-fileless-malware-with-behavior-monitoring-amsi-and-next-gen-av/)

## <a name="additional-resources-and-information"></a>موارد ومعلومات إضافية

تعرف على كيفية [نشر قدرات الحماية من التهديدات عبر Microsoft 365 E5](/microsoft-365/solutions/deploy-threat-protection).
