---
title: خطة استكشاف الأخطاء وإصلاحها Office 365
ms.author: kvice
author: kelleyvice-msft
manager: laurawi
ms.date: 5/10/2019
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
ms.localizationpriority: medium
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
search.appverid:
- MET150
- MOE150
- BCS160
ms.assetid: e241e5d9-b1d8-4f1d-a5c8-4106b7325f8c
ms.collection:
- M365-security-compliance
- Ent_O365
description: يمكن أن تساعدك هذه المقالة على استكشاف Office 365 مشاكل الأداء وإصلاحها، وحتى إصلاح بعض المشاكل الأكثر شيوعا.
ms.openlocfilehash: 23779158c250a94873f44139faa783e0079ab642
ms.sourcegitcommit: d4b867e37bf741528ded7fb289e4f6847228d2c5
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 10/06/2021
ms.locfileid: "63575308"
---
# <a name="performance-troubleshooting-plan-for-office-365"></a>خطة استكشاف الأخطاء وإصلاحها Office 365

هل تحتاج إلى معرفة الخطوات التي يجب اتخاذها لتحديد التأخر والتعليق وبطء الأداء بين SharePoint Online أو OneDrive for Business أو Exchange Online أو Skype for Business Online والكمبيوتر العميل؟ قبل الاتصال بالدعم، يمكن أن تساعدك هذه المقالة على استكشاف Office 365 مشاكل الأداء وإصلاحها، وحتى إصلاح بعض المشاكل الأكثر شيوعا.

هذه المقالة هي في الواقع خطة إجراءات نموذجية يمكنك استخدامها لالتقاط بيانات قيمة حول مشكلة الأداء الخاصة بك كما يحدث. يتم أيضا تضمين بعض أهم المشاكل في هذه المقالة.

إذا كنت جديدا على أداء الشبكة وتريد وضع خطة طويلة المدى لمراقبة الأداء بين أجهزة العميل و Office 365، فاطلع على ضبط [أداء Office 365](performance-tuning-using-baselines-and-history.md) وإصلاحها - المسؤول Pro.

## <a name="sample-performance-troubleshooting-action-plan"></a>خطة إجراء استكشاف الأخطاء وإصلاحها في نموذج الأداء

تحتوي خطة الإجراء هذه على جزأين؛ مرحلة إعداد، ومرحلة تسجيل. إذا كنت تواجه مشكلة في الأداء الآن، وكان عليك القيام بجمع البيانات، يمكنك البدء باستخدام هذه الخطة على الفور.

### <a name="prepare-the-client-computer"></a>إعداد الكمبيوتر العميل

- ابحث عن كمبيوتر عميل يمكنه إعادة إنتاج مشكلة الأداء. سيتم استخدام هذا الكمبيوتر أثناء عملية استكشاف الأخطاء وإصلاحها.
- اكتب الخطوات التي تتسبب في حدوث مشكلة في الأداء بحيث تكون جاهزا عندما يحين وقت الاختبار.
- أدوات التثبيت لجمع المعلومات وتسجيلها:
  - تثبيت [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865) (أو استخدام أداة تتبع شبكة مكافئة).
  - قم بتثبيت الإصدار الأساسي المجاني من [HTTPWatch](https://www.httpwatch.com/download/) (أو استخدم أداة تتبع الشبكة المكافئة).
  - استخدم مسجل شاشة أو يمكنك تشغيل مسجل الخطوات (PSR.exe) الذي يأتي مع Windows Vista واللاحقة، من أجل الاحتفاظ بسجل للخطوات التي اتخذتها أثناء الاختبار.

### <a name="log-the-performance-issue"></a>تسجيل مشكلة الأداء

- أغلق كل مستعرضات الإنترنت الخارجية.
- ابدأ تشغيل "مسجل الخطوات" أو مسجل شاشة آخر.
- ابدأ التقاط Netmon (أو أداة تتبع الشبكة).
- أمسح ذاكرة التخزين المؤقت ل DNS على الكمبيوتر العميل من سطر الأوامر عن طريق كتابة ipconfig/flushdns.
- ابدأ جلسة عمل جديدة في المستعرض ثم قم ب تشغيل HTTPWatch.
- اختياري: إذا كنت تقوم Exchange Online، Exchange أداة محلل أداء العميل من وحدة Office 365 المسؤول.
- إعادة إنتاج الخطوات الدقيقة التي تتسبب في حدوث مشكلة في الأداء.
- إيقاف تتبع Netmon أو أداة أخرى.
- في سطر الأوامر، قم بتشغيل مسار تتبع إلى Office 365 عن طريق كتابة الأمر التالي ثم الضغط على ENTER:

  ``` cmd
  tracert <subscriptionname>.onmicrosoft.com
  ```

- أوقف "مسجل الخطوات" واحفظ الفيديو. تأكد من تضمين تاريخ الالتقاط و وقته وما إذا كان يوضح الأداء الجيد أو السيئ.
- احفظ ملفات التتبع. مرة أخرى، تأكد من تضمين تاريخ الالتقاط و وقته وما إذا كان يوضح الأداء الجيد أو السيئ.

إذا لم تكن ملما بتشغيل الأدوات المذكورة في هذه المقالة، فلا تقلق لأننا نوفر هذه الخطوات بعد ذلك. إذا كنت معتادا على القيام بهذا النوع من التقاط الشبكة، يمكنك الانتقال إلى كيفية تجميع الأساسات، الذي [](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines)يصف تصفية السجلات وقراءتها.

### <a name="flush-the-dns-cache-first"></a>مسح ذاكرة التخزين المؤقت ل DNS أولا

لماذا؟ من خلال مسح ذاكرة التخزين المؤقت ل DNS، ستبدأ اختباراتك بلون نظيف. من خلال مسح ذاكرة التخزين المؤقت، أنت تقوم بإعادة تعيين محتويات حل DNS إلى الإدخالات الأكثر تهيئا. تذكر أن تدفق لا يزيل إدخالات ملف HOSTs. إذا كنت تستخدم إدخالات ملف HOST بشكل مكثف، يجب نسخ هذه الإدخالات إلى ملف في دليل آخر ثم إفراغ ملف HOST.

#### <a name="flush-your-dns-resolver-cache"></a>مسح ذاكرة التخزين المؤقت لمحلل DNS

1. افتح موجه الأوامر، (إما **بدء** \> **تشغيل** \> **cmd** **أو** \> Windows **cmd مفتاح).**
2. اكتب الأمر التالي واضغط على ENTER:

    ``` cmd
    ipconfig /flushdns
    ```

## <a name="netmon"></a>Netmon

تحلل أداة مراقبة الشبكة ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) من Microsoft الحزم، أي حركة المرور، التي تمر بين أجهزة الكمبيوتر على الشبكات. باستخدام Netmon لتتبع حركة المرور باستخدام Office 365، يمكنك التقاط رؤوس الحزم وعرضها وقراءتها، وتحديد الأجهزة المتدخلة، والتحقق من الإعدادات المهمة على أجهزة الشبكة، البحث عن الحزم التي تم إسقاطها، ومتابعة تدفق حركة المرور بين أجهزة الكمبيوتر على شبكة الشركة Office 365. نظرا لأن النص الفعلي لحركة المرور مشفر، أي أنه (ينتقل على المنفذ 443 عبر SSL/TLS، لا يمكنك قراءة الملفات التي يتم إرسالها. بدلا من ذلك، يمكنك الحصول على تتبع لم يتم تحديده للمسار الذي تأخذه الحزمة والذي يمكن أن يساعدك على تعقب سلوك المشكلة.

تأكد من عدم تطبيق عامل تصفية في الوقت نفسه. بدلا من ذلك، مرر الخطوات وشرح المشكلة قبل إيقاف التتبع وال حفظ.

بعد تثبيت Netmon 3.4، افتح الأداة واتخذ الخطوات التالية:

### <a name="take-a-netmon-trace-and-reproduce-the-issue"></a>تتبع Netmon وإعادة إنتاج المشكلة

1. تشغيل Netmon 3.4.
توجد ثلاثة اقالب على صفحة  البدء: **الالتقاطات** الأخيرة، وحدد الشبكات، وبدء استخدام **Microsoft Network Monitor 3.4. إشعار**. ستعطيك لوحة تحديد الشبكات أيضا قائمة بالشبكات الافتراضية التي يمكنك التقاط منها. تأكد من تحديد بطاقات الشبكة هنا.

2. انقر **فوق التقاط** جديد في أعلى **صفحة** البدء. يضيف ذلك علامة تبويب جديدة إلى جانب **علامة تبويب** صفحة البدء تسمى **التقاط 1**.
![واجهة مستخدم Netmon مع تمييز الأزرار "التقاط جديد" و"بدء" و"إيقاف".](../media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)

3. لالتقاط لقطة بسيطة، انقر فوق **بدء** على شريط الأدوات.

4. إعادة إنتاج الخطوات التي تقدم مشكلة في الأداء.

5. انقر **فوق إيقاف** \> **حفظ** \> **الملف باسم**. تذكر إعطاء التاريخ والوقت مع المنطقة الزمنية وذكر ما إذا كان ذلك يوضح الأداء السيئ أو الجيد.

## <a name="httpwatch"></a>HTTPWatch

[تأتي HTTPWatch](https://www.httpwatch.com/download/) مشحونة، وطبعة مجانية. يتناول الإصدار الأساسي المجاني كل ما تحتاج إليه لهذا الاختبار. يراقب HTTPWatch حركة مرور الشبكة والوقت الذي يتم فيه تحميل الصفحة مباشرة من نافذة المستعرض. HTTPWatch هو مكون أساسي ل Internet Explorer يصف الأداء بشكل رسومي. يمكن حفظ التحليل وعرضه في HTTPWatch Studio.

> [!NOTE]
> إذا كنت تستخدم مستعرضا آخر، مثل Firefox أو Google Chrome، أو إذا لم تتمكن من تثبيت HTTPWatch في Internet Explorer، فافتح نافذة مستعرض جديدة واضغط على F12 على لوحة المفاتيح. يجب أن ترى أداة المطور المنبثقة في أسفل المستعرض. إذا كنت تستخدم Opera، فاضغط على CTRL+SHIFT+I ل Web Inspector، ثم انقر  فوق علامة التبويب شبكة وأكمل الاختبار الموضح أدناه. ستكون المعلومات مختلفة قليلا، ولكن سيبقى عرض أوقات التحميل بالمللي ثانية. > HTTPWatch أيضا مفيدا جدا ل المشاكل المتعلقة SharePoint تحميل الصفحات عبر الإنترنت.

### <a name="run-httpwatch-and-reproduce-the-issue"></a>تشغيل HTTPWatch وإعادة إنتاج المشكلة

HTTPWatch هو مكون مستعرض، لذا فإن عرض الأداة في المستعرض يختلف قليلا لكل إصدار من Internet Explorer. يمكنك عادة العثور على HTTPWatch ضمن شريط الأوامر في مستعرض Internet Explorer. إذا لم تر المكون الإضافية HTTPWatch  \> في نافذة المستعرض، فتحقق من إصدار المستعرض بالنقر فوق تعليمات **حول**، أو في الإصدارات الأحدث من Internet Explorer، انقر فوق رمز الترس و حول **Internet Explorer**. ل تشغيل **شريط الأوامر** ، انقر ب زر الماوس الأيمن فوق شريط القوائم في Internet Explorer وانقر فوق **شريط الأوامر**.

في الماضي، كان HTTPWatch مقترن بكل من الأوامر وأشرطة المستكشف، لذا بمجرد التثبيت، إذا لم تظهر الأيقونة على الفور (حتى بعد إعادة التشغيل) فتحقق من أدوات وأشرطة الأدوات الخاصة بك للأيقونة. تذكر أنه يمكن تخصيص عارضات الأدوات والخيارات التي يمكن إضافتها إليها.

![شريط أدوات الأمر ل Internet Explorer مع عرض أيقونة HTTPWatch.](../media/198590b0-d7b1-4bff-a6ad-e4ec3a1e83df.png)

1. تشغيل HTTPWatch في نافذة مستعرض Internet Explorer. سيظهر راسيا إلى المستعرض في أسفل تلك النافذة. انقر **فوق تسجيل**.

2. إعادة إنتاج الخطوات الدقيقة المتدخلة في مشكلة الأداء. انقر فوق **الزر إيقاف** في HTTPWatch.

3. **احفظ** HTTPWatch أو **إرسال بواسطة البريد الإلكتروني**. تذكر تسمية الملف بحيث يتضمن معلومات التاريخ والوقت ودل على ما إذا كانت المراقبة تحتوي على عرض تقديمي للأداء الجيد أو السيئ.

![تعرض ساعة HTTP علامة التبويب شبكة لتحميل صفحة Office 365 الرئيسية.](../media/021a2c64-d581-49fd-adf4-4c364f589d75.PNG)

لقطة الشاشة هذه من الإصدار الاحترافي من HTTPWatch. يمكنك فتح تتبعات تم أخذها في الإصدار الأساسي على كمبيوتر باستخدام إصدار احترافي وقراءته هناك. قد تتوفر معلومات إضافية من التتبع عبر هذا الأسلوب.

## <a name="problem-steps-recorder"></a>مسجل خطوات المشاكل

يسمح لك مسجل الخطوات PSR.exe تسجيل المشاكل أثناء حدوثها. إنها أداة مفيدة جدا وبسيطة جدا للتشغيل.

### <a name="run-problem-steps-recorder-psrexe-to-record-your-work"></a>تشغيل مسجل خطوات المشكلة (PSR.exe) لتسجيل عملك

1. استخدم نوع **بدء** \> التشغيل **PSR.exe** \> **** \> **موافق**، أو انقر فوق Windows **نوع** \> \> **PSR.exeثم اضغط** على ENTER.

2. عندما تظهر PSR.exe صغيرة، انقر فوق بدء **السجل** ثم قم بإعادة إنتاج الخطوات التي تعيد إنتاج مشكلة الأداء. يمكنك إضافة التعليقات حسب الحاجة، عن طريق النقر فوق **إضافة تعليقات**.

3. انقر **فوق إيقاف السجل** عند إكمال الخطوات. إذا كانت مشكلة الأداء هي عرض صفحة، فانتظر حتى يتم عرض الصفحة قبل إيقاف التسجيل.

4. انقر فوق **حفظ**.

![لقطة شاشة لمسجل الخطوات أو PSR.exe.](../media/8542b0aa-a3ff-4718-8dc4-43f5521c6c34.PNG)

يتم تسجيل التاريخ والوقت لك. يؤدي ذلك إلى ربط PSR بتتبع Netmon وHTTPWatch في الوقت المناسب، ويساعد في استكشاف الأخطاء وإصلاحها بدقة. يمكن أن يظهر التاريخ والوقت في سجل PSR مرور دقيقة بين تسجيل الدخول وتصفح عنوان URL والعرض الجزئي لموقع المسؤول، على سبيل المثال.

## <a name="read-your-traces"></a>قراءة التتبعات

لا يمكن تدريس كل شيء حول استكشاف مشاكل الشبكة والأداء وإصلاحها التي قد يحتاج أحد الأشخاص إلى معرفتها عبر مقالة. إن تحسين الأداء يتطلب خبرة ومعرفة بكيفية عمل الشبكة وأداءها عادة. ولكن من الممكن تقريب قائمة من أهم المشاكل وإظهار كيفية جعل الأدوات أسهل بالنسبة لك لإزالة المشاكل الأكثر شيوعا.

إذا كنت تريد انتقاء تتبعات شبكة قراءة المهارات لمواقع Office 365، فلا يوجد معلم أفضل من إنشاء تتبعات تحميل الصفحات بشكل منتظم واكتساب خبرة في قراءتها. على سبيل المثال، عند وجود فرصة، قم بتحميل Office 365 وتعقب العملية. يمكنك تصفية تتبع حركة مرور DNS، أو البحث في FrameData عن اسم الخدمة التي قمت بمستعرضها. افحص التتبع للحصول على فكرة حول الخطوات التي تحدث عند تحميل الخدمة. سيساعدك هذا في التعرف على شكل تحميل الصفحة العادي، وفي حالة استكشاف الأخطاء وإصلاحها، لا سيما حول الأداء، قد تعلمك المقارنة بين التتبعات الجيدة والسيئة كثيرا.

يستخدم Netmon Microsoft Intellisense في حقل عامل تصفية العرض. إن Intellisense، أو إكمال التعليمات البرمجية الذكية، هي تلك الخدعة التي تكتب فيها في فترة زمنية، كما يتم عرض كل الخيارات المتوفرة في مربع تحديد منسدل. إذا كنت، على سبيل المثال، قلقا بشأن تحديد نطاق نافذة TCP، يمكنك العثور على طريقك إلى عامل تصفية (  `.protocol.tcp.window < 100`على سبيل المثال) بهذه الطريقة.

![لقطة شاشة ل Netmon تظهر أن الحقل "عامل تصفية العرض" يستخدم intellisense.](../media/75a56c11-9a60-47ee-a100-aabdfb1ba10f.PNG)

يمكن أن يكون هناك الكثير من حركة المرور في تتبعات Netmon. إذا لم تكن من ذوي الخبرة في قراءتها، فمن المرجح أنك سترهقك عملية التتبع في المرة الأولى. أول شيء يجب فعله هو فصل الإشارة عن الضوضاء الخلفية في عملية التتبع. لقد اختبرت مقابل Office 365، وهي حركة المرور التي تريد رؤياها. إذا كنت معتادا على التنقل عبر التتبعات، فقد لا تحتاج إلى هذه القائمة.

تنقل حركة المرور بين العميل Office 365 عبر TLS، مما يعني أن النص النصي لحركة المرور سيكون مشفرا ولن يكون قابلا للقراءة في تتبع Netmon عام. لا يحتاج تحليل الأداء إلى معرفة تفاصيل المعلومات في الحزمة. ومع ذلك، فهو يهتم كثيرا رؤوس الحزم والمعلومات التي تحتوي عليها.

### <a name="tips-to-get-a-good-trace"></a>تلميحات للحصول على تتبع جيد

- تعرف على قيمة عنوان IPv4 أو IPv6 للكمبيوتر العميل. يمكنك الحصول على هذا من موجه الأوامر بكتابة **IPConfig** ثم الضغط على ENTER. ستخبرك معرفة هذا العنوان بنظرة سريعة ما إذا كانت حركة المرور في عملية التتبع تتضمن الكمبيوتر العميل مباشرة. إذا كان هناك وكيل معروف، فعالجه واحصل على عنوان IP الخاص به أيضا.

- يمكنك مسح ذاكرة التخزين المؤقت لمحلل DNS، وأغلق كل المستعرضات، إذا أمكن، باستثناء المستعرض الذي تقوم فيه بتشغيل الاختبارات. إذا لم تتمكن من القيام بذلك، على سبيل المثال، إذا كان الدعم يستخدم بعض الأدوات المستندة إلى المستعرض لرؤية سطح المكتب الخاص بالكمبيوتر العميل، فاستعد لتصفية التتبع.

- في عملية تتبع مشغول، حدد Office 365 الخدمة التي تستخدمها. إذا لم يسبق لك أو نادرا ما رأيت حركة المرور الخاصة بك من قبل، فإن هذه خطوة مفيدة في فصل مشكلة الأداء عن الضوضاء الأخرى في الشبكة. هناك بعض الطرق للقيام بذلك. قبل الاختبار مباشرة، يمكنك استخدام _ping_ أو _PsPing_ مقابل عنوان URL الخاص بالخدمة المحددة (`ping outlook.office365.com` أو `psping -4 microsoft-my.sharepoint.com:443`، على سبيل المثال). يمكنك أيضا العثور بسهولة على ping أو PsPing في تتبع Netmon (حسب اسم العملية الخاصة به). سيمنحك ذلك مكانا لبدء البحث.

إذا كنت تستخدم تتبع Netmon فقط في وقت المشكلة، لا بأس أيضا. لتوجيه نفسك، استخدم عامل تصفية مثل `ContainsBin(FrameData, ASCII, "office")` أو `ContainsBin(FrameData, ASCII, "outlook")`. يمكنك تسجيل رقم الإطار من ملف التتبع. قد تحتاج أيضا إلى تمرير جزء ملخص  الإطار إلى اليمين وابحث عن العمود "الملخص للمحادثة". هناك رقم مشار إليه هناك لم ID لهذه المحادثة المحددة يمكنك أيضا تسجيله وبحثه في عزلة في وقت لاحق. تذكر إزالة عامل التصفية هذا قبل تطبيق أي تصفية أخرى.

> [!TIP]
> Netmon به الكثير من عوامل التصفية المضمنة المفيدة. جرب الزر **تحميل عامل التصفية** في أعلى جزء _عامل تصفية_ العرض.

![ابحث عن IP باستخدام PSPing في سطر الأوامر على كمبيوتر العميل.](../media/4c43ac67-e28e-4536-842d-7add7aa28847.PNG)

![تتبع Netmon من العميل يعرض الأمر PSPing نفسه من خلال عامل التصفية TCP. Flags.Syn == 1.](../media/0ae7ef7d-e003-4d01-a006-dc49bd1fcef2.PNG)

تعرف على حركة المرور الخاصة بك، وتعرف على كيفية تحديد موقع المعلومات التي تحتاج إليها. على سبيل المثال، تعرف على كيفية تحديد الحزمة في التتبع التي تحتوي على المرجع الأول Office 365 التي تستخدمها (مثل "Outlook").

إذا Office 365 Outlook عبر الإنترنت كمثال، تبدأ حركة المرور بهذا النحو:

- استعلام DNS القياسي والاستجابة ل DNS outlook.office365.com الاستعلامات المتطابقة. من المهم ملاحظة إزاحة الوقت لهذا التقلب، بالإضافة إلى المكان الذي يرسل فيه Office 365 Global DNS طلب حل الاسم. وبشكل مثالي، محليا قدر الإمكان، بدلا من نصف الطريق عبر العالم.

- طلب الحصول على HTTP الذي تم نقل تقرير الحالة الخاص به بشكل دائم (301)

- RWS Traffic بما في ذلك طلبات الاتصال RWS الاتصال الردود. (هذا هو Remote Winsock الذي يقوم باتصال لك.)

- محادثة TCP SYN و TCP SYN/ACK. تؤثر الكثير من الإعدادات في هذه المحادثة على أداءك.

- ثم سلسلة من حركة مرور TLS:TLS حيث تتم محادثات شهادة TLS وشهادات TLS. (تذكر أن البيانات مشفرة عبر SSL/TLS.)

جميع أجزاء حركة المرور مهمة ومتصلة، ولكن تحتوي أجزاء صغيرة من عملية التتبع على معلومات مهمة بشكل خاص من حيث استكشاف الأخطاء وإصلاحها، لذلك سنركز على تلك المناطق. كذلك، بما أننا قمنا بما يكفي من Office 365 استكشاف الأخطاء وإصلاحها في Microsoft لتجميع قائمة أهم عشر مشاكل شائعة، سنركز على هذه المشاكل وكيفية استخدام الأدوات التي نحتاج إليها لاجتثاثها بعد ذلك.

إذا لم تكن قد قمت بتثبيتها كلها جاهزة، فإن المصفوفة أدناه تستخدم العديد من الأدوات. حيثما أمكن. يتم توفير الارتباطات لنقاط التثبيت. تتضمن القائمة أدوات تتبع الشبكة الشائعة مثل [Netmon](https://www.microsoft.com/download/details.aspx?id=4865) و [Wireshark](https://www.wireshark.org/)، ولكن استخدم أي أداة تتبع تعتاد عليها، والتي اعتدت فيها على تصفية حركة مرور الشبكة. عند إجراء الاختبار، تذكر:

- *أغلق المستعرضات، واختبر باستخدام مستعرض واحد فقط*  قيد التشغيل - سيقلل هذا من إجمالي حركة المرور التي تقوم بالتقاطها. فهو يجعل عملية تتبع أقل انشغالا.
- *قم بمسح ذاكرة التخزين المؤقت لمحلل DNS على الكمبيوتر*  العميل - سيمنحك هذا سجلا نظيفا عند بدء التقاط الالتقاط، لتتبع أكثر نظافة.

## <a name="common-issues"></a>المشاكل الشائعة

قد تواجه بعض المشاكل الشائعة وكيفية العثور عليها في تتبع الشبكة.

### <a name="tcp-windows-scaling"></a>TCP Windows التحجيم

تم العثور عليه في SYN - SYN/ACK. قد لا تستفيد الأجهزة القديمة أو القديمة من التحجيم في Windows TCP.  بدون إعدادات تغيير حجم نوافذ TCP المناسبة، يقوم المخزن المؤقت الافتراضي 16 بت في رؤوس TCP بتعبئة بالمللي ثانية.  يتعذر على حركة المرور الاستمرار في إرسال البيانات حتى يتلقى العميل إقرارا بتسلم البيانات الأصلية، مما يتسبب في حدوث تأخيرات.

#### <a name="tools"></a>الأدوات

- Netmon
- Wireshark

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

ابحث عن حركة SYN - SYN/ACK في تتبع الشبكة.  في Netmon، استخدم عامل تصفية مثل  `tcp.flags.syn == 1`. عامل التصفية هذا هو نفسه في Wireshark.

![التصفية في Netmon أو Wireshark لحزم Syn لكل من الأدوات: TCP. Flags.Syn == 1.](../media/4b9a12a1-c915-43c8-ac2f-a679d0435a29.PNG)

لاحظ أن لكل SYN يوجد رقم منفذ مصدر (SrcPort) متطابق في منفذ الوجهة (DstPort) للاقرار ذي الصلة (SYN/ACK).

لرؤية قيمة Windows التي يستخدمها اتصال الشبكة، قم بتوسيع SYN أولا، ثم توسيع SYN/ACK ذي الصلة.

![رسم يوضح كيفية مطابقة SrcPort مع DstPort في عملية تتبع، للحصول على دلتا الوقت.](../media/6a4ca573-0253-4fbd-93e8-92821ee1c351.png)

### <a name="tcp-idle-time-settings"></a>وقت خمول TCP الإعدادات

من الناحية التاريخية، يتم تكوين معظم الشبكات المحيطة للاتصالات غير المتتية، مما يعني أنه يتم بشكل عام إنهاء الاتصالات الخاملة. يمكن إنهاء جلسات عمل TCP الخاملة بواسطة المحترفين وجدران الحماية لمدة أكبر من 100 إلى 300 ثانية. هذه مشكلة بالنسبة Outlook Online لأنه ينشئ اتصالات طويلة المدى ويستخدمها، سواء كانت معطلة أم لا.

عند إنهاء الاتصالات بواسطة أجهزة الوكيل أو جدار الحماية، لا يتم إعلام العميل، وستعني محاولة استخدام Outlook Online أن الكمبيوتر العميل سيحاول، بشكل متكرر، توصيل الاتصال قبل إنشاء اتصال جديد. قد ترى تعليق في المنتج أو المطالبات أو الأداء البطيء على تحميل الصفحة.

#### <a name="tools"></a>الأدوات

- Netmon
- Wireshark

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

في Netmon، انظر إلى حقل "إزاحة الوقت" لرحلة ذهابا ورحلة. إن الرحلة المستديرة هي الوقت الذي يقوم فيه العميل بإرسال طلب إلى الخادم واستلام استجابة مرة أخرى. تحقق بين العميل ونقطة الخروج (على البريد الإلكتروني على البريد الإلكتروني). العميل -\> الوكيل)، أو العميل Office 365 (العميل - Office 365\>). يمكنك رؤية ذلك في أنواع متعددة من الحزم.

على سبيل المثال، قد يبدو عامل التصفية في Netmon  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`مثل ، أو، في Wireshark،  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12`.

> [!TIP]
> ألا تعلم ما إذا كان عنوان IP في تتبعك ينتمي إلى خادم DNS؟ حاول البحث عنه في سطر الأوامر. انقر **فوق بدء** \> **تشغيل** \> وا اكتب **cmd**، **أو اضغط على** مفتاح \> Windows واضغط **على cmd**. في المطالبة، اكتب  `nslookup <the IP address from the network trace>`. للاختبار، استخدم nslookup مقابل عنوان IP الخاص بالكمبيوتر. > لرؤية قائمة نطاقات IP ل Microsoft، راجع Office 365 [عناوين URL وIP](./urls-and-ip-address-ranges.md).

إذا كانت هناك مشكلة، فتوقع ظهور إزاحة زمنية طويلة، في هذه الحالة (Outlook Online)، خاصة في حزم TLS:TLS التي تظهر مقطع بيانات التطبيق (على سبيل المثال، في Netmon`.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"`، يمكنك العثور على حزم بيانات التطبيق عبر ). يجب أن ترى تقدما سلسا في الوقت عبر جلسة العمل. إذا رأيت تأخيرات طويلة عند تحديث Outlook عبر الإنترنت، فقد يحدث ذلك بسبب درجة عالية من إعادة التعيين يتم إرسالها.

### <a name="latencyround-trip-time"></a>زمن زمن التأخر/وقت الرحلة المستديرة

زمن الوصول هو مقياس يمكن أن يتغير كثيرا وفقا للعديد من المتغيرات، مثل ترقية أجهزة التأخر وإضافة عدد كبير من المستخدمين إلى شبكة والنسبة المئوية إجمالي النطاق الترددي الذي تستهلكه المهام الأخرى على اتصال الشبكة.

تتوفر حاسبات النطاق الترددي Office 365 من تخطيط الشبكة وضبط الأداء [لصفحة](network-planning-and-performance.md) Office 365 هذه.

هل تحتاج إلى قياس سرعة الاتصال أو النطاق الترددي لاتصال ISP؟ جرب هذا الموقع (أو مواقع مثله): [Speedtest Official Site](https://www.speedtest.net/)، أو استعلام محرك البحث المفضل لديك لاختبار **سرعة العبارة**.

#### <a name="tools"></a>الأدوات

- Ping
- PsPing
- Netmon
- Wireshark

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

لتعقب زمن زمن التتبع في عملية تتبع، ستستفيد من تسجيل عنوان IP للكمبيوتر العميل وعنوان IP الخاص بخادم DNS في Office 365. هذا بغرض تصفية التتبع بسهولة. إذا كنت تتصل عبر وكيل، ستحتاج إلى عنوان IP للكمبيوتر العميل وعنوان IP للوكيل/الخروج وعنوان IP الخاص Office 365 DNS، لتسهيل العمل.

سيخبرك طلب اتصال تم إرساله إلى outlook.office365.com باسم مركز البيانات الذي يتلقى الطلب، حتى لو لم يتمكن الاتصال بالإنترنت لإرسال حزم ICMP المتتالية  للعلامة التجارية. إذا كنت تستخدم PsPing (أداة مجانية للتنزيل)، وحدد المنفذ (443)، وربما لاستخدام IPv4 (-4) ستحصل على متوسط الوقت ذهابا وإيابا للحزم المرسلة. يعمل هذا الأمر مع عناوين URL الأخرى في Office 365، مثل `psping -4 yourSite.sharepoint.com:443`. في الواقع، يمكنك تحديد عدد من pings للحصول على عينة أكبر للمتوسط، جرب شيئا مثل `psping -4 -n 20 yourSite-my.sharepoint.com:443`.

> [!NOTE]
> لا يرسل PsPing حزم ICMP. يتم استخدامه مع حزم TCP عبر منفذ معين، بحيث يمكنك استخدام أي منفذ تعرف أنه مفتوح. في Office 365، التي تستخدم SSL/TLS، حاول إرفاق المنفذ :443 ب PsPing.

![لقطة شاشة تعرض عملية outlook.office365.com، وPSPing مع 443 يقوم بالشيء نفسه، ولكن أيضا الإبلاغ عن متوسط RTT 6.5ms.](../media/c64339f2-2c96-45b8-b168-c2a060430266.PNG)

إذا قمت وتحميل صفحة Office 365 أثناء إجراء تتبع الشبكة، يجب تصفية تتبع Netmon أو Wireshark ل `DNS`. هذه إحدى IPs التي نبحث عنها.

فيما يلي الخطوات التي يجب اتخاذها لتصفية Netmon للحصول على عنوان IP (وأطلع على زمن DNS). يستخدم هذا المثال outlook.office365.com، ولكن قد يستخدم أيضا عنوان URL لمستأجر SharePoint Online (على سبيل المثال hithere.sharepoint.com).

1. الاتصال ب URL `ping outlook.office365.com` وتسجيل اسم خادم DNS وعنوان IP للخادم الذي تم إرسال طلب الاتصال له في النتائج.
2. تتبع الشبكة يفتح الصفحة، أو يقوم الإجراء الذي يمنحك مشكلة في الأداء، أو إذا رأيت زمن عال على ping، بحد ذاته، تتبع الشبكة.
3. افتح التتبع في Netmon وتصفية DNS (يعمل عامل التصفية هذا أيضا في Wireshark، ولكنه حساس لالحالتين `-- dns`). بما أنك تعرف اسم خادم DNS من اتصالك، يمكنك أيضا التصفية بسرعة أكبر في Netmon كما يلي: `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")`، الذي يبدو كما في أسماء dns Wireshark والإطار يحتوي على "namnorthwest".<br/>افتح حزمة الاستجابة، وفي نافذة تفاصيل إطار **Netmon،** انقر فوق **DNS** للتوسع للحصول على مزيد من المعلومات. في معلومات DNS، ستجد عنوان IP الخاص بخادم DNS الذي ذهب الطلب Office 365. ستحتاج إلى عنوان IP هذا للخطوة التالية (أداة PsPing). قم بإزالة عامل التصفية، وانقر ب زر الماوس الأيمن فوق استجابة  DNS في Netmon **(** \> \> ملخص إطار البحث عن المحادثات **DNS**) للاطلاع على استعلام DNS والاستجابة جنبا إلى جنب.
4. في Netmon، لاحظ أيضا العمود إزاحة الوقت بين طلب DNS والاستجابة. في الخطوة التالية، تكون أداة [PsPing](/sysinternals/downloads/psping) سهلة التثبيت واستخدام مفيدة جدا، وذلك لأن ICMP غالبا ما يتم حظره على جدران الحماية، ولأن PsPing يتعقب زمن التقدم بأناقة بالمللي ثانية. يكمل PsPing اتصال TCP إلى عنوان وميناء (في حالتنا فتح المنفذ 443).
5. تثبيت PsPing.
6. افتح موجه أوامر (\> \> ابدأ تشغيل نوع cmd أو Windows cmd \> نوع المفتاح) ثم غير الدليل إلى الدليل حيث قمت بتثبيت PsPing لتشغيل الأمر PsPing. في الأمثلة الخاصة بي، يمكنك رؤية لقد قمت ب إنشاء مجلد "Perf" في جذر C. يمكنك القيام بالشيء نفسه للوصول السريع.
7. اكتب الأمر بحيث تقوم بصنع PsPing مقابل عنوان IP الخاص Office 365 DNS من تتبع Netmon `psping -n 20 132.245.24.82:445`السابق، بما في ذلك رقم المنفذ، مثل . سيمنحك ذلك عينة من 20 تقاطعا ومتوسط زمن زمن التنقل عند توقف PsPing.

إذا كنت تريد Office 365 خادم وكيل، فالخطوات مختلفة بعض الشيء. يجب أولا إرسال PsPing إلى الخادم الوكيل للحصول على متوسط قيمة زمن زمن الوصول بالمللي ثانية للوكيل/الخروج والخلف، ثم تشغيل PsPing على الوكيل، أو على كمبيوتر به اتصال إنترنت مباشر للحصول على القيمة المفقودة (القيمة Office 365 والخلف).

إذا اخترت تشغيل PsPing من الوكيل، سيكون لديك قيمتان مللي ثانية: كمبيوتر عميل إلى خادم وكيل أو نقطة الخروج، وخادم وكيل Office 365. وقد انتهيت من ذلك! حسنا، تسجيل القيم، على أي حال.

إذا قمت بتشغيل PsPing على كمبيوتر عميل آخر لديه اتصال مباشر بالإنترنت، أي بدون وكيل، سيكون لديك قيمتان بالمللي ثانية: كمبيوتر عميل إلى خادم وكيل أو نقطة الخروج، والكمبيوتر العميل Office 365. في هذه الحالة، اطرح قيمة كمبيوتر العميل إلى خادم وكيل أو نقطة الخروج من قيمة كمبيوتر العميل إلى Office 365، وستصبح لديك أرقام RTT من الكمبيوتر العميل إلى الخادم الوكيل أو نقطة الخروج، ومن الخادم الوكيل أو نقطة الخروج إلى Office 365.

ومع ذلك، إذا كان بإمكانك العثور على كمبيوتر عميل في الموقع الذي تم توصيله مباشرة، أو تجاوز الوكيل، فقد تختار معرفة ما إذا كانت المشكلة تستنسخ هناك للبدء، واختبار استخدامها بعد ذلك.

زمن زمن الوصول، كما هو مشاهد في تتبع Netmon، يمكن لهذه الميلي ثانية الإضافية جمعها، إذا كان هناك ما يكفي منها في أي جلسة عمل معينة.

![زمن زمن زمن عام في Netmon، مع إضافة عمود دلتا الوقت الافتراضي في Netmon إلى ملخص الإطار.](../media/7ad17380-8527-4bc2-9b9b-6310cf19ba6b.PNG)

> [!NOTE]
> قد يكون عنوان IP الخاص بك مختلفا عن عناوين IP الموضحة هنا، على سبيل المثال، قد يؤدي استخدام ping إلى إرجاع شيء مثل 157.56.0.0/16 أو نطاق مماثل. للحصول على قائمة النطاقات التي تستخدمها Office 365، راجع Office 365 [عناوين URL وIP](./urls-and-ip-address-ranges.md).

تذكر توسيع كل العقد (يوجد زر في الأعلى لهذا) إذا كنت تريد البحث عن، على سبيل المثال، 132.245.

### <a name="proxy-authentication"></a>مصادقة الوكيل

ينطبق هذا الأمر عليك فقط إذا كنت تمر عبر خادم وكيل. إذا لم يكن الأمر كذلك، يمكنك تخطي هذه الخطوات. عند العمل بشكل صحيح، يجب أن تتم مصادقة الوكيل بالمللي ثانية، بشكل متناسق. يجب ألا ترى أداء سيئا متقطعا أثناء فترات الاستخدام القصوى (على سبيل المثال).

إذا كانت مصادقة الوكيل في وضع العمل، ففي كل مرة تقوم فيها Office 365 اتصال TCP جديد للحصول على المعلومات، ستحتاج إلى المرور عبر عملية مصادقة في الكواليس. لذلك، على سبيل المثال، عند التبديل من التقويم إلى البريد في Outlook عبر الإنترنت، سيتم مصادقة. وفي SharePoint Online، إذا كانت الصفحة تعرض وسائط أو بيانات من مواقع أو مواقع متعددة، سيتم مصادقة كل اتصال TCP مختلف مطلوب لعرض البيانات.

في Outlook Online، قد تواجه أوقات تحميل بطيئة كلما قمت بالتبديل بين التقويم علبة البريد، أو بطء تحميل الصفحة في SharePoint Online. ومع ذلك، هناك أعراض أخرى غير مدرجة هنا.

مصادقة الوكيل هي إعداد على خادم وكيل الخروج. إذا كان السبب في حدوث مشكلة في الأداء Office 365، فيجب استشارة فريق الشبكة.

#### <a name="tools"></a>الأدوات

- Netmon
- Wireshark

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

تتم مصادقة الوكيل كلما كان من المطلوب عقد جلسة عمل TCP جديدة، بشكل شائع لطلب ملفات أو معلومات من الخادم، أو لتوفير معلومات. على سبيل المثال، قد ترى مصادقة الوكيل حول طلبات HTTP GET أو HTTP POST. إذا كنت تريد رؤية الإطارات حيث تقوم بالمصادقة على الطلبات في عملية التتبع، فأضف العمود "ملخص NTLMSSP" إلى Netmon وتصفية ل  `.property.NTLMSSPSummary`. لمعرفة المدة التي تتطلبها المصادقة، أضف عمود دلتا الوقت.

لإضافة عمود إلى Netmon:

1. انقر بضغطة زر الماوس الأيمن فوق عمود مثل **الوصف**.
2. انقر **فوق اختيار أعمدة**.
3. حدد _موقع ملخص NTLMSSP_ _ودلتا الوقت_ في القائمة وانقر فوق **إضافة**.
4. انتقل الأعمدة الجديدة إلى مكانها قبل عمود الوصف  أو خلفه حتى تتمكن من قراءتها جنبا إلى جنب.
5. انقر فوق **موافق**.

حتى لو لم تكن قد أضفت العمود، فإن عامل التصفية Netmon يعمل. ولكن سيكون استكشاف الأخطاء وإصلاحها أسهل بكثير إذا كان بإمكانك رؤية مرحلة المصادقة التي أنت فيها.

عند البحث عن مثيلات مصادقة الوكيل، تأكد من دراسة كل الإطارات التي يوجد فيها تحدي NTLM أو رسالة مصادقة موجودة. إذا لزم الأمر، انقر بز الماوس الأيمن فوق جزء معين من حركة المرور واعثر على المحادثات \> TCP. كن على دراية بقيم Time Delta في هذه المحادثات.

![تتبع Netmon يعرض مصادقة الوكيل، تمت تصفيتها حسب المحادثة.](../media/b640f176-0a52-4bbb-972e-60fb3d6aece2.PNG)

تأخير أربعه ثانية في مصادقة الوكيل كما هو مشاهد في Wireshark. تم **تطبيق دلتا** الوقت من عمود الإطار المعروض السابق عبر النقر بيمين فوق الحقل الذي بالاسم نفسه في تفاصيل الإطار وتحديد إضافة كعمود.  <br/> ![في Wireshark، يمكن إنشاء عمود 'دلتا الوقت من الإطار السابق المعروض' عبر النقر بيمين فوق الحقل الذي بالاسم نفسه في تفاصيل الإطار وتحديد إضافة كعمود.](../media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)

### <a name="dns-performance"></a>أداء DNS

تعمل دقة الاسم بشكل أفضل وأسرع عندما تتم في أقرب مكان إلى بلد العميل قدر الإمكان.

إذا كانت دقة اسم DNS تجري في الخارج، فقد تضيف ثوان إلى تحميلات الصفحات. وبشكل مثالي، تحدث دقة الاسم في أقل من 100 ثانية. وإذا لم يكن الأمر كذلك، يجب إجراء مزيد من التحقيق.

> [!TIP]
> هل أنت غير متأكد من كيفية عمل اتصال العميل في Office 365؟ أطلع على مستند مرجع اتصال العميل [هنا](/previous-versions//dn741250(v=technet.10)).

#### <a name="tools"></a>الأدوات

- Netmon
- Wireshark
- PsPing

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

عادة ما يكون تحليل أداء DNS مهمة أخرى لتتبع الشبكة. ومع ذلك، فإن PsPing مفيد أيضا في الأسباب المحتملة أو في الخارج.

تستند حركة مرور DNS إلى طلبات واستجابات TCP و UDP التي تم وضع علامة عليها بوضوح بمستند يساعد على مطابقة طلب معين مع استجابته المحددة. سترى حركة مرور DNS، على سبيل المثال، عندما SharePoint Online اسم شبكة أو عنوان URL على صفحة ويب. وكقاعدة عامة، يتم تشغيل معظم عمليات نقل البيانات هذه، باستثناء عند نقل المناطق، فوق UDP.

في كل من Netmon و Wireshark، يكون عامل التصفية الأساسي الذي سيترك لك نظرة على حركة مرور DNS هو ببساطة `dns`. تأكد من استخدام حالة أقل عند تحديد عامل التصفية. تذكر مسح ذاكرة التخزين المؤقت لمحلل DNS قبل البدء في إعادة إنتاج المشكلة على الكمبيوتر العميل. على سبيل المثال، إذا كان لديك تحميل بطيء لصفحة SharePoint عبر الإنترنت للصفحة الرئيسية، يجب إغلاق كل المستعرضات وفتح مستعرض جديد وبدء التتبع ومسح ذاكرة التخزين المؤقت لمحل DNS واستعراض الموقع SharePoint Online. بمجرد حل الصفحة بأكملها، يجب إيقاف التتبع وحفظه.

![عامل التصفية الأساسي ل DNS في Netmon هو DNS.](../media/1bebc118-ca13-45f3-803f-ab73e7af401d.png)

تريد النظر إلى الوقت الذي يتم إزاحة الوقت فيه هنا. وقد يكون من المفيد إضافة العمود **Time Delta** إلى Netmon الذي يمكنك القيام به من خلال إكمال الخطوات التالية:

1. انقر بضغطة زر الماوس الأيمن فوق عمود مثل **الوصف**.
2. انقر **فوق اختيار أعمدة**.
3. حدد _موقع دلتا الوقت_ في القائمة وانقر فوق **إضافة**.
4. انتقال العمود الجديد إلى مكان قبل عمود الوصف أو  خلفه حتى تتمكن من قراءته جنبا إلى جنب.
5. انقر فوق **موافق**.

إذا وجدت استعلاما  \> يهمك، فنظر في عزله بالنقر ب الماوس الأيمن فوق ذلك الاستعلام في لوحة تفاصيل الإطار، واختيار البحث عن **المحادثات DNS**. لاحظ أن لوحة محادثات الشبكة تقفز مباشرة إلى المحادثة المحددة في سجل حركة مرور UDP الخاصة بها.

![تتبع Netmon Outlook عبر الإنترنت تمت تصفيته حسب DNS، واستخدام البحث عن المحادثات ثم DNS لتضييق نطاق النتائج.](../media/763cf20e-7b48-4a37-9449-c9978cfe118b.PNG)

في Wireshark، يمكنك إنشاء عمود للوقت DNS. يمكنك تتبع التتبع (أو فتح تتبع) في Wireshark والتصفية حسب `dns`، أو، بشكل أكثر فائدة،  `dns.time`. انقر فوق أي استعلام DNS، وفي اللوحة التي تعرض التفاصيل  `Domain Name System (response)` ، قم بتوسيع التفاصيل. سترى حقلا للوقت (على سبيل المثال، `[Time: 0.001111100 seconds]`. انقر بضغطة زر الماوس الأيمن هذه المرة وحدد **تطبيق كعمود**. سيمنحك ذلك عمود **"الوقت** " لفرز التتبع بشكل أسرع. انقر فوق العمود الجديد للفرز حسب القيم التنازلية لمعرفة مكالمة DNS التي استغرقت أطول حل لها.

[استعراض SharePoint Online التي تمت تصفيتها في Wireshark حسب dns.time (صغيرة)، مع الوقت من التفاصيل التي تم تحويلها إلى عمود وفرزها تصاعديا.](../media/1439dcc2-12ff-4ee2-9ef3-1484cf79c384.PNG)

إذا كنت تريد إجراء المزيد من التحقيق حول وقت دقة DNS، فجرب PsPing مقابل منفذ DNS المستخدم بواسطة TCP (على سبيل المثال،  `psping <IP address of DNS server>:53`) . هل ما زلت ترى مشكلة في الأداء؟ إذا فعلت ذلك، فمن المرجح أن تكون المشكلة مشكلة شبكة أوسع من مشكلة معينة في تطبيق DNS الذي تواجهه لحل المشكلة. تجدر الإشارة أيضا، مرة أخرى، إلى أن الاتصال outlook.office365.com سيخبرك بمكان دقة اسم DNS ل Outlook Online (على سبيل المثال، outlook-namnorthwest.office365.com).

إذا كانت المشكلة تبدو محددة في DNS، فقد يكون من الضروري الاتصال بقسم قسم المعلومات لديك للنظر في تكوينات DNS ومرسلي DNS لمزيد من التحقق من هذه المشكلة.

### <a name="proxy-scalability"></a>قابلية التوسع للوكيل

تمنح الخدمات مثل Outlook Online في Office 365 للعملاء اتصالات متعددة طويلة المدى. وبالتالي، قد يستخدم كل مستخدم المزيد من الاتصالات التي تتطلب عمرا أطول.

#### <a name="tools"></a>الأدوات

الرياضيات

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

لا توجد أداة تتبع الشبكة أو استكشاف الأخطاء وإصلاحها الخاصة بهذا الأمر. بدلا من ذلك، يستند إلى عمليات حساب النطاق الترددي التي تم تحديدها والمتغيرات الأخرى.

### <a name="tcp-max-segment-size"></a>حجم المقطع الأقصى ل TCP

تم العثور عليه في SYN - SYN/ACK.  قم بذلك بالتحقق من أي تتبع لشبكة الأداء قمت به للتأكد من تكوين حزم TCP لتحمل أقصى قدر ممكن من البيانات.

الهدف هو رؤية MSS 1460 بايت لنقل البيانات. إذا كنت خلف وكيل، أو كنت تستخدم NAT، فتذكر تشغيل هذا الاختبار من عميل إلى وكيل/الخروج/NAT، ومن الوكيل/الخروج/NAT إلى Office 365 للحصول على أفضل النتائج! هذه هي جلسات TCP مختلفة.

#### <a name="tools"></a>الأدوات

Netmon

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

TCP Max Segment Size (MSS) هي معلمة أخرى للمصافحة ثلاثية الطرق في تتبع الشبكة، وهذا يعني أنك ستجد البيانات التي تحتاج إليها في حزمة SYN - SYN/ACK. إن MSS بسيط جدا في الواقع.

افتح أي تتبع شبكة أداء لديك واعثر على الاتصال الذي تريد الفضول حوله، أو يوضح مشكلة الأداء.

> [!NOTE]
> إذا كنت تبحث عن تتبع وتحتاج إلى العثور على حركة المرور ذات الصلة بمحادثتك، فتصفية حسب IP الخاص للعميل، أو IP للخادم الوكيل أو نقطة الخروج، أو كليهما. ستحتاج مباشرة إلى الاتصال ب URL الذي تقوم باختباره  عنوان IP الخاص Office 365 في عملية التتبع، والتصفية حسبه.

هل تبحث عن التتبع من جهة ثانية؟ حاول استخدام عوامل التصفية لتوجيه نفسك. في Netmon، يمكنك تشغيل بحث استنادا إلى عنوان URL `Containsbin(framedata, ascii, "sphybridExample")`، مثل ، دون رقم الإطار.

في Wireshark، استخدم شيئا مثل  `frame contains "sphybridExample"`. إذا لاحظت أنك عثرت على حركة مرور Remote وينكوك (RWS) (قد تظهر ك [PSH، ACK] في Wireshark)، فتذكر أنه يمكن رؤية اتصال RWS قبل وقت قصير من SYN ذي الصلة - SYN/ACKs، كما تمت مناقشته سابقا.

في هذه المرحلة، يمكنك تسجيل رقم الإطار وإفلات عامل التصفية والنقر  فوق كل حركة المرور في نافذة محادثات الشبكة في Netmon للاطلاع على أقرب SYN.

والأهم من ذلك، إذا لم تتلق أي من معلومات عنوان IP في وقت التتبع، فإن البحث عن عنوان URL في عملية التتبع ( `sphybridExample-my.sharepoint.com`جزء من ، على سبيل المثال)، سيمنحك عناوين IP للتصفية حسبها.

حدد موقع الاتصال في عملية التتبع التي تريد رؤيتها. يمكنك إجراء ذلك إما من خلال فحص التتبع أو التصفية حسب عناوين IP أو تحديد محدد لمحددات المحادثات باستخدام نافذة محادثات الشبكة في Netmon. بعد العثور على حزمة SYN، قم بتوسيع TCP (في Netmon) أو بروتوكول التحكم في الإرسال (في Wireshark) في لوحة تفاصيل الإطار. قم بتوسيع خيارات TCP و MaxSegmentSize. حدد موقع إطار SYN-ACK ذي الصلة وتوسيع خيارات TCP و MaxSegmentSize. سيكون أصغر القيمتين هو الحد الأقصى لحجم المقطع. في هذه الصورة، أستخدم العمود المضمن في Netmon الذي يسمى استكشاف الأخطاء وإصلاحها في TCP.

![تتبع الشبكة تمت تصفيته في Netmon باستخدام الأعمدة المضمنة.](../media/e073df13-71f8-497a-83b4-bb9f70bd9833.PNG)

يوجد العمود المضمن في أعلى لوحة **تفاصيل** الإطار. (للعودة إلى طريقة العرض العادية، **انقر فوق أعمدة** مرة أخرى، ثم اختر **المنطقة الزمنية**.)

![مكان العثور على قائمة الأعمدة المنسدولة الخاصة بخيار استكشاف الأخطاء وإصلاحها في TCP (أعلى ملخص الإطار).](../media/64fd4baa-a872-4f07-b959-752d7d37fd62.PNG)

إليك عملية تتبع تمت تصفيتها في Wireshark. هناك عامل تصفية خاص بقيمة MSS (`tcp.options.mss`). يتم ربط إطارات SYN، SYN/ACK، مصافحة ACK في أسفل Wireshark المكافئ التفاصيل الإطارية (لذا الإطار 47 ACK، ارتباطات إلى 46 SYN/ACK، ارتباطات إلى 43 SYN) لتسهيل هذا النوع من العمل.

![تتبع تمت تصفيته في Wireshark حسب tcp.options.mss لحجم المقطع الأقصى (MSS).](../media/51e278db-801b-48bc-9b68-87cf92f03fd6.PNG)

إذا كنت بحاجة إلى التحقق من **التسليم الاختياري** (الموضوع التالي في هذه المصفوفة)، فلا تغلق تتبعك!

### <a name="selective-acknowledgment"></a>إقرار انتقائي

تم العثور عليه في SYN - SYN/ACK. يجب أن يتم التقارير كما هو مسموح به في كل من SYN و SYN/ACK. يسمح الإقرار الاختياري (SACK) ب إعادة إرسال البيانات بطريقة أكثر سلاسة عند فقدان حزمة أو حزم. يمكن للأجهزة تعطيل هذه الميزة، مما قد يؤدي إلى مشاكل في الأداء.

إذا كنت خلف وكيل، أو كنت تستخدم NAT، فتذكر تشغيل هذا الاختبار من عميل إلى وكيل/الخروج/NAT، ومن الوكيل/الخروج/NAT إلى Office 365 للحصول على أفضل النتائج! هذه هي جلسات TCP مختلفة.

#### <a name="tools"></a>الأدوات

Netmon

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

الإقرار الاختياري (SACK) هو معلمة أخرى في مصافحة SYN-SYN/ACK. يمكنك تصفية تتبع SYN - SYN/ACK بعدة طرق.

حدد موقع الاتصال في عملية التتبع التي تريد رؤيتها إما من خلال مسح التتبع أو التصفية حسب عناوين IP أو بالنقر فوق "معرف المحادثة" باستخدام نافذة "محادثات الشبكة" في Netmon. بعد العثور على حزمة SYN، قم بتوسيع TCP في Netmon، أو بروتوكول التحكم في الإرسال في Wireshark في المقطع تفاصيل الإطار. قم بتوسيع خيارات TCP ثم SACK. حدد موقع إطار SYN-ACK ذي الصلة وتوسيع خيارات TCP حقل SACK الخاص به. تأكد من أن SACK معين مسموح به في كل من SYN و SYN/ACK. فيما يلي قيم SACK كما هو مشاهد في كل من Netmon و Wireshark.

![إقرار انتقائي (SACK) في Netmon نتيجة tcp.flags.syn == 1.](../media/216f556f-5031-4ed2-b066-a0d9b3251fa2.PNG)

![SACK كما هو مشاهد في Wireshark مع عامل التصفية tcp.flags.syn == 1.](../media/0a6e26e5-43dc-403b-adc9-3349a55f4e4b.PNG)

### <a name="dns-geolocation"></a>الموقع الجغرافي ل DNS

حيث في العالم، Office 365 تحاول حل استدعاء DNS إلى التأثير على سرعة الاتصال.

في Outlook Online، بعد اكتمال عملية البحث الأولى في DNS، سيتم استخدام موقع DNS هذا للاتصال بأقرب مركز بيانات. سيتم توصيلك بخادم OUTLOOK ONLINE CAS، الذي سيستخدم الشبكة الأساسية للاتصال ب مركز البيانات (dC) حيث يتم تخزين البيانات. هذا أسرع.

عند الوصول إلى SharePoint Online، سيتم توجيه المستخدم الذي يسافر إلى الخارج إلى مركز البيانات النشط الخاص به -- وهو dC الذي يستند موقعه إلى أساس مستأجر SPO (لذلك، dC في الولايات المتحدة الأمريكية إذا كان المستخدم مستندا إلى الولايات المتحدة الأمريكية).

لدى Lync online عقد نشطة في أكثر من dC واحد في كل مرة. عند إرسال طلبات لمثيلات Lync online، سيحدد DNS الخاص ب Microsoft المكان الذي يأتي منه الطلب في العالم، وسيرجع عناوين IP من أقرب مركز إقليمي نشط فيه Lync online.

> [!TIP]
> هل تحتاج إلى معرفة المزيد حول كيفية اتصال العملاء Office 365؟ أطلع على مقالة [مرجع اتصال](/previous-versions//dn741250(v=technet.10)) العميل (ورسوماتها المفيدة).

#### <a name="tools"></a>الأدوات

- Ping
- PsPing

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

يجب أن تؤدي طلبات حل الاسم من خوادم DNS للعميل إلى خوادم DNS في Microsoft في معظم الحالات إلى إرجاع Microsoft DNS عنوان IP الخاص ب مركز بيانات إقليمي (dC). ما معنى هذا بالنسبة لك؟ إذا كان مقرك الرئيسي في البنغالية، الهند، ولكنك مسافر في الولايات المتحدة، فعندما يطلب المستعرض الخاص بك استخدام Outlook Online، يجب أن توفر لك خوادم DNS في Microsoft عناوين IP إلى مراكز البيانات في الولايات المتحدة -- مركز بيانات إقليمي. إذا كانت هناك حاجة إلى البريد من Outlook، فإن هذه البيانات ستتنقل عبر شبكة العمود الأساسي السريعة ل Microsoft بين مراكز البيانات.

يعمل DNS بشكل أسرع عند تنفيذ دقة الاسم في أقرب موقع للمستخدم قدر الإمكان. إذا كنت في أوروبا، وتريد الانتقال إلى Microsoft DNS في أوروبا، والتعامل (بشكل مثالي) مع مركز بيانات في أوروبا. سيكون أداء عميل في أوروبا يجري عملية DNS مع مركز بيانات في أمريكا أبطأ.

يمكنك تشغيل أداة Ping outlook.office365.com لتحديد مكان توجيه طلب DNS في العالم. إذا كنت في أوروبا، يجب أن ترى ردا من شيء مثل outlook-emeawest.office365.com. في الاميركتين، تتوقع شيئا مثل outlook-namnorthwest.office365.com.

افتح موجه الأوامر على الكمبيوتر العميل (عبر بدء \> تشغيل \> cmd أو Windows cmd نوع \> المفتاح). اكتب outlook.office365.com واضغط على ENTER. تذكر، لتحديد -4 إذا كنت تريد تحديد ل ping عبر IPv4. قد تفشل في الحصول على رد من حزم ICMP، ولكن يجب أن ترى اسم DNS الذي تم توجيه الطلب له. إذا كنت تريد رؤية أرقام زمن زمن الوصول لهذا الاتصال، فجرب PsPing إلى عنوان IP للخادم الذي يتم إرجاعه بواسطة الاتصال.

![يعرض outlook.office365.com الدقة في outlook-namnorthwest.](../media/06c944d5-6159-43ec-aa31-757770695e8b.PNG)

![PSPing إلى عنوان IP الذي تم إرجاعه بواسطة outlook.office365.com يعرض متوسط زمن الوصول 28 مللي ثانية.](../media/f2b25a75-1a87-4479-b8a7-fa4375683507.PNG)

### <a name="office-365-application-troubleshooting"></a>Office 365 التطبيق وإصلاحها

#### <a name="tools"></a>الأدوات

- Netmon
- HTTPWatch
- وحدة تحكم F12 في المستعرض

لا نغطي الأدوات المستخدمة في استكشاف الأخطاء وإصلاحها الخاصة بتطبيق معين في هذه المقالة الخاصة بالشبكة. ولكنك ستجد الموارد التي  *يمكنك استخدامها* [على هذه الصفحة](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848).

## <a name="related-topics"></a>مواضيع ذات صلة

[إدارة Office 365 نقاط النهاية](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)

[Office 365 الأسئلة الشائعة حول نقاط النهاية](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d)