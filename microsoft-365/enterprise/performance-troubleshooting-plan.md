---
title: خطة استكشاف أخطاء الأداء وإصلاحها Office 365
ms.author: kvice
author: kelleyvice-msft
manager: scotv
ms.date: 5/10/2019
audience: Admin
ms.topic: conceptual
ms.service: o365-administration
ms.localizationpriority: medium
f1.keywords:
- CSH
ms.custom:
- Adm_O365
- seo-marvel-apr2020
search.appverid:
- MET150
- MOE150
- BCS160
ms.assetid: e241e5d9-b1d8-4f1d-a5c8-4106b7325f8c
ms.collection:
- M365-security-compliance
- Ent_O365
description: يمكن أن تساعدك هذه المقالة على استكشاف أخطاء الأداء Office 365 وإصلاحها وحتى إصلاح بعض المشاكل الأكثر شيوعا.
ms.openlocfilehash: 7380d6beb89cdd128ccf86f47e1e3c236aabda77
ms.sourcegitcommit: e50c13d9be3ed05ecb156d497551acf2c9da9015
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 04/27/2022
ms.locfileid: "65100556"
---
# <a name="performance-troubleshooting-plan-for-office-365"></a>خطة استكشاف أخطاء الأداء وإصلاحها Office 365

هل تحتاج إلى معرفة الخطوات التي يجب اتخاذها لتحديد التأخرات والتوقف وبطء الأداء وإصلاحها بين SharePoint Online أو OneDrive for Business أو Exchange Online أو Skype for Business Online وكمبيوتر العميل الخاص بك؟ قبل الاتصال بالدعم، يمكن أن تساعدك هذه المقالة على استكشاف مشاكل الأداء Office 365 وإصلاحها وحتى إصلاح بعض المشاكل الأكثر شيوعا.

هذه المقالة هي في الواقع نموذج خطة عمل يمكنك استخدامها لالتقاط بيانات قيمة حول مشكلة الأداء الخاصة بك في أثناء حدوثها. يتم أيضا تضمين بعض أهم المشكلات في هذه المقالة.

إذا كنت جديدا على أداء الشبكة وتريد وضع خطة طويلة الأجل لمراقبة الأداء بين أجهزة العميل Office 365، فقم بإلقاء نظرة على [ضبط الأداء Office 365 واستكشاف الأخطاء وإصلاحها - المسؤول Pro تكنولوجيا المعلومات](performance-tuning-using-baselines-and-history.md).

## <a name="sample-performance-troubleshooting-action-plan"></a>نموذج خطة عمل استكشاف أخطاء الأداء وإصلاحها

تحتوي خطة العمل هذه على جزأين؛ مرحلة إعداد، ومرحلة تسجيل. إذا كانت لديك مشكلة في الأداء في الوقت الحالي، وكنت بحاجة إلى جمع البيانات، يمكنك البدء في استخدام هذه الخطة على الفور.

### <a name="prepare-the-client-computer"></a>إعداد كمبيوتر العميل

- ابحث عن كمبيوتر عميل يمكنه إعادة إنتاج مشكلة الأداء. سيتم استخدام هذا الكمبيوتر أثناء عملية استكشاف الأخطاء وإصلاحها.
- اكتب الخطوات التي تتسبب في حدوث مشكلة الأداء حتى تصبح جاهزا عندما يحين وقت الاختبار.
- تثبيت أدوات لجمع المعلومات وتسجيلها:
  - تثبيت [Netmon 3.4](https://www.microsoft.com/download/details.aspx?id=4865) (أو استخدام أداة تتبع شبكة مكافئة).
  - تثبيت الإصدار الأساسي المجاني من [HTTPWatch](https://www.httpwatch.com/download/) (أو استخدام أداة تتبع شبكة مكافئة).
  - استخدم مسجل شاشة أو قم بتشغيل "مسجل الخطوات" (PSR.exe) الذي يأتي مع Windows Vista والإي وقت لاحق، من أجل الاحتفاظ بسجل للخطوات التي تتخذها أثناء الاختبار.

### <a name="log-the-performance-issue"></a>تسجيل مشكلة الأداء

- أغلق جميع مستعرضات الإنترنت الغريبة.
- ابدأ تشغيل "مسجل الخطوات" أو مسجل شاشة آخر.
- ابدأ التقاط Netmon (أو أداة تتبع الشبكة).
- امسح ذاكرة التخزين المؤقت DNS على كمبيوتر العميل من سطر الأوامر عن طريق كتابة ipconfig/flushdns.
- ابدأ جلسة عمل مستعرض جديدة وقم بتشغيل HTTPWatch.
- اختياري: إذا كنت تختبر Exchange Online، فشغل أداة محلل الأداء عميل Exchange من وحدة تحكم مسؤول Office 365.
- إعادة إنتاج الخطوات الدقيقة التي تسبب مشكلة في الأداء.
- أوقف تتبع Netmon أو الأداة الأخرى.
- في سطر الأوامر، قم بتشغيل مسار تتبع إلى اشتراكك في Office 365 عن طريق كتابة الأمر التالي ثم الضغط على ENTER:

  ``` cmd
  tracert <subscriptionname>.onmicrosoft.com
  ```

- أوقف "مسجل الخطوات" واحفظ الفيديو. تأكد من تضمين تاريخ ووقت الالتقاط وما إذا كان يوضح أداء جيدا أو سيئا.
- حفظ ملفات التتبع. مرة أخرى، تأكد من تضمين تاريخ ووقت الالتقاط وما إذا كان يوضح أداء جيدا أو سيئا.

إذا لم تكن على دراية بتشغيل الأدوات المذكورة في هذه المقالة، فلا تقلق لأننا نقدم هذه الخطوات بعد ذلك. إذا كنت معتادا على القيام بهذا النوع من التقاط الشبكة، يمكنك التخطي [إلى كيفية جمع الخطوط الأساسية](performance-tuning-using-baselines-and-history.md#how-to-collect-baselines)، والتي تصف تصفية السجلات وقراءتها.

### <a name="flush-the-dns-cache-first"></a>مسح ذاكرة التخزين المؤقت DNS أولا

لم؟ من خلال مسح ذاكرة التخزين المؤقت DNS، تبدأ اختباراتك مع قائمة نظيفة. من خلال مسح ذاكرة التخزين المؤقت، تقوم بإعادة تعيين محتويات محلل DNS إلى أحدث الإدخالات. تذكر أن التدفق لا يزيل إدخالات ملف HOSTs. إذا كنت تستخدم إدخالات ملف HOST على نطاق واسع، يجب نسخ هذه الإدخالات إلى ملف في دليل آخر ثم إفراغ الملف HOST.

#### <a name="flush-your-dns-resolver-cache"></a>مسح ذاكرة التخزين المؤقت لمحلل DNS

1. افتح موجه الأوامر، (إما **بدء** \> **تشغيل** \> **cmd** أو **Windows cmd الرئيسي**\>).
2. اكتب الأمر التالي واضغط على ENTER:

    ``` cmd
    ipconfig /flushdns
    ```

## <a name="netmon"></a>Netmon

أداة مراقبة الشبكة ([Netmon](https://www.microsoft.com/download/details.aspx?id=4865)) من Microsoft تحلل الحزم، وهي نسبة استخدام الشبكة، التي تمر بين أجهزة الكمبيوتر على الشبكات. باستخدام Netmon لتتبع نسبة استخدام الشبكة باستخدام Office 365 يمكنك التقاط رؤوس الحزم وعرضها وقراءتها، وتحديد الأجهزة المتداخلة، والتحقق من الإعدادات المهمة على أجهزة الشبكة، والبحث عن الحزم التي تم إسقاطها، واتباع تدفق نسبة استخدام الشبكة بين أجهزة الكمبيوتر على شبكة الشركة Office 365. لأن النص الفعلي لنسبة استخدام الشبكة مشفر، أي أنه (ينتقل على المنفذ 443 عبر SSL/TLS، لا يمكنك قراءة الملفات التي يتم إرسالها. بدلا من ذلك، يمكنك الحصول على تتبع غير المصفي للمسار الذي تأخذه الحزمة والذي يمكن أن يساعدك على تعقب سلوك المشكلة.

تأكد من عدم تطبيق عامل تصفية في هذا الوقت. بدلا من ذلك، قم بتشغيل الخطوات وإظهار المشكلة قبل إيقاف التتبع والحفظ.

بعد تثبيت Netmon 3.4، افتح الأداة واتخذ الخطوات التالية:

### <a name="take-a-netmon-trace-and-reproduce-the-issue"></a>أخذ تتبع Netmon وإعادة إنتاج المشكلة

1. تشغيل Netmon 3.4.
هناك ثلاثة أجزاء على صفحة **البدء**: **"اللقطات الأخيرة**" و"**تحديد الشبكات****" و"بدء استخدام Microsoft Network Monitor 3.4". إشعار.** ستوفر لك لوحة Select Networks أيضا قائمة بالشبكات الافتراضية التي يمكنك التقاطها منها. تأكد من تحديد بطاقات الشبكة هنا.

2. انقر فوق **"التقاط جديد** " في أعلى صفحة **البدء** . يؤدي ذلك إلى إضافة علامة تبويب جديدة بجانب علامة تبويب صفحة **البدء** تسمى **Capture 1**.
![واجهة مستخدم Netmon مع تمييز أزرار الالتقاط والبدء والإيقاف الجديدة.](../media/d4527d84-62ec-4301-82d5-e0166ff71f20.PNG)

3. لالتقاط لقطة بسيطة، انقر فوق **"ابدأ** " على شريط الأدوات.

4. إعادة إنتاج الخطوات التي تمثل مشكلة في الأداء.

5. انقر فوق **"إيقاف حفظ** \> **الملف** \> **باسم**". تذكر أن تعطي التاريخ والوقت مع المنطقة الزمنية والإشارة إلى ما إذا كان يوضح أداء سيئا أو جيدا.

## <a name="httpwatch"></a>HTTPWatch

[يأتي HTTPWatch](https://www.httpwatch.com/download/) مشحونا، وإصدارا مجانيا. يغطي الإصدار الأساسي المجاني كل ما تحتاجه لهذا الاختبار. يراقب HTTPWatch حركة مرور الشبكة ووقت تحميل الصفحة مباشرة من نافذة المستعرض. HTTPWatch هو مكون إضافي ل Internet Explorer يصف الأداء رسوميا. يمكن حفظ التحليل وعرضه في HTTPWatch Studio.

> [!NOTE]
> إذا كنت تستخدم مستعرضا آخر، مثل Firefox أو Google Chrome أو إذا تعذر عليك تثبيت HTTPWatch في Internet Explorer، فافتح نافذة مستعرض جديدة واضغط على F12 على لوحة المفاتيح. يجب أن تشاهد أداة المطور المنبثقة في أسفل المستعرض. إذا كنت تستخدم Opera، فاضغط على CTRL+SHIFT+I ل Web Inspector، ثم انقر فوق علامة تبويب **الشبكة** وأكمل الاختبار الموضح أدناه. ستكون المعلومات مختلفة قليلا، ولكن ستظل أوقات التحميل معروضة بالمللي ثانية. > HTTPWatch مفيد جدا أيضا للمشاكل المتعلقة بأوقات تحميل الصفحة SharePoint Online.

### <a name="run-httpwatch-and-reproduce-the-issue"></a>تشغيل HTTPWatch وإعادة إنتاج المشكلة

HTTPWatch هو مكون إضافي للمستعرض، لذلك يختلف عرض الأداة في المستعرض قليلا لكل إصدار من Internet Explorer. عادة، يمكنك العثور على HTTPWatch ضمن شريط الأوامر في مستعرض Internet Explorer. إذا لم تتمكن من رؤية المكون الإضافي HTTPWatch في نافذة المستعرض، فتحقق من إصدار المستعرض بالنقر فوق **"تعليمات** \> **حول**"، أو في الإصدارات الأحدث من Internet Explorer، انقر فوق رمز الترس و **"حول Internet Explorer**". لتشغيل شريط **الأوامر** ، انقر بزر الماوس الأيمن فوق شريط القوائم في Internet Explorer وانقر فوق **شريط الأوامر**.

في الماضي، كان HTTPWatch مقترنا بكل من "الأوامر" وأشرطة "المستكشف"، لذلك بمجرد التثبيت، إذا لم تتمكن من رؤية الأيقونة (حتى بعد إعادة التشغيل) على الفور، فتحقق من **"أدوات**" وأشرطة الأدوات الخاصة بالأيقونة. تذكر أنه يمكن تخصيص أشرطة الأدوات ويمكن إضافة الخيارات إليها.

![شريط أدوات أوامر Internet Explorer مع عرض أيقونة HTTPWatch.](../media/198590b0-d7b1-4bff-a6ad-e4ec3a1e83df.png)

1. تشغيل HTTPWatch في نافذة مستعرض Internet Explorer. سيظهر مثبتا في المستعرض في أسفل تلك النافذة. انقر فوق **"سجل**".

2. إعادة إنتاج الخطوات الدقيقة المتضمنة في مشكلة الأداء. انقر فوق الزر **"إيقاف"** في HTTPWatch.

3. **احفظ** HTTPWatch أو **Send by Email**. تذكر تسمية الملف بحيث يتضمن معلومات التاريخ والوقت وإشارة إلى ما إذا كانت الساعة تحتوي على عرض توضيحي للأداء الجيد أو السيئ.

![HTTPWatch يعرض علامة تبويب الشبكة لتحميل صفحة Office 365 الصفحة الرئيسية.](../media/021a2c64-d581-49fd-adf4-4c364f589d75.PNG)

لقطة الشاشة هذه مأخوذة من الإصدار الاحترافي من HTTPWatch. يمكنك فتح التتبعات التي تم أخذها في الإصدار الأساسي على كمبيوتر باستخدام إصدار Professional وقراءته هناك. قد تتوفر معلومات إضافية من التتبع من خلال هذا الأسلوب.

## <a name="problem-steps-recorder"></a>مسجل خطوات المشكلة

يسمح لك مسجل الخطوات، أو PSR.exe، بتسجيل المشاكل أثناء حدوثها. إنها أداة مفيدة جدا وبسيطة جدا للتشغيل.

### <a name="run-problem-steps-recorder-psrexe-to-record-your-work"></a>تشغيل مسجل خطوات المشكلة (PSR.exe) لتسجيل عملك

1. استخدم نوع **بدء** \> **التشغيل** \> **PSR.exe** \> **موافق**، أو انقر فوق **نوع المفتاح** \> Windows **PSR.exe** \> ثم اضغط على ENTER.

2. عند ظهور نافذة PSR.exe الصغيرة، انقر فوق **"بدء السجل** " ثم قم بإعادة إنشاء الخطوات التي تعيد إنتاج مشكلة الأداء. يمكنك إضافة تعليقات حسب الحاجة، بالنقر فوق **"إضافة تعليقات**".

3. انقر فوق **"إيقاف السجل** " عند إكمال الخطوات. إذا كانت مشكلة الأداء عبارة عن عرض صفحة، فانتظر حتى يتم عرض الصفحة قبل إيقاف التسجيل.

4. انقر فوق **حفظ**.

![لقطة شاشة لمسجل الخطوات أو PSR.exe.](../media/8542b0aa-a3ff-4718-8dc4-43f5521c6c34.PNG)

يتم تسجيل التاريخ والوقت لك. يؤدي ذلك إلى ربط PSR بتتبع Netmon وHTTPWatch في الوقت المناسب، ويساعد في استكشاف الأخطاء وإصلاحها بدقة. يمكن أن يظهر التاريخ والوقت في سجل PSR أنه تم تمرير دقيقة بين تسجيل الدخول واستعراض عنوان URL والعرض الجزئي لموقع المسؤول، على سبيل المثال.

## <a name="read-your-traces"></a>قراءة التتبعات

لا يمكن تعليم كل شيء حول استكشاف أخطاء الشبكة والأداء وإصلاحها التي قد يحتاج شخص ما إلى معرفته عبر مقالة. إن اكتساب الخبرة في الأداء يتطلب خبرة ومعرفة كيفية عمل شبكتك وأدائها عادة. ولكن من الممكن تقريب قائمة من أهم المشكلات وإظهار كيف يمكن للأدوات تسهيل عملية التخلص من المشاكل الأكثر شيوعا.

إذا كنت تريد الحصول على مهارات قراءة تتبعات الشبكة لمواقع Office 365 الخاصة بك، فلا يوجد مدرس أفضل من إنشاء تتبعات لأحمال الصفحات بانتظام واكتساب الخبرة في قراءتها. على سبيل المثال، عندما يكون لديك فرصة، قم بتحميل خدمة Office 365 وتتبع العملية. قم بتصفية تتبع حركة مرور DNS، أو ابحث في FrameData عن اسم الخدمة التي استعرضتها. افحص التتبع للحصول على فكرة عن الخطوات التي تحدث عند تحميل الخدمة. سيساعدك هذا على معرفة ما يجب أن يبدو عليه تحميل الصفحة العادي، وفي حالة استكشاف الأخطاء وإصلاحها، لا سيما حول الأداء، يمكن أن تعلمك مقارنة جيدة بتتبعات سيئة الكثير.

يستخدم Netmon Microsoft Intellisense في حقل عامل تصفية العرض. Intellisense، أو إكمال التعليمات البرمجية الذكية، هو تلك الخدعة حيث تكتب في فترة ويتم عرض جميع الخيارات المتاحة في مربع تحديد منسدلة. على سبيل المثال، إذا كنت قلقا بشأن تحجيم نافذة TCP، يمكنك العثور على طريقك إلى عامل تصفية (مثل  `.protocol.tcp.window < 100`) بهذه الطريقة.

![لقطة شاشة ل Netmon تظهر أن حقل عامل تصفية العرض يستخدم intellisense.](../media/75a56c11-9a60-47ee-a100-aabdfb1ba10f.PNG)

يمكن أن تحتوي تتبعات Netmon على الكثير من نسبة استخدام الشبكة فيها. إذا لم تكن من ذوي الخبرة في قراءتها، فمن المحتمل أن تطغى عليك فتح التتبع في المرة الأولى. أول شيء يجب القيام به هو فصل الإشارة عن ضوضاء الخلفية في التتبع. لقد اختبرت ضد Office 365، وهي نسبة استخدام الشبكة التي تريد رؤيتها. إذا كنت معتادا على التنقل عبر التتبعات، فقد لا تحتاج إلى هذه القائمة.

تنتقل نسبة استخدام الشبكة بين العميل Office 365 عبر TLS، ما يعني أن نص نسبة استخدام الشبكة سيتم تشفيره ولا يمكن قراءته في تتبع Netmon عام. لا يحتاج تحليل الأداء إلى معرفة تفاصيل المعلومات في الحزمة. ومع ذلك، فهي مهتمة جدا برؤوس الحزم والمعلومات التي تحتوي عليها.

### <a name="tips-to-get-a-good-trace"></a>تلميحات للحصول على تتبع جيد

- تعرف على قيمة عنوان IPv4 أو IPv6 لجهاز الكمبيوتر العميل. يمكنك الحصول على هذا من موجه الأوامر عن طريق كتابة **IPConfig** ثم الضغط على ENTER. ستسمح لك معرفة هذا العنوان بنظرة سريعة عما إذا كانت نسبة استخدام الشبكة في التتبع تتضمن جهاز الكمبيوتر العميل الخاص بك مباشرة. إذا كان هناك وكيل معروف، فتحقق منه واحصل على عنوان IP الخاص به أيضا.

- قم بمسح ذاكرة التخزين المؤقت لمحلل DNS، وإذا أمكن، أغلق كافة المستعرضات باستثناء المستعرض الذي تقوم بتشغيل الاختبارات فيه. إذا لم تتمكن من القيام بذلك، على سبيل المثال، إذا كان الدعم يستخدم بعض الأدوات المستندة إلى المستعرض لرؤية سطح المكتب الخاص بالكمبيوتر العميل، فكن مستعدا لتصفية التتبع.

- في تتبع مشغول، حدد موقع خدمة Office 365 التي تستخدمها. إذا لم تر حركة المرور الخاصة بك من قبل أو نادرا ما رأيتها، فهذه خطوة مفيدة في فصل مشكلة الأداء عن ضوضاء الشبكة الأخرى. هناك بعض الطرق للقيام بذلك. مباشرة قبل الاختبار، يمكنك استخدام _ping_ أو _PsPing_ مقابل عنوان URL للخدمة المحددة (`ping outlook.office365.com` أو `psping -4 microsoft-my.sharepoint.com:443`، على سبيل المثال). يمكنك أيضا العثور بسهولة على ping أو PsPing في تتبع Netmon (حسب اسم العملية). سيمنحك ذلك مكانا لبدء البحث.

إذا كنت تستخدم تتبع Netmon فقط في وقت المشكلة، فلا بأس أيضا. لتوجيه نفسك، استخدم عامل تصفية مثل `ContainsBin(FrameData, ASCII, "office")` أو `ContainsBin(FrameData, ASCII, "outlook")`. يمكنك تسجيل رقم الإطار من ملف التتبع. قد تحتاج أيضا إلى تمرير جزء _"ملخص الإطار_ " إلى اليسار والبحث عن عمود "معرف المحادثة". هناك رقم مشار إليه هناك لمعرف هذه المحادثة المحددة يمكنك أيضا تسجيله والنظر إليه بشكل منفصل لاحقا. تذكر إزالة عامل التصفية هذا قبل تطبيق أي تصفية أخرى.

> [!TIP]
> يحتوي Netmon على الكثير من عوامل التصفية المضمنة المفيدة. جرب الزر **"عامل تصفية التحميل** " في أعلى جزء عامل تصفية _العرض_ .

![ابحث عن IP الخاص بك باستخدام PSPing في سطر الأوامر على كمبيوتر العميل.](../media/4c43ac67-e28e-4536-842d-7add7aa28847.PNG)

![تتبع Netmon من العميل يظهر نفس أمر PSPing من خلال عامل التصفية TCP. Flags.Syn == 1.](../media/0ae7ef7d-e003-4d01-a006-dc49bd1fcef2.PNG)

تعرف على نسبة استخدام الشبكة، وتعلم كيفية تحديد موقع المعلومات التي تحتاج إليها. على سبيل المثال، تعرف على كيفية تحديد الحزمة في التتبع التي تحتوي على المرجع الأول لخدمة Office 365 التي تستخدمها (مثل "Outlook").

مع أخذ Office 365 Outlook Online كمثال، تبدأ نسبة استخدام الشبكة شيئا مثل هذا:

- استعلام DNS القياسي واستجابة DNS outlook.office365.com مع معرفات الاستعلام المطابقة. من المهم ملاحظة إزاحة الوقت لهذا التسليم، بالإضافة إلى المكان الذي يرسل فيه Office 365 Global DNS طلب تحليل الاسم في العالم. من الناحية المثالية، محليا قدر الإمكان، بدلا من منتصف الطريق في جميع أنحاء العالم.

- طلب HTTP GET الذي تم نقل تقرير حالته بشكل دائم (301)

- حركة مرور RWS بما في ذلك طلبات الاتصال RWS والردود الاتصال. (هذا هو Remote Winsock الذي يجري اتصالا لك.)

- محادثة TCP SYN وTCP SYN/ACK. تؤثر الكثير من الإعدادات في هذه المحادثة على أدائك.

- ثم سلسلة من نسبة استخدام الشبكة TLS:TLS التي هي المكان الذي تجري فيه محادثات شهادة TLS ومصادقة TLS. (تذكر أن البيانات مشفرة عبر SSL/TLS.)

جميع أجزاء حركة المرور مهمة ومتصلة، ولكن أجزاء صغيرة من التتبع تحتوي على معلومات مهمة بشكل خاص من حيث استكشاف أخطاء الأداء وإصلاحها، لذلك سنركز على تلك المناطق. بالإضافة إلى ذلك، بما أننا قمنا بما يكفي Office 365 استكشاف أخطاء الأداء وإصلاحها في Microsoft لتجميع قائمة العشرة الأوائل من المشاكل الشائعة، سنركز على هذه المشكلات وكيفية استخدام الأدوات التي لدينا لإزالتها بعد ذلك.

إذا لم تكن قد قمت بتثبيتها كلها جاهزة، فإن المصفوفة أدناه تستخدم العديد من الأدوات. حيثما أمكن. يتم توفير الارتباطات إلى نقاط التثبيت. تتضمن القائمة أدوات تتبع الشبكة الشائعة مثل [Netmon](https://www.microsoft.com/download/details.aspx?id=4865) و [Wireshark](https://www.wireshark.org/)، ولكن استخدم أي أداة تتبع تشعر بالراحة معها، والتي اعتدت فيها على تصفية نسبة استخدام الشبكة. عند الاختبار، تذكر:

- *أغلق المستعرضات، واختبر مع تشغيل مستعرض واحد فقط*  - سيؤدي ذلك إلى تقليل نسبة استخدام الشبكة الإجمالية التي تلتقطها. يجعل تتبع أقل انشغالا.
- *قم بمسح ذاكرة التخزين المؤقت لمحلل DNS على كمبيوتر العميل*  - سيوفر لك ذلك قائمة نظيفة عند البدء في التقاط الالتقاط الخاص بك، لتتبع أكثر وضوحا.

## <a name="common-issues"></a>المشاكل الشائعة

قد تواجه بعض المشاكل الشائعة وكيفية العثور عليها في تتبع الشبكة.

### <a name="tcp-windows-scaling"></a>تغيير حجم Windows TCP

تم العثور عليها في SYN - SYN/ACK. قد لا تستفيد الأجهزة القديمة أو القديمة من تحجيم نوافذ TCP.  بدون إعدادات تحجيم نوافذ TCP المناسبة، يملأ المخزن المؤقت الافتراضي بالإعداد 16 بت في رؤوس TCP بالمللي ثانية.  لا يمكن لنسبة استخدام الشبكة الاستمرار في الإرسال حتى يتلقى العميل إعلاما بتلقي البيانات الأصلية، مما يتسبب في حدوث تأخيرات.

#### <a name="tools"></a>ادوات

- Netmon
- يريشارك

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

ابحث عن حركة مرور SYN - SYN/ACK في تتبع الشبكة.  في Netmon، استخدم عامل تصفية مثل  `tcp.flags.syn == 1`. عامل التصفية هذا هو نفسه في Wireshark.

![تصفية في Netmon أو Wireshark لحزم Syn لكل من الأدوات: TCP. Flags.Syn == 1.](../media/4b9a12a1-c915-43c8-ac2f-a679d0435a29.PNG)

لاحظ أنه لكل SYN يوجد رقم منفذ مصدر (SrcPort) مطابق في منفذ الوجهة (DstPort) الخاص بالإشعار المرتبط (SYN/ACK).

للاطلاع على قيمة التحجيم Windows التي يستخدمها اتصال الشبكة، قم بتوسيع SYN أولا، ثم SYN/ACK ذات الصلة.

![رسم يوضح كيفية مطابقة SrcPort مع DstPort في عملية تتبع، للحصول على دلتا الوقت.](../media/6a4ca573-0253-4fbd-93e8-92821ee1c351.png)

### <a name="tcp-idle-time-settings"></a>الإعدادات وقت خمول TCP

تاريخيا، يتم تكوين معظم الشبكات الفرعية للاتصالات العابرة، ما يعني أنه يتم إنهاء الاتصالات الخاملة بشكل عام. يمكن إنهاء جلسات TCP الخاملة بواسطة الوكلاء وجدران الحماية في أكثر من 100 إلى 300 ثانية. يشكل هذا مشكلة Outlook Online لأنه ينشئ اتصالات طويلة الأجل ويستخدمها، سواء كانت خاملة أم لا.

عند إنهاء الاتصالات بواسطة أجهزة الوكيل أو جدار الحماية، لا يتم إعلام العميل، وستعني محاولة استخدام Outlook Online أن الكمبيوتر العميل سيحاول، بشكل متكرر، إجراء اتصال قبل إجراء اتصال جديد. قد ترى توقفا في المنتج أو المطالبات أو الأداء البطيء على تحميل الصفحة.

#### <a name="tools"></a>ادوات

- Netmon
- يريشارك

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

في Netmon، انظر إلى حقل "إزاحة الوقت" لرحلة ذهابا وإيابا. الرحلة ذهابا وإيابا هي الوقت بين إرسال العميل لطلب إلى الخادم وتلقي استجابة مرة أخرى. تحقق بين العميل ونقطة الخروج (على سبيل المثال. العميل --\> الوكيل) أو العميل المطلوب Office 365 (العميل --\> Office 365). يمكنك رؤية هذا في العديد من أنواع الحزم.

على سبيل المثال، قد يبدو عامل التصفية في Netmon،  `.Protocol.IPv4.Address == 10.102.14.112 AND .Protocol.IPv4.Address == 10.201.114.12`أو، في Wireshark،  `ip.addr == 10.102.14.112 &amp;&amp; ip.addr == 10.201.114.12`.

> [!TIP]
> ألا تعرف ما إذا كان عنوان IP في التتبع الخاص بك ينتمي إلى خادم DNS الخاص بك؟ حاول البحث عنه في سطر الأوامر. انقر فوق **"بدء** \> **تشغيل"** \> واكتب **cmd**، أو اضغط **على مفتاح Windows** \> واكتب **cmd**. في المطالبة، اكتب  `nslookup <the IP address from the network trace>`. للاختبار، استخدم nslookup مقابل عنوان IP الخاص بالكمبيوتر الخاص بك. > للاطلاع على قائمة نطاقات IP الخاصة ب Microsoft، راجع [Office 365 نطاقات عناوين URL وعناوين IP](./urls-and-ip-address-ranges.md).

إذا كانت هناك مشكلة، فتوقع ظهور "إزاحات الوقت الطويلة"، في هذه الحالة (Outlook Online)، خاصة في حزم TLS:TLS التي تعرض مرور بيانات التطبيق (على سبيل المثال، في Netmon يمكنك العثور على حزم بيانات التطبيق عبر `.Protocol.TLS AND Description == "TLS:TLS Rec Layer-1 SSL Application Data"`). يجب أن تشاهد تقدما سلسا في الوقت عبر جلسة العمل. إذا رأيت تأخيرات طويلة عند تحديث Outlook Online، فقد يرجع ذلك إلى وجود درجة عالية من عمليات إعادة التعيين التي يتم إرسالها.

### <a name="latencyround-trip-time"></a>زمن الانتقال/وقت الرحلة ذهابا وإيابا

زمن الانتقال هو مقياس يمكن أن يتغير كثيرا اعتمادا على العديد من المتغيرات، مثل ترقية الأجهزة القديمة، وإضافة عدد كبير من المستخدمين إلى شبكة، والنسبة المئوية للنطاق الترددي الإجمالي الذي تستهلكه المهام الأخرى على اتصال الشبكة.

تتوفر حاسبات النطاق الترددي Office 365 من [تخطيط الشبكة هذا وضبط الأداء لصفحة Office 365](network-planning-and-performance.md).

هل تحتاج إلى قياس سرعة الاتصال، أو النطاق الترددي لاتصال ISP؟ جرب هذا الموقع (أو المواقع التي تعجبك): [أسرع موقع رسمي](https://www.speedtest.net/)، أو استعلم عن محرك البحث المفضل لديك **لاختبار سرعة** العبارة.

#### <a name="tools"></a>ادوات

- كره
- PsPing
- Netmon
- يريشارك

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

لتعقب زمن الانتقال في عملية تتبع، ستستفيد من تسجيل عنوان IP لجهاز الكمبيوتر العميل وعنوان IP لخادم DNS في Office 365. هذا لغرض تصفية التتبع بسهولة أكبر. إذا قمت بالاتصال من خلال وكيل، فستحتاج إلى عنوان IP لجهاز الكمبيوتر العميل وعنوان IP للوكيل/الخروج وعنوان IP Office 365 DNS لتسهيل العمل.

سيخبرك طلب ping المرسل إلى outlook.office365.com باسم مركز البيانات الذي يتلقى الطلب، حتى  *لو لم يتمكن*  ping من الاتصال لإرسال حزم ICMP المتتالية للعلامة التجارية. إذا كنت تستخدم PsPing (أداة مجانية للتنزيل)، وتحديد المنفذ (443) وربما لاستخدام IPv4 (-4)، فستحصل على متوسط وقت الرحلة ذهابا وإيابا للحزم المرسلة. سيعمل هذا مع عناوين URL الأخرى في خدمات Office 365، مثل `psping -4 yourSite.sharepoint.com:443`. في الواقع، يمكنك تحديد عدد من pings للحصول على عينة أكبر لمتوسطك، جرب شيئا مثل `psping -4 -n 20 yourSite-my.sharepoint.com:443`.

> [!NOTE]
> لا يرسل PsPing حزم ICMP. إنه يضغط مع حزم TCP عبر منفذ معين، حتى تتمكن من استخدام أي واحدة تعرف أنها مفتوحة. في Office 365، الذي يستخدم SSL/TLS، حاول إرفاق المنفذ :443 ب PsPing الخاص بك.

![لقطة شاشة تعرض تحليل ping outlook.office365.com، وPSPing مع 443 تفعل الشيء نفسه، ولكن أيضا الإبلاغ عن متوسط RTT 6.5ms.](../media/c64339f2-2c96-45b8-b168-c2a060430266.PNG)

إذا قمت بتحميل صفحة Office 365 بطيئة الأداء أثناء إجراء تتبع للشبكة، يجب تصفية تتبع Netmon أو Wireshark ل `DNS`. هذا أحد عناوين IP التي نبحث عنها.

فيما يلي الخطوات التي يجب اتخاذها لتصفية Netmon للحصول على عنوان IP (وإلقاء نظرة على زمن انتقال DNS). يستخدم هذا المثال outlook.office365.com، ولكنه قد يستخدم أيضا عنوان URL لمستأجر SharePoint Online (hithere.sharepoint.com على سبيل المثال).

1. Ping THE URL `ping outlook.office365.com` ، وفي النتائج، سجل اسم وعنوان IP لخادم DNS الذي تم إرسال طلب ping إليه.
2. تتبع الشبكة يفتح الصفحة، أو يقوم بالإجراء الذي يمنحك مشكلة الأداء، أو، إذا رأيت زمن انتقال عال على ping، نفسه، تتبعه الشبكة.
3. افتح التتبع في Netmon وعامل التصفية ل DNS (يعمل عامل التصفية هذا أيضا في Wireshark، ولكنه حساس لحالة الأحرف `-- dns`). نظرا لأنك تعرف اسم خادم DNS من ping الخاص بك، فقد تقوم أيضا بالتصفية بسرعة أكبر في Netmon مثل هذا: `DNS AND ContainsBin(FrameData, ASCII, "namnorthwest")`، والذي يبدو مثل هذا في Wireshark dns ويحتوي الإطار على "namnorthwest".<br/>افتح حزمة الاستجابة، وفي نافذة Netmon **Frame Details** ، انقر فوق **DNS** للتوسيع للحصول على مزيد من المعلومات. في معلومات DNS ستجد عنوان IP لخادم DNS الذي انتقل إليه الطلب في Office 365. ستحتاج إلى عنوان IP هذا للخطوة التالية (أداة PsPing). قم بإزالة عامل التصفية، وانقر بزر الماوس الأيمن فوق استجابة DNS في Netmon (البحث **عن المحادثات** \> في **ملخص** \> الإطار **DNS**) لرؤية استعلام DNS والاستجابة جنبا إلى جنب.
4. في Netmon، لاحظ أيضا العمود "إزاحة الوقت" بين طلب DNS والاستجابة. في الخطوة التالية، تأتي أداة [PsPing](/sysinternals/downloads/psping) سهلة التثبيت والاستخدام في متناول اليد، وذلك لأن ICMP غالبا ما يتم حظره على جدران الحماية، ولأن PsPing يتعقب زمن الانتقال بأناقة بالمللي ثانية. يكمل PsPing اتصال TCP بعنوان ومنفذ (في حالتنا فتح المنفذ 443).
5. تثبيت PsPing.
6. افتح موجه الأوامر (ابدأ \> تشغيل \> نوع cmd، أو Windows Key \> type cmd) وقم بتغيير الدليل إلى الدليل حيث قمت بتثبيت PsPing لتشغيل الأمر PsPing. في أمثلتي، يمكنك أن ترى أنني قمت بإنشاء مجلد "Perf" على جذر C. يمكنك القيام بنفس الشيء للوصول السريع.
7. اكتب الأمر بحيث تقوم بإجراء PsPing مقابل عنوان IP لخادم DNS Office 365 من تتبع Netmon السابق، بما في ذلك رقم المنفذ، مثل `psping -n 20 132.245.24.82:445`. سيمنحك هذا عينة من 20 pings ومتوسط زمن الانتقال عند توقف PsPing.

إذا كنت ستقوم Office 365 من خلال خادم وكيل، فإن الخطوات مختلفة قليلا. يمكنك أولا PsPing إلى الخادم الوكيل للحصول على متوسط قيمة زمن الانتقال بالمللي ثانية إلى الوكيل/الخروج والعودة، ثم تشغيل PsPing على الوكيل، أو على كمبيوتر مع اتصال مباشر بالإنترنت للحصول على القيمة المفقودة (القيمة التي يجب Office 365 والعودة).

إذا اخترت تشغيل PsPing من الوكيل، فسيكون لديك قيمتان بالمللي ثانية: كمبيوتر العميل إلى الخادم الوكيل أو نقطة الخروج، والخادم الوكيل إلى Office 365. لقد انتهيت! حسنا، تسجيل القيم، على أي حال.

إذا قمت بتشغيل PsPing على كمبيوتر عميل آخر لديه اتصال مباشر بالإنترنت، أي بدون وكيل، سيكون لديك قيمتان بالمللي ثانية: كمبيوتر العميل إلى خادم وكيل أو نقطة خروج، وكمبيوتر العميل Office 365. في هذه الحالة، اطرح قيمة كمبيوتر العميل إلى الخادم الوكيل أو نقطة الخروج من قيمة كمبيوتر العميل إلى Office 365، وسيكون لديك أرقام RTT من كمبيوتر العميل إلى الخادم الوكيل أو نقطة الخروج، ومن الخادم الوكيل أو نقطة الخروج إلى Office 365.

ومع ذلك، إذا كان بإمكانك العثور على كمبيوتر عميل في الموقع المتأثر المتصل مباشرة، أو تجاوز الوكيل، فقد تختار معرفة ما إذا كانت المشكلة تتكرر هناك للبدء بها، واختبار استخدامها بعد ذلك.

زمن الانتقال، كما هو موضح في تتبع Netmon، يمكن أن تضيف هذه المللي ثانية الإضافية، إذا كان هناك ما يكفي منها في أي جلسة عمل معينة.

![زمن الانتقال العام في Netmon، مع إضافة عمود Netmon الافتراضي Time Delta إلى "ملخص الإطار".](../media/7ad17380-8527-4bc2-9b9b-6310cf19ba6b.PNG)

> [!NOTE]
> قد يكون عنوان IP الخاص بك مختلفا عن عناوين IP المعروضة هنا، على سبيل المثال، قد ترجع ping شيئا مثل 157.56.0.0/16 أو نطاق مماثل. للحصول على قائمة النطاقات التي تستخدمها Office 365، راجع [عناوين URL Office 365 ونطاقات عناوين IP](./urls-and-ip-address-ranges.md).

تذكر توسيع كافة العقد (يوجد زر في الأعلى لهذا) إذا كنت تريد البحث عن، على سبيل المثال، 132.245.

### <a name="proxy-authentication"></a>مصادقة الوكيل

ينطبق هذا فقط عليك إذا كنت تمر بخادم وكيل. إذا لم يكن كذلك، يمكنك تخطي هذه الخطوات. عند العمل بشكل صحيح، يجب أن تتم مصادقة الوكيل بالمللي ثانية، باستمرار. يجب ألا ترى أداء سيئا متقطعا خلال فترات ذروة الاستخدام (على سبيل المثال).

إذا كانت مصادقة الوكيل قيد التشغيل، في كل مرة تجري فيها اتصال TCP جديدا Office 365 للحصول على المعلومات، تحتاج إلى المرور عبر عملية مصادقة خلف الكواليس. لذلك، على سبيل المثال، عند التبديل من التقويم إلى البريد في Outlook Online، ستتم المصادقة. وفي SharePoint Online، إذا كانت الصفحة تعرض وسائط أو بيانات من مواقع أو مواقع متعددة، فستصادق على كل اتصال TCP مختلف مطلوب لعرض البيانات.

في Outlook Online، قد تواجه أوقات تحميل بطيئة كلما قمت بالتبديل بين التقويم وعلبة البريد، أو بطء تحميل الصفحة في SharePoint Online. ومع ذلك، هناك أعراض أخرى غير مدرجة هنا.

مصادقة الوكيل هي إعداد على خادم وكيل الخروج. إذا كان يسبب مشكلة في الأداء مع Office 365، يجب استشارة فريق الشبكات.

#### <a name="tools"></a>ادوات

- Netmon
- يريشارك

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

تحدث مصادقة الوكيل كلما كان يجب إنشاء جلسة TCP جديدة، أو عادة لطلب الملفات أو المعلومات من الخادم، أو لتوفير المعلومات. على سبيل المثال، قد ترى مصادقة الوكيل حول طلبات HTTP GET أو HTTP POST. إذا كنت تريد رؤية الإطارات التي تقوم فيها بمصادقة الطلبات في التتبع، فأضف عمود "ملخص NTLMSSP" إلى Netmon وقم بالتصفية ل  `.property.NTLMSSPSummary`. لمعرفة المدة التي تستغرقها المصادقة، أضف عمود Time Delta.

لإضافة عمود إلى Netmon:

1. انقر بزر الماوس الأيمن فوق عمود مثل **الوصف**.
2. انقر فوق **"اختيار أعمدة**".
3. حدد موقع _"ملخص NTLMSSP_ " و" _دلتا الوقت"_ في القائمة وانقر فوق **"إضافة**".
4. انقل الأعمدة الجديدة إلى مكانها قبل عمود _الوصف_ أو خلفه حتى تتمكن من قراءتها جنبا إلى جنب.
5. انقر فوق **موافق**.

حتى إذا لم تقم بإضافة العمود، فسيعمل عامل تصفية Netmon. ولكن سيكون استكشاف الأخطاء وإصلاحها أسهل بكثير إذا كنت تستطيع معرفة مرحلة المصادقة التي تعمل فيها.

عند البحث عن مثيلات مصادقة الوكيل، تأكد من دراسة جميع الإطارات حيث يوجد تحدي NTLM، أو وجود رسالة مصادقة. إذا لزم الأمر، فانقر بزر الماوس الأيمن فوق جزء معين من نسبة استخدام الشبكة والعثور على TCP للمحادثات \> . كن على دراية بقيم Time Delta في هذه المحادثات.

![يظهر تتبع Netmon مصادقة الوكيل، التي تمت تصفيتها حسب المحادثة.](../media/b640f176-0a52-4bbb-972e-60fb3d6aece2.PNG)

تأخير أربع ثوان في مصادقة الوكيل كما هو موضح في Wireshark. تم إنشاء **دلتا الوقت من عمود الإطار المعروض السابق** عن طريق النقر بزر الماوس الأيمن فوق الحقل الذي يحمل نفس الاسم في تفاصيل الإطار وتحديد "إضافة كعمود".  <br/> ![في Wireshark، يمكن إجراء عمود "دلتا الوقت من الإطار المعروض السابق" عن طريق النقر بزر الماوس الأيمن فوق الحقل الذي يحمل نفس الاسم في تفاصيل الإطار وتحديد "إضافة كعمود".](../media/f5b7bde4-8067-4ee0-bc7f-e9062ce1ba6f.PNG)

### <a name="dns-performance"></a>أداء DNS

يعمل تحليل الاسم بشكل أفضل وأسرع عند حدوثه بالقرب من بلد العميل قدر الإمكان.

إذا كان تحليل اسم DNS يحدث في الخارج، فإنه يمكن إضافة ثوان إلى أحمال الصفحة. وبشكل مثالي، يحدث تحليل الاسم في أقل من 100 مللي ثانية. إذا لم يكن كذلك، يجب عليك إجراء مزيد من التحقيق.

> [!TIP]
> هل أنت غير متأكد من كيفية عمل اتصال العميل في Office 365؟ ألق نظرة على مستند مرجع اتصال العميل [هنا](/previous-versions//dn741250(v=technet.10)).

#### <a name="tools"></a>ادوات

- Netmon
- يريشارك
- PsPing

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

عادة ما يكون تحليل أداء DNS مهمة أخرى لتتبع الشبكة. ومع ذلك، فإن PsPing مفيد أيضا في التسبب في حدوث سبب محتمل أو خارجه.

تستند نسبة استخدام الشبكة DNS إلى طلبات TCP وUDP ويتم وضع علامة واضحة على الاستجابات بمعرف سيساعد على مطابقة طلب معين مع استجابته المحددة. سترى حركة مرور DNS عندما تستخدم SharePoint Online على سبيل المثال اسم شبكة أو عنوان URL على صفحة ويب. كقاعدة عامة، يتم تشغيل معظم نسبة استخدام الشبكة هذه، إلا عند نقل المناطق، عبر UDP.

في كل من Netmon و Wireshark، فإن عامل التصفية الأساسي الذي سيسمح لك بالنظر إلى حركة مرور DNS هو ببساطة `dns`. تأكد من استخدام الأحرف الصغيرة عند تحديد عامل التصفية. تذكر مسح ذاكرة التخزين المؤقت لمحلل DNS قبل البدء في إعادة إنتاج المشكلة على كمبيوتر العميل. على سبيل المثال، إذا كان لديك بطء SharePoint تحميل الصفحة عبر الإنترنت للصفحة الرئيسية، فيجب إغلاق كافة المستعرضات وفتح مستعرض جديد وبدء التتبع ومسح ذاكرة التخزين المؤقت لمحلل DNS والاستعراض وصولا إلى موقع SharePoint Online. بمجرد حل الصفحة بأكملها، يجب إيقاف التتبع وحفظه.

![عامل تصفية أساسي ل DNS في Netmon هو DNS.](../media/1bebc118-ca13-45f3-803f-ab73e7af401d.png)

تريد أن تنظر إلى إزاحة الوقت هنا. وقد يكون من المفيد إضافة عمود **Time Delta** إلى Netmon الذي يمكنك القيام به عن طريق إكمال الخطوات التالية:

1. انقر بزر الماوس الأيمن فوق عمود مثل **الوصف**.
2. انقر فوق **"اختيار أعمدة**".
3. حدد موقع _Time Delta_ في القائمة وانقر فوق **"إضافة**".
4. انقل العمود الجديد إلى مكان قبل عمود _الوصف_ أو خلفه حتى تتمكن من قراءته جنبا إلى جنب.
5. انقر فوق **موافق**.

إذا عثرت على استعلام اهتمام، ففكر في عزله بالنقر بزر الماوس الأيمن فوق هذا الاستعلام في لوحة تفاصيل الإطار، واختيار **"بحث عن DNS للمحادثات**\>". لاحظ أن لوحة "محادثات الشبكة" تنتقل مباشرة إلى المحادثة المحددة في سجل حركة مرور UDP.

![تتبع Netmon لتحميل Outlook Online تمت تصفيته بواسطة DNS، واستخدام البحث عن المحادثات ثم DNS لتضييق نطاق النتائج.](../media/763cf20e-7b48-4a37-9449-c9978cfe118b.PNG)

في Wireshark يمكنك إنشاء عمود لوقت DNS. خذ التتبع (أو افتح تتبعا) في Wireshark وقم بالتصفية حسب `dns`، أو، بشكل أكثر فائدة. `dns.time` انقر فوق أي استعلام DNS، وفي اللوحة التي تعرض التفاصيل، قم بتوسيع  `Domain Name System (response)` التفاصيل. سترى حقلا للوقت (على سبيل المثال، `[Time: 0.001111100 seconds]`. انقر بزر الماوس الأيمن هذه المرة وحدد **"تطبيق كعمود**". سيوفر لك ذلك عمود **Time** لإجراء فرز أسرع للتتبع. انقر فوق العمود الجديد للفرز حسب القيم التنازلية لمعرفة استدعاء DNS الذي استغرق أطول حل.

[استعراض SharePoint Online تمت تصفيته في Wireshark حسب dns.time (أحرف صغيرة)، مع الوقت من التفاصيل التي تم إجراؤها في عمود وفرزها تصاعديا.](../media/1439dcc2-12ff-4ee2-9ef3-1484cf79c384.PNG)

إذا كنت ترغب في إجراء مزيد من التحقيق في وقت تحليل DNS، فجرب PsPing مقابل منفذ DNS المستخدم من قبل TCP (على سبيل المثال،  `psping <IP address of DNS server>:53`) . هل لا تزال ترى مشكلة في الأداء؟ إذا قمت بذلك، فمن المرجح أن تكون المشكلة مشكلة شبكة أوسع من مشكلة معينة في تطبيق DNS الذي تحاول حله. تجدر الإشارة أيضا، مرة أخرى، إلى أن ping إلى outlook.office365.com سيخبرك بمكان تحليل اسم DNS Outlook Online (على سبيل المثال، outlook-namnorthwest.office365.com).

إذا كانت المشكلة تبدو محددة ل DNS، فقد يكون من الضروري الاتصال بقسم تكنولوجيا المعلومات لديك لإلقاء نظرة على تكوينات DNS وإعادة توجيه DNS لمزيد من التحقيق في هذه المشكلة.

### <a name="proxy-scalability"></a>قابلية توسع الوكيل

تمنح خدمات مثل Outlook Online في Office 365 العملاء اتصالات متعددة طويلة الأجل. لذلك، قد يستخدم كل مستخدم المزيد من الاتصالات التي تتطلب عمرا أطول.

#### <a name="tools"></a>ادوات

الرياضيات

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

لا توجد أداة تتبع الشبكة أو استكشاف الأخطاء وإصلاحها خاصة بهذا. بدلا من ذلك، فإنه يستند إلى حسابات النطاق الترددي نظرا للقيود والمتغيرات الأخرى.

### <a name="tcp-max-segment-size"></a>الحد الأقصى لحجم المقطع TCP

تم العثور عليها في SYN - SYN/ACK.  قم بإجراء هذا الفحص في أي تتبع لشبكة الأداء قمت به للتأكد من تكوين حزم TCP لنقل الحد الأقصى لكمية البيانات الممكنة.

الهدف هو رؤية MSS من 1460 بايت لنقل البيانات. إذا كنت خلف وكيل، أو كنت تستخدم NAT، فتذكر تشغيل هذا الاختبار من العميل إلى الوكيل/الخروج/NAT، ومن الوكيل/الخروج/NAT إلى Office 365 للحصول على أفضل النتائج! هذه جلسات عمل TCP مختلفة.

#### <a name="tools"></a>ادوات

Netmon

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

TCP Max Segment Size (MSS) هو معلمة أخرى للمصادقة الثلاثية الاتجاه في تتبع الشبكة، وهذا يعني أنك ستجد البيانات التي تحتاجها في حزمة SYN - SYN/ACK. MSS في الواقع بسيط جدا لرؤيته.

افتح أي تتبع لشبكة الأداء لديك وابحث عن الاتصال الذي تشعر بالفضول حوله، أو الذي يوضح مشكلة الأداء.

> [!NOTE]
> إذا كنت تبحث عن تتبع وتحتاج إلى العثور على نسبة استخدام الشبكة ذات الصلة بمحادثتك، فقم بالتصفية حسب IP الخاص بالعميل أو عنوان IP للخادم الوكيل أو نقطة الخروج أو كليهما. مباشرة، ستحتاج إلى اختبار عنوان URL الذي تختبره لعنوان IP Office 365 في التتبع، والتصفية حسبه.

هل تنظر إلى التتبع بشكل غير صحيح؟ حاول استخدام عوامل التصفية لتوجيه نفسك. في Netmon، قم بتشغيل بحث استنادا إلى عنوان URL، مثل `Containsbin(framedata, ascii, "sphybridExample")`، دون رقم الإطار.

في Wireshark استخدم شيئا مثل  `frame contains "sphybridExample"`. إذا لاحظت أنك عثرت على حركة مرور Remote Winsock (RWS) (قد تظهر ك [PSH، ACK] في Wireshark)، فتذكر أنه يمكن رؤية اتصالات RWS قبل وقت قصير من SYN - SYN/ACKs ذات الصلة، كما تمت مناقشتها سابقا.

عند هذه النقطة، يمكنك تسجيل رقم الإطار، وإفلات عامل التصفية، والنقر فوق **"كل نسبة استخدام الشبكة** " في نافذة "محادثات الشبكة" في Netmon لإلقاء نظرة على أقرب SYN.

الأهم من ذلك، إذا لم تتلق أيا من معلومات عنوان IP في وقت التتبع، فإن العثور على عنوان URL الخاص بك في التتبع (جزء من `sphybridExample-my.sharepoint.com`، على سبيل المثال)، سيمنحك عناوين IP للتصفية حسبها.

حدد موقع الاتصال في التتبع الذي تهتم بمشاهدته. يمكنك القيام بذلك إما عن طريق مسح التتبع ضوئيا، أو التصفية حسب عناوين IP، أو عن طريق تحديد معرفات محادثة معينة باستخدام نافذة "محادثات الشبكة" في Netmon. بمجرد العثور على حزمة SYN، قم بتوسيع TCP (في Netmon)، أو بروتوكول التحكم في الإرسال (في Wireshark) في لوحة تفاصيل الإطار. توسيع خيارات TCP وMaxSegmentSize. حدد موقع إطار SYN-ACK ذي الصلة ووسع خيارات TCP وMaxSegmentSize. سيكون أصغر من القيمتين هو الحد الأقصى لحجم المقطع. في هذه الصورة، أستفيد من العمود المضمن في Netmon الذي يسمى استكشاف أخطاء TCP وإصلاحها.

![تتبع الشبكة الذي تمت تصفيته في Netmon باستخدام الأعمدة المضمنة.](../media/e073df13-71f8-497a-83b4-bb9f70bd9833.PNG)

العمود المضمن في أعلى لوحة **"تفاصيل الإطار** ". (للعودة إلى طريقة العرض العادية، انقر فوق **"الأعمدة"** مرة أخرى، ثم اختر **"المنطقة الزمنية**").)

![مكان العثور على القائمة المنسدلة "أعمدة" للخيار "استكشاف أخطاء TCP وإصلاحها" (أعلى "ملخص الإطار").](../media/64fd4baa-a872-4f07-b959-752d7d37fd62.PNG)

فيما يلي تتبع تمت تصفيته في Wireshark. هناك عامل تصفية خاص بقيمة MSS (`tcp.options.mss`). ترتبط إطارات SYN، SYN/ACK، تأكيد ACK في أسفل Wireshark المكافئ لتفاصيل الإطار (لذلك الإطار 47 ACK، ارتباطات إلى 46 SYN/ACK، ارتباطات إلى 43 SYN) لتسهيل هذا النوع من العمل.

![تم تصفية التتبع في Wireshark بواسطة tcp.options.mss ل Max Segment Size (MSS).](../media/51e278db-801b-48bc-9b68-87cf92f03fd6.PNG)

إذا كنت بحاجة إلى التحقق من **"الإشعار الانتقائي"** (الموضوع التالي في هذه المصفوفة)، فلا تغلق التتبع!

### <a name="selective-acknowledgment"></a>إعلام انتقائي

تم العثور عليها في SYN - SYN/ACK. يجب الإبلاغ عن ذلك على أنه مسموح به في كل من SYN وSYN/ACK. يسمح الإشعار الانتقائي (SACK) بإعادة إرسال البيانات بسلاسة عند فقدان حزمة أو حزم. يمكن للأجهزة تعطيل هذه الميزة، والتي يمكن أن تؤدي إلى مشاكل في الأداء.

إذا كنت خلف وكيل، أو كنت تستخدم NAT، فتذكر تشغيل هذا الاختبار من العميل إلى الوكيل/الخروج/NAT، ومن الوكيل/الخروج/NAT إلى Office 365 للحصول على أفضل النتائج! هذه جلسات عمل TCP مختلفة.

#### <a name="tools"></a>ادوات

Netmon

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

الإشعار الانتقائي (SACK) هو معلمة أخرى في تأكيد SYN-SYN/ACK. يمكنك تصفية تتبع SYN - SYN/ACK بعدة طرق.

حدد موقع الاتصال في التتبع الذي تهتم بمشاهدته إما عن طريق مسح التتبع، أو التصفية حسب عناوين IP، أو بالنقر فوق معرف المحادثة باستخدام نافذة "محادثات الشبكة" في Netmon. بمجرد العثور على حزمة SYN، قم بتوسيع TCP في Netmon، أو بروتوكول التحكم في الإرسال في Wireshark في قسم "تفاصيل الإطار". توسيع خيارات TCP ثم SACK. حدد موقع إطار SYN-ACK ذي الصلة ووسع خيارات TCP وحقل SACK الخاص به. تأكد من السماح ب SACK في كل من SYN وSYN/ACK. فيما يلي قيم SACK كما هو موضح في كل من Netmon و Wireshark.

![الإشعار الانتقائي (SACK) في Netmon كنتيجة ل tcp.flags.syn == 1.](../media/216f556f-5031-4ed2-b066-a0d9b3251fa2.PNG)

![SACK كما هو موضح في Wireshark مع عامل التصفية tcp.flags.syn == 1.](../media/0a6e26e5-43dc-403b-adc9-3349a55f4e4b.PNG)

### <a name="dns-geolocation"></a>الموقع الجغرافي ل DNS

حيث يحاول Office 365 في العالم حل مكالمة DNS يؤثر على سرعة الاتصال.

في Outlook Online، بعد اكتمال بحث DNS الأول، سيتم استخدام موقع DNS هذا للاتصال بأقرب مركز بيانات. سيتم توصيلك بخادم OUTLOOK ONLINE CAS، والذي سيستخدم الشبكة الأساسية للاتصال بمركز البيانات (dC) حيث يتم تخزين بياناتك. هذا أسرع.

عند الوصول إلى SharePoint Online، سيتم توجيه المستخدم الذي مسافرا إلى مركز البيانات النشط الخاص به - وهو مركز التحكم في المجال الذي يستند موقعه إلى قاعدة مستأجر SPO الخاصة به (لذلك، dC في الولايات المتحدة الأمريكية إذا كان المستخدم مستندا إلى الولايات المتحدة الأمريكية).

يحتوي Lync online على عقد نشطة في أكثر من dC واحد في كل مرة. عند إرسال الطلبات لمثيلات Lync عبر الإنترنت، سيحدد DNS الخاص ب Microsoft المكان الذي جاء منه الطلب في العالم، وسيعيد عناوين IP من أقرب مركز إقليمي حيث يكون Lync online نشطا.

> [!TIP]
> هل تحتاج إلى معرفة المزيد حول كيفية اتصال العملاء Office 365؟ ألق نظرة على [مقالة مرجع اتصال العميل](/previous-versions//dn741250(v=technet.10)) (ورسوماتها المفيدة).

#### <a name="tools"></a>ادوات

- كره
- PsPing

#### <a name="what-to-look-for"></a>ما الذي يجب البحث عنه

يجب أن تؤدي طلبات تحليل الاسم من خوادم DNS للعميل إلى خوادم DNS الخاصة ب Microsoft في معظم الحالات إلى إرجاع Microsoft DNS عنوان IP لمركز بيانات إقليمي (dC). ماذا يعني هذا بالنسبة لك؟ إذا كان المقر الرئيسي الخاص بك في بنغالور، الهند، ولكنك مسافر في الولايات المتحدة، عندما يقدم المستعرض طلبا Outlook Online، يجب أن تقدم لك خوادم DNS من Microsoft عناوين IP إلى مراكز البيانات في الولايات المتحدة -- مركز بيانات إقليمي. إذا كانت هناك حاجة إلى البريد من Outlook، فستنتقل تلك البيانات عبر شبكة Microsoft الأساسية السريعة بين مراكز البيانات.

يعمل DNS بشكل أسرع عندما يتم تحليل الاسم بالقرب من موقع المستخدم قدر الإمكان. إذا كنت في أوروبا، فأنت تريد الانتقال إلى Microsoft DNS في أوروبا، و(بشكل مثالي) التعامل مع مركز بيانات في أوروبا. سيكون الأداء من عميل في أوروبا الذي يذهب إلى DNS ومركز بيانات في أمريكا أبطأ.

قم بتشغيل أداة Ping مقابل outlook.office365.com لتحديد مكان توجيه طلب DNS في العالم. إذا كنت في أوروبا، يجب أن تشاهد ردا من شيء مثل outlook-emeawest.office365.com. في الاميركتين، توقع شيئا مثل outlook-namnorthwest.office365.com.

افتح موجه الأوامر على كمبيوتر العميل (عبر Start \> Run \> cmd أو Windows key \> type cmd). اكتب outlook.office365.com ping واضغط على ENTER. تذكر، لتحديد -4 إذا كنت تريد تحديد ping عبر IPv4. قد تفشل في الحصول على رد من حزم ICMP، ولكن يجب أن ترى اسم DNS الذي تم توجيه الطلب إليه. إذا كنت ترغب في رؤية أرقام زمن الانتقال لهذا الاتصال، فجرب PsPing إلى عنوان IP الخاص بالخادم الذي يتم إرجاعه بواسطة ping.

![عرض outlook.office365.com الدقة في outlook-namnorthwest.](../media/06c944d5-6159-43ec-aa31-757770695e8b.PNG)

![PSPing إلى عنوان IP الذي تم إرجاعه بواسطة ping إلى outlook.office365.com يظهر متوسط زمن انتقال 28 مللي ثانية.](../media/f2b25a75-1a87-4479-b8a7-fa4375683507.PNG)

### <a name="office-365-application-troubleshooting"></a>استكشاف أخطاء تطبيق Office 365 وإصلاحها

#### <a name="tools"></a>ادوات

- Netmon
- HTTPWatch
- وحدة تحكم F12 في المستعرض

لا نغطي الأدوات المستخدمة في استكشاف الأخطاء وإصلاحها الخاصة بالتطبيق في هذه المقالة الخاصة بالشبكة. ولكنك ستجد الموارد التي  *يمكنك*  استخدامها [في هذه الصفحة](https://support.office.com/article/Network-planning-and-performance-tuning-for-Office-365-e5f1228c-da3c-4654-bf16-d163daee8848).

## <a name="related-topics"></a>المواضيع ذات الصلة

[إدارة نقاط نهاية Office 365](https://support.office.com/article/99cab9d4-ef59-4207-9f2b-3728eb46bf9a)

[الأسئلة المتداولة حول نقاط النهاية Office 365](https://support.office.com/article/d4088321-1c89-4b96-9c99-54c75cae2e6d)