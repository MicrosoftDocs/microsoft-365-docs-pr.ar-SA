---
title: إعداد موصل لاستيراد بيانات البادئة الفعلية
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: how-to
ms.service: O365-seccomp
ms.localizationpriority: medium
search.appverid:
- MET150
ms.collection: M365-security-compliance
ms.custom: admindeeplinkCOMPLIANCE
description: يمكن للمسؤولين إعداد موصل بيانات لاستيراد البيانات من نظام الريش الفعلي لمؤسستهم إلى Microsoft 365. يتيح لك هذا استخدام هذه البيانات في نهج إدارة المخاطر الداخلية لمساعدتك على اكتشاف الوصول إلى المباني المادية الخاصة بك من قبل مستخدمين محددين قد يشير إلى تهديد داخلي محتمل لمؤسستك.
ms.openlocfilehash: a55874b9f920919c16a094d32c4edcde394600d4
ms.sourcegitcommit: caedcf7f16eed23596487d97c375d4bc4c8f3566
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 04/20/2022
ms.locfileid: "64994865"
---
# <a name="set-up-a-connector-to-import-physical-badging-data-preview"></a>إعداد موصل لاستيراد بيانات البادئة الفعلية (معاينة)

[!include[Purview banner](../includes/purview-rebrand-banner.md)]

يمكنك إعداد موصل بيانات في مدخل توافق Microsoft Purview لاستيراد بيانات التالفة المادية، مثل أحداث الوصول الفعلي الأولية للموظف أو أي تنبيهات وصول فعلية تم إنشاؤها بواسطة نظام التالفة الخاص بمؤسستك. أمثلة على نقاط الوصول المادية هي إدخال إلى مبنى أو إدخال إلى غرفة الخادم أو مركز البيانات. يمكن استخدام بيانات التالفة المادية من قبل [حل إدارة المخاطر الداخلية](insider-risk-management.md) Microsoft 365 للمساعدة في حماية مؤسستك من الأنشطة الضارة أو سرقة البيانات داخل مؤسستك.

يتكون إعداد موصل الريش الفعلي من المهام التالية:

- إنشاء تطبيق في Azure Active Directory (Azure AD) للوصول إلى نقطة نهاية واجهة برمجة التطبيقات التي تقبل حمولة JSON التي تحتوي على بيانات التالفة الفعلية.

- إنشاء حمولة JSON مع مخطط معرف بواسطة موصل بيانات التالفة الفعلي.

- إنشاء موصل بيانات تالف فعلي في مدخل التوافق.

- تشغيل برنامج نصي لدفع بيانات الريش المادية إلى نقطة نهاية واجهة برمجة التطبيقات.

- اختياريا، جدولة البرنامج النصي لتشغيله تلقائيا لاستيراد بيانات البادئة الفعلية حاليا.

## <a name="before-you-set-up-the-connector"></a>قبل إعداد الموصل

- يجب تعيين دور مسؤول موصل البيانات للمستخدم الذي يقوم بإنشاء موصل التالفة الفعلي في الخطوة 3. هذا الدور مطلوب لإضافة موصلات على صفحة **موصلات البيانات** في مدخل التوافق. تتم إضافة هذا الدور بشكل افتراضي إلى مجموعات أدوار متعددة. للحصول على قائمة بمجموعات الأدوار هذه، راجع قسم "الأدوار في مراكز الأمان والتوافق" في ["الأذونات" في مركز توافق & الأمان](../security/office-365-security/permissions-in-the-security-and-compliance-center.md#roles-in-the-security--compliance-center). بدلا من ذلك، يمكن للمسؤول في مؤسستك إنشاء مجموعة أدوار مخصصة، وتعيين دور مسؤول موصل البيانات، ثم إضافة المستخدمين المناسبين كأعضاء. للحصول على الإرشادات، راجع قسم "إنشاء مجموعة أدوار مخصصة" في [الأذونات في مدخل توافق Microsoft Purview](microsoft-365-compliance-center-permissions.md#create-a-custom-role-group).

   > [!NOTE]
   > دور مسؤول موصل البيانات غير معتمد حاليا في البيئات الحكومية الأمريكية سحابة القطاع الحكومي High و DoD. لذلك، يجب تعيين دور استيراد تصدير علبة البريد للمستخدم الذي يقوم بإنشاء موصل الموارد البشرية في بيئات سحابة القطاع الحكومي High و DoD في Exchange Online. بشكل افتراضي، لا يتم تعيين هذا الدور إلى أي مجموعة أدوار في Exchange Online. يمكنك إضافة دور تصدير استيراد علبة البريد إلى مجموعة دور إدارة المؤسسة في Exchange Online. أو يمكنك إنشاء مجموعة أدوار جديدة، وتعيين دور "استيراد تصدير علبة البريد"، ثم إضافة المستخدمين المناسبين كأعضاء. لمزيد من المعلومات، راجع مقاطع [إنشاء مجموعات الأدوار](/Exchange/permissions-exo/role-groups#create-role-groups) أو [تعديل مجموعات الأدوار](/Exchange/permissions-exo/role-groups#modify-role-groups) في المقالة "إدارة مجموعات الأدوار في Exchange Online".

- تحتاج إلى تحديد كيفية استرداد البيانات أو تصديرها من نظام التالفا الفعلي لمؤسستك (على أساس يومي) وإنشاء ملف JSON الموضح في الخطوة 2. البرنامج النصي الذي تقوم بتشغيله في الخطوة 4 سيدفع البيانات في ملف JSON إلى نقطة نهاية واجهة برمجة التطبيقات.

- يدفع نموذج البرنامج النصي الذي تقوم بتشغيله في الخطوة 4 بيانات التالفة الفعلية من ملف JSON إلى واجهة برمجة تطبيقات الموصل بحيث يمكن استخدامها من قبل حل إدارة المخاطر الداخلية. هذا البرنامج النصي النموذجي غير معتمد ضمن أي برنامج أو خدمة دعم قياسية من Microsoft. يتم توفير نموذج البرنامج النصي AS IS دون ضمان من أي نوع. وتخلي Microsoft المزيد من المسؤولية عن جميع الضمانات الضمنية، بما في ذلك، على سبيل المثال لا الحصر، أي ضمانات ضمنية لقابلية تجارية أو للياقة لغرض معين. يبقى الخطر بأكمله الناشئ عن استخدام أو أداء نموذج البرنامج النصي والوثائق معك. لن تتحمل شركة Microsoft أو كتابها أو أي شخص آخر مشارك في إنشاء البرامج النصية أو إنتاجها أو تسليمها مسؤولية أي أضرار مهما كانت (بما في ذلك، على سبيل المثال لا الحصر، الأضرار الناجمة عن فقدان أرباح الأعمال أو انقطاع العمل أو فقدان معلومات العمل أو أي خسارة في المالية الأخرى) الناتجة عن استخدام نماذج البرامج النصية أو الوثائق أو عدم القدرة على استخدامها،  حتى إذا تم إعلام Microsoft باحتمال حدوث مثل هذه الأضرار.

- يتوفر هذا الموصل في بيئات سحابة القطاع الحكومي في سحابة Microsoft 365 حكومة الولايات المتحدة. قد تتضمن تطبيقات وخدمات الجهات الخارجية تخزين بيانات العملاء في مؤسستك وإرسالها ومعالجتها على أنظمة تابعة لجهات خارجية خارج البنية الأساسية Microsoft 365 وبالتالي لا تغطيها التزامات Microsoft Purview وحماية البيانات. لا تقدم Microsoft أي تمثيل يشير إلى أن استخدام هذا المنتج للاتصال بتطبيقات الجهات الخارجية يعني أن تطبيقات الجهات الخارجية هذه متوافقة مع FEDRAMP.

## <a name="step-1-create-an-app-in-azure-active-directory"></a>الخطوة 1: إنشاء تطبيق في Azure Active Directory

الخطوة الأولى هي إنشاء تطبيق جديد وتسجيله في Azure Active Directory (Azure AD). سيتطابق التطبيق مع موصل الريش الفعلي الذي تقوم بإنشائه في الخطوة 3. سيسمح إنشاء هذا التطبيق ل Azure AD بمصادقة طلب الدفع لحمولة JSON التي تحتوي على بيانات التالفة الفعلية. أثناء إنشاء تطبيق Azure AD هذا، تأكد من حفظ المعلومات التالية. سيتم استخدام هذه القيم في خطوات لاحقة.

- معرف تطبيق Azure AD (يسمى أيضا *معرف التطبيق* أو *معرف العميل*)

- سر تطبيق Azure AD (يسمى أيضا *سر العميل*)

- معرف المستأجر (يسمى أيضا *معرف الدليل*)

للحصول على إرشادات مفصلة خطوة بخطوة لإنشاء تطبيق في Azure AD، راجع [تسجيل تطبيق باستخدام النظام الأساسي للهويات في Microsoft](/azure/active-directory/develop/quickstart-register-app).

## <a name="step-2-prepare-a-json-file-with-physical-badging-data"></a>الخطوة 2: إعداد ملف JSON باستخدام بيانات الريش الفعلية

الخطوة التالية هي إنشاء ملف JSON يحتوي على معلومات حول بيانات الوصول الفعلي للموظفين. كما هو موضح في القسم قبل البدء، ستحتاج إلى تحديد كيفية إنشاء ملف JSON هذا من نظام التالفة الفعلي لمؤسستك.

يجب أن يتوافق ملف JSON مع تعريف المخطط المطلوب من قبل الموصل. فيما يلي أوصاف لخصائص المخطط المطلوبة لملف JSON:

|الخاصيه|الوصف|نوع البيانات|
|---|---|---|
|Userid|يمكن أن يكون للموظف هويات رقمية متعددة عبر الأنظمة. يجب أن يكون الإدخال معرف Azure AD قد تم حله بالفعل بواسطة النظام المصدر.|عنوان البريد الإلكتروني أو UPN|
|AssetId|المعرف المرجعي للأصل الفعلي أو نقطة الوصول المادية.|سلسلة أبجدية رقمية|
|اسم الأصول|الاسم المألوف للأصول المادية أو نقطة الوصول المادية.|سلسلة أبجدية رقمية|
|وقت الحدث|الطابع الزمني للوصول.|التاريخ والوقت، بتنسيق UTC|
|AccessStatus|`Success` قيمة أو`Failed`|سلسلة|
|||

فيما يلي مثال على ملف JSON الذي يتوافق مع المخطط المطلوب:

```json
[
    {
        "UserId":"sarad@contoso.com",
        "AssetId":"Mid-Sec-7",
        "AssetName":"Main Building 1st Floor Mid Section",
        "EventTime":"2019-07-04T01:57:49",
        "AccessStatus":"Failed"
    },
    {
        "UserId":"pilarp@contoso.com",
        "AssetId":"Mid-Sec-7",
        "AssetName":"Main Building 1st Floor Mid Section",
        "EventTime":"2019-07-04T02:57:49",
        "AccessStatus":"Success"
    }
]
```

يمكنك أيضا تنزيل تعريف المخطط التالي لملف JSON من المعالج عند إنشاء موصل الريش الفعلي في الخطوة 3.

```text
{
   "title" : "Physical Badging Signals",
   "description" : "Access signals from physical badging systems",
   "DataType" : {
      "description" : "Identify what is the data type for input signal",
      "type" : "string",
   },
   "type" : "object",
   "properties": {
      "UserId" : {
         "description" : "Unique identifier AAD Id resolved by the source system",
         "type" : "string",
      },
      "AssetId": {
         "description" : "Unique ID of the physical asset/access point",
         "type" : "string",
      },
      "AssetName": {
         "description" : "friendly name of the physical asset/access point",
         "type" : "string",
      },
      "EventTime" : {
         "description" : "timestamp of access",
         "type" : "string",
      },
      "AccessStatus" : {
         "description" : "what was the status of access attempt - Success/Failed",
         "type" : "string",
      },
   }
   "required" : ["UserId", "AssetId", "EventTime" "AccessStatus"]
}
```

## <a name="step-3-create-the-physical-badging-connector"></a>الخطوة 3: إنشاء موصل الريش الفعلي

الخطوة التالية هي إنشاء موصل badging فعلي في مدخل التوافق. بعد تشغيل البرنامج النصي في الخطوة 4، ستتم معالجة ملف JSON الذي أنشأته في الخطوة 3 ودفعه إلى نقطة نهاية واجهة برمجة التطبيقات التي قمت بتكوينها في الخطوة 1. في هذه الخطوة، تأكد من نسخ JobId الذي تم إنشاؤه عند إنشاء الموصل. ستستخدم JobId عند تشغيل البرنامج النصي.

1. انتقل إلى مدخل التوافق، وحدد <a href="https://go.microsoft.com/fwlink/p/?linkid=2173865" target="_blank">**موصلات البيانات**</a>.

2. في صفحة **"Data connectors** " ضمن **"Physical badging**"، انقر فوق **"عرض**".

3. في صفحة **البادئة الفعلية** ، انقر فوق **"إضافة موصل**".

4. في صفحة **بيانات اعتماد المصادقة** ، قم بما يلي ثم انقر فوق **"التالي**":

   1. اكتب معرف تطبيق Azure AD أو الصقه لتطبيق Azure الذي أنشأته في الخطوة 1.

   2. قم بتنزيل المخطط النموذجي لمرجعك لإنشاء ملف JSON.

   3. اكتب اسما فريدا لموصل الريش الفعلي.

5. في صفحة **المراجعة** ، راجع الإعدادات ثم انقر فوق **"إنهاء** " لإنشاء الموصل.

6. يتم عرض صفحة حالة تؤكد إنشاء الموصل. تحتوي هذه الصفحة أيضا على معرف المهمة. يمكنك نسخ معرف المهمة من هذه الصفحة أو من صفحة القائمة المنبثقة للموصل. تحتاج إلى معرف المهمة هذا عند تشغيل البرنامج النصي.

   تحتوي صفحة الحالة أيضا على ارتباط إلى البرنامج النصي. راجع هذا البرنامج النصي لفهم كيفية نشر ملف JSON إلى نقطة نهاية واجهة برمجة التطبيقات.

7. انقر فوق **"تم**".

   يتم عرض الموصل الجديد في القائمة على علامة التبويب **"الموصلات** ".

8. انقر فوق موصل التالفة الفعلي الذي قمت بإنشائه للتو لعرض صفحة القائمة المنبثقة، والتي تحتوي على خصائص ومعلومات أخرى حول الموصل.

## <a name="step-4-run-the-script-to-post-your-json-file-containing-physical-badging-data"></a>الخطوة 4: تشغيل البرنامج النصي لنشر ملف JSON الذي يحتوي على بيانات تلف فعلية

الخطوة التالية في إعداد موصل badging الفعلي هو تشغيل برنامج نصي من شأنها دفع بيانات التالفة الفعلية في ملف JSON (التي قمت بإنشائها في الخطوة 2) إلى نقطة نهاية واجهة برمجة التطبيقات التي قمت بإنشائها في الخطوة 1. نحن نقدم نموذج البرنامج النصي للمرجع الخاص بك ويمكنك اختيار استخدامه أو إنشاء البرنامج النصي الخاص بك لنشر ملف JSON إلى نقطة نهاية واجهة برمجة التطبيقات.

بعد تشغيل البرنامج النصي، يتم دفع ملف JSON الذي يحتوي على بيانات التالفة المادية إلى مؤسسة Microsoft 365 حيث يمكن الوصول إليها من قبل حل إدارة المخاطر الداخلية. نوصي بنشر بيانات التسيء الفعلية يوميا. يمكنك القيام بذلك عن طريق أتمتة العملية لإنشاء ملف JSON كل يوم من نظام التجعيد الفعلي الخاص بك ثم جدولة البرنامج النصي لدفع البيانات.

> [!NOTE]
> الحد الأقصى لعدد السجلات في ملف JSON التي يمكن معالجتها بواسطة واجهة برمجة التطبيقات هو 50000 سجل.

1. انتقل إلى [موقع GitHub هذا](https://github.com/microsoft/m365-physical-badging-connector-sample-scripts/blob/master/push_physical_badging_records.ps1) للوصول إلى نموذج البرنامج النصي.

2. انقر فوق الزر **Raw** لعرض البرنامج النصي في طريقة عرض النص

3. انسخ كافة الأسطر في نموذج البرنامج النصي ثم احفظها في ملف نصي.

4. تعديل نموذج البرنامج النصي لمؤسستك، إذا لزم الأمر.

5. احفظ الملف النصي كملف برنامج نصي Windows PowerShell باستخدام لاحقة اسم الملف .ps1؛ على سبيل المثال، PhysicalBadging.ps1.

6. افتح موجه الأوامر على الكمبيوتر المحلي، وانتقل إلى الدليل حيث حفظت البرنامج النصي.

7. قم بتشغيل الأمر التالي لدفع بيانات التالمة الفعلية في ملف JSON إلى سحابة Microsoft؛ على سبيل المثال:

   ```powershell
   .\PhysicalBadging.ps1 -tenantId "<Tenant Id>" -appId "<Azure AD App Id>" -appSecret "<Azure AD App Secret>" -jobId "Job Id" -jsonFilePath "<records file path>"
   ```

   يصف الجدول التالي المعلمات التي يجب استخدامها مع هذا البرنامج النصي وقيمها المطلوبة. يتم استخدام المعلومات التي حصلت عليها في الخطوات السابقة في قيم هذه المعلمات.

   |المعلمه|الوصف|
   |---|---|
   |معرف المستأجر|هذا هو المعرف الخاص بمؤسستك Microsoft 365 التي حصلت عليها في الخطوة 1. يمكنك أيضا الحصول على tenantId لمؤسستك على جزء **Overview** في مركز إدارة Azure AD. يتم استخدام هذا لتحديد مؤسستك.|
   |Appid|هذا هو معرف تطبيق Azure AD للتطبيق الذي أنشأته في Azure AD في الخطوة 1. يستخدم Azure AD هذا للمصادقة عندما يحاول البرنامج النصي الوصول إلى مؤسسة Microsoft 365.|
   |appSecret|هذا هو سر تطبيق Azure AD للتطبيق الذي أنشأته في Azure AD في الخطوة 1. يستخدم هذا أيضا للمصادقة.|
   |معرف الوظيفة|هذا هو معرف المهمة لموصل التالفة الفعلي الذي قمت بإنشائه في الخطوة 3. يستخدم هذا لربط بيانات التالفة الفعلية التي يتم دفعها إلى سحابة Microsoft بموصل الريش الفعلي.|
   |JsonFilePath|هذا هو مسار الملف على الكمبيوتر المحلي (الذي تستخدمه لتشغيل البرنامج النصي) لملف JSON الذي أنشأته في الخطوة 2. يجب أن يتبع هذا الملف نموذج المخطط الموضح في الخطوة 3.|
   |||

   فيما يلي مثال على بناء الجملة للبرنامج النصي لموصل الريش الفعلي باستخدام القيم الفعلية لكل معلمة:

   ```powershell
   .\PhysicalBadging.ps1 -tenantId d5723623-11cf-4e2e-b5a5-01d1506273g9 -appId 29ee526e-f9a7-4e98-a682-67f41bfd643e -appSecret MNubVGbcQDkGCnn -jobId b8be4a7d-e338-43eb-a69e-c513cd458eba -jsonFilePath 'C:\Users\contosoadmin\Desktop\Data\physical_badging_data.json'
   ```

   إذا كان التحميل ناجحا، يعرض البرنامج النصي الرسالة **"Upload Successful**".

   إذا كان لديك ملفات JSON متعددة، يجب تشغيل البرنامج النصي لكل ملف.

> [!NOTE]
> يمكنك أيضا اختيار دفع بيانات الريش المادية إلى نقطة نهاية واجهة برمجة التطبيقات بأساليب أخرى غير تشغيل البرنامج النصي السابق. على سبيل المثال، إليك عينة لاستخدام Postman لدفع بياناتك إلى نقطة نهاية واجهة برمجة التطبيقات.

## <a name="step-5-monitor-the-physical-badging-connector"></a>الخطوة 5: مراقبة موصل الريش الفعلي

بعد إنشاء موصل الريش الفعلي ودفع بيانات الريش الفعلية، يمكنك عرض الموصل وتحميل الحالة في مدخل التوافق. إذا قمت بجدولة البرنامج النصي لتشغيله تلقائيا بشكل منتظم، يمكنك أيضا عرض الحالة الحالية بعد المرة الأخيرة التي تم فيها تشغيل البرنامج النصي.

1. انتقل إلى مدخل التوافق، وحدد <a href="https://go.microsoft.com/fwlink/p/?linkid=2173865" target="_blank">**موصلات البيانات**</a>.

2. انقر فوق علامة التبويب **"الموصلات** "، ثم حدد موصل الريش الفعلي لعرض صفحة القائمة المنبثقة. تحتوي هذه الصفحة على الخصائص والمعلومات حول الموصل.

   ![صفحة القائمة المنبثقة للحالة لموصل الريش الفعلي.](..\media\PhysicalBadgingStatusFlyout.png)

3. ضمن **الاستيراد الأخير**، انقر فوق ارتباط **سجل التنزيل** لفتح (أو حفظ) سجل الحالة للموصل. يحتوي هذا السجل على معلومات حول كل مرة يتم فيها تشغيل البرنامج النصي وتحميل البيانات من ملف JSON إلى سحابة Microsoft.

   ![يعرض ملف سجل موصل التالفة الفعلي عدد العناصر من ملف JSON الذي تم تحميله.](..\media\PhysicalBadgingConnectorLogFile.png)

   يشير الحقل **RecordsSaved** إلى عدد العناصر في ملف JSON الذي تم تحميله. على سبيل المثال، إذا كان ملف JSON يحتوي على أربعة كائنات، فإن قيمة الحقول " **حفظ السجلات** " هي 4، إذا قام البرنامج النصي بتحميل كافة العناصر بنجاح في ملف JSON.

إذا لم تكن قد قمت بتشغيل البرنامج النصي في الخطوة 4، يتم عرض ارتباط لتنزيل البرنامج النصي ضمن **الاستيراد الأخير**. يمكنك تنزيل البرنامج النصي ثم اتباع الخطوات الواردة في الخطوة 4 لتشغيله.

## <a name="optional-step-6-schedule-the-script-to-run-automatically"></a>(اختياري) الخطوة 6: جدولة البرنامج النصي لتشغيله تلقائيا

للتأكد من توفر أحدث بيانات التالفة المادية من مؤسستك لأدوات مثل حل إدارة المخاطر من الداخل، نوصي بجدولة البرنامج النصي للتشغيل تلقائيا على أساس متكرر، مثل مرة واحدة في اليوم. يتطلب هذا أيضا تحديث بيانات سوء الاستخدام الفعلية إلى ملف JSON على جدول زمني مشابه (إن لم يكن نفسه) بحيث يحتوي على أحدث المعلومات حول الموظفين الذين يغادرون مؤسستك. والهدف من ذلك هو تحميل أحدث بيانات التالفة المادية بحيث يمكن لموصل التالفة المادي أن يجعلها متاحة لحل إدارة المخاطر الداخلية.

يمكنك استخدام تطبيق Task Scheduler في Windows لتشغيل البرنامج النصي تلقائيا كل يوم.

1. على الكمبيوتر المحلي، انقر فوق الزر "Windows **ابدأ**" ثم اكتب **"جدولة المهام**".

2. انقر فوق تطبيق **"جدولة المهام"** لفتحه.

3. في المقطع **"إجراءات"** ، انقر فوق **"إنشاء مهمة**".

4. في علامة التبويب **"عام** "، اكتب اسما وصفيا للمهمة المجدولة؛ على سبيل المثال، **البرنامج النصي لموصل البادئ الفعلي**. يمكنك أيضا إضافة وصف اختياري.

5. ضمن **خيارات الأمان**، قم بما يلي:

   1. حدد ما إذا كنت تريد تشغيل البرنامج النصي فقط عند تسجيل الدخول إلى الكمبيوتر أو تشغيله عند تسجيل الدخول أم لا.

   2. تأكد من تحديد **خانة الاختيار "تشغيل مع أعلى الامتيازات** ".

6. حدد علامة التبويب **"مشغلات** "، وانقر فوق **"جديد**"، ثم قم بالأشياء التالية:

   1. ضمن **الإعدادات**، حدد الخيار **"يوميا**"، ثم اختر تاريخا ووقتا لتشغيل البرنامج النصي للمرة الأولى. سيتم تشغيل البرنامج النصي كل يوم في نفس الوقت المحدد.

   2. ضمن **الإعدادات المتقدمة**، تأكد من تحديد خانة الاختيار **الممكنة** .

   3. انقر فوق **"موافق**".

7. حدد علامة التبويب **"إجراءات** "، وانقر فوق **"جديد**"، ثم قم بما يلي:

   ![إعدادات الإجراء لإنشاء مهمة مجدولة جديدة للبرنامج النصي لموصل الريش الفعلي.](..\media\SchedulePhysicalBadgingScript1.png)

   1. في القائمة المنسدلة **"إجراء** "، تأكد من تحديد **بدء برنامج** .

   2. في **مربع البرنامج/البرنامج النصي** ، انقر فوق **"استعراض**"، ثم انتقل إلى الموقع التالي وحدده بحيث يتم عرض المسار في المربع: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe.

   3. في المربع **إضافة وسيطات (اختياري)،** الصق الأمر نفسه للبرنامج النصي الذي قمت بتشغيله في الخطوة 4. على سبيل المثال، .\PhysicalBadging.ps1-tenantId "d5723623-11cf-4e2e-b5a5-01d1506273g9" -appId "c12823b7-b55a-4989-faba-02de41bb97c3" -app Secret "MNubVGbcQDkGCnn" -jobId "e081f4f4-3831-48d6-7bb3-fcfab1581458" -jsonFilePath "C:\Users\contosoadmin\Desktop\Data\physical_badging_data.json"

   4. في مربع **البدء في (اختياري)،** الصق موقع مجلد البرنامج النصي الذي قمت بتشغيله في الخطوة 4. على سبيل المثال، C:\Users\contosoadmin\Desktop\Scripts.

   5. انقر فوق **"موافق** " لحفظ إعدادات الإجراء الجديد.

8. في النافذة **"إنشاء مهمة** "، انقر فوق **"موافق** " لحفظ المهمة المجدولة. قد تتم مطالبتك بإدخال بيانات اعتماد حساب المستخدم.

   يتم عرض المهمة الجديدة في مكتبة جدولة المهام.

   ![يتم عرض المهمة الجديدة في مكتبة جدولة المهام.](..\media\SchedulePhysicalBadgingScript2.png)

في المرة الأخيرة التي تم فيها تشغيل البرنامج النصي وفي المرة التالية التي يتم فيها جدولته للتشغيل يتم عرضه. يمكنك النقر نقرا مزدوجا فوق المهمة لتحريرها.

يمكنك أيضا التحقق من المرة الأخيرة التي تم فيها تشغيل البرنامج النصي على صفحة القائمة المنبثقة لموصل الريش الفعلي المقابل في مركز الامتثال.
