---
title: إعداد موصل لاستيراد بيانات الموارد البشرية
f1.keywords:
- NOCSH
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
audience: Admin
ms.topic: how-to
ms.service: O365-seccomp
ms.localizationpriority: medium
search.appverid:
- MET150
ms.collection: M365-security-compliance
ms.custom: admindeeplinkCOMPLIANCE
description: يمكن للمسؤولين إعداد موصل بيانات لاستيراد بيانات الموظفين من نظام الموارد البشرية (HR) لمؤسستهم إلى Microsoft 365. يتيح لك ذلك استخدام بيانات الموارد البشرية في نهج إدارة المخاطر الداخلية لمساعدتك على اكتشاف نشاط مستخدمين محددين قد يشكل تهديدا داخليا لمؤسستك.
ms.openlocfilehash: e1539661c987de8642639df777602fbcf05bdcc4
ms.sourcegitcommit: 52eea2b65c0598ba4a1b930c58b42dbe62cdaadc
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 04/19/2022
ms.locfileid: "64944800"
---
# <a name="set-up-a-connector-to-import-hr-data"></a>إعداد موصل لاستيراد بيانات الموارد البشرية

يمكنك إعداد موصل بيانات في مدخل توافق Microsoft Purview لاستيراد بيانات الموارد البشرية (HR) المتعلقة بأحداث مثل توابع المستخدم أو تغيير في مستوى وظيفة المستخدم. يمكن بعد ذلك استخدام بيانات الموارد البشرية من قبل [حل إدارة المخاطر من الداخل](insider-risk-management.md) لإنشاء مؤشرات المخاطر التي يمكن أن تساعدك على تحديد النشاط الضار المحتمل أو سرقة البيانات من قبل المستخدمين داخل مؤسستك.

يتكون إعداد موصل لبيانات الموارد البشرية التي يمكن أن تستخدمها نهج إدارة المخاطر الداخلية لإنشاء مؤشرات المخاطر من إنشاء ملف CSV يحتوي على بيانات الموارد البشرية، وإنشاء تطبيق في Azure Active Directory يستخدم للمصادقة، وإنشاء موصل بيانات الموارد البشرية في مدخل التوافق، ثم تشغيل برنامج نصي (على أساس مجدول) يستوعب بيانات الموارد البشرية في ملفات CSV إلى سحابة Microsoft بحيث تكون متوفرة إلى حل إدارة المخاطر الداخلية.

> [!IMPORTANT]
> يتوفر الآن إصدار جديد من موصل الموارد البشرية للمعاينة العامة. لإنشاء موصل موارد بشرية جديد أو لاستيراد بيانات [لسيناريو ملف تعريف الموظف الجديد](#csv-file-for-employee-profile-data-preview) لسيناريو نهج الرعاية الصحية لإدارة المخاطر الداخلية، انتقل إلى صفحة **موصلات البيانات** في مدخل التوافق، وحدد علامة التبويب **Connectors** ، ثم انقر فوق **إضافة موصل > HR (معاينة)** لبدء الإعداد. ستستمر موصلات الموارد البشرية الموجودة في العمل دون أي تعطيل.

## <a name="before-you-begin"></a>قبل البدء

- تحديد سيناريوهات الموارد البشرية والبيانات التي يجب استيرادها إلى Microsoft 365. سيساعدك هذا في تحديد عدد ملفات CSV وموصلات الموارد البشرية التي ستحتاج إلى إنشائها، وكيفية إنشاء ملفات CSV وبنائها. يتم تحديد بيانات الموارد البشرية التي تقوم باستيرادها بواسطة نهج إدارة المخاطر الداخلية التي تريد تنفيذها. لمزيد من المعلومات، راجع الخطوة 1.

- حدد كيفية استرداد البيانات أو تصديرها من نظام الموارد البشرية لمؤسستك (وبشكل منتظم) وإضافتها إلى ملفات CSV التي تقوم بإنشائها في الخطوة 1. سيقوم البرنامج النصي الذي تقوم بتشغيله في الخطوة 4 بتحميل بيانات الموارد البشرية في ملفات CSV إلى سحابة Microsoft.

- يجب تعيين دور مسؤول موصل البيانات للمستخدم الذي يقوم بإنشاء موصل الموارد البشرية في الخطوة 3. هذا الدور مطلوب لإضافة موصلات على صفحة **موصلات البيانات** في مدخل التوافق. تتم إضافة هذا الدور بشكل افتراضي إلى مجموعات أدوار متعددة. للحصول على قائمة بمجموعات الأدوار هذه، راجع قسم "الأدوار في مراكز الأمان والتوافق" في ["الأذونات" في مركز توافق & الأمان](../security/office-365-security/permissions-in-the-security-and-compliance-center.md#roles-in-the-security--compliance-center). بدلا من ذلك، يمكن للمسؤول في مؤسستك إنشاء مجموعة أدوار مخصصة، وتعيين دور مسؤول موصل البيانات، ثم إضافة المستخدمين المناسبين كأعضاء. للحصول على الإرشادات، راجع قسم "إنشاء مجموعة أدوار مخصصة" في [الأذونات في مدخل توافق Microsoft Purview](microsoft-365-compliance-center-permissions.md#create-a-custom-role-group).

- سيقوم البرنامج النصي النموذجي الذي تقوم بتشغيله في الخطوة 4 بتحميل بيانات الموارد البشرية إلى سحابة Microsoft بحيث يمكن استخدامها من قبل حل إدارة المخاطر الداخلية. هذا البرنامج النصي النموذجي غير معتمد ضمن أي برنامج أو خدمة دعم قياسية من Microsoft. يتم توفير نموذج البرنامج النصي AS IS دون ضمان من أي نوع. وتخلي Microsoft المزيد من المسؤولية عن جميع الضمانات الضمنية، بما في ذلك، على سبيل المثال لا الحصر، أي ضمانات ضمنية لقابلية تجارية أو للياقة لغرض معين. يبقى الخطر بأكمله الناشئ عن استخدام أو أداء نموذج البرنامج النصي والوثائق معك. لن تتحمل شركة Microsoft أو كتابها أو أي شخص آخر مشارك في إنشاء البرامج النصية أو إنتاجها أو تسليمها مسؤولية أي أضرار مهما كانت (بما في ذلك، على سبيل المثال لا الحصر، الأضرار الناجمة عن فقدان أرباح الأعمال أو انقطاع العمل أو فقدان معلومات العمل أو أي خسارة في المالية الأخرى) الناتجة عن استخدام نماذج البرامج النصية أو الوثائق أو عدم القدرة على استخدامها،  حتى إذا تم إعلام Microsoft باحتمال حدوث مثل هذه الأضرار.

- يتوفر هذا الموصل في بيئات سحابة القطاع الحكومي في سحابة Microsoft 365 حكومة الولايات المتحدة. قد تتضمن تطبيقات وخدمات الجهات الخارجية تخزين بيانات العملاء في مؤسستك وإرسالها ومعالجتها على أنظمة تابعة لجهات خارجية خارج البنية الأساسية Microsoft 365 وبالتالي لا تغطيها التزامات Microsoft Purview وحماية البيانات. لا تقدم Microsoft أي تمثيل يشير إلى أن استخدام هذا المنتج للاتصال بتطبيقات الجهات الخارجية يعني أن تطبيقات الجهات الخارجية هذه متوافقة مع FEDRAMP. للحصول على إرشادات مفصلة خطوة بخطوة لإعداد موصل الموارد البشرية في بيئة سحابة القطاع الحكومي، راجع [إعداد موصل لاستيراد بيانات الموارد البشرية في حكومة الولايات المتحدة](import-hr-data-US-government.md).

## <a name="step-1-prepare-a-csv-file-with-your-hr-data"></a>الخطوة 1: إعداد ملف CSV باستخدام بيانات الموارد البشرية

الخطوة الأولى هي إنشاء ملف CSV يحتوي على بيانات الموارد البشرية التي سيستوردها الموصل إلى Microsoft 365. سيتم استخدام هذه البيانات من قبل حل المخاطر الداخلية لإنشاء مؤشرات المخاطر المحتملة. يمكن استيراد بيانات سيناريوهات الموارد البشرية التالية إلى Microsoft 365:

- موظف متنازل. معلومات حول الموظفين الذين غادروا مؤسستك.

- تغييرات مستوى المهمة. معلومات حول تغييرات مستوى الوظيفة للموظفين، مثل الترقيات والتخفيضات.

- مراجعات الأداء. معلومات حول أداء الموظفين.

- خطط تحسين الأداء. معلومات حول خطط تحسين الأداء للموظفين.

- ملف تعريف الموظف (معاينة). معلومات عامة حول موظف.

يعتمد نوع بيانات الموارد البشرية المراد استيرادها على نهج إدارة المخاطر الداخلية وقالب النهج المقابل الذي تريد تنفيذه. يوضح الجدول التالي نوع بيانات الموارد البشرية المطلوب لكل قالب نهج:

|  قالب النهج |  نوع بيانات الموارد البشرية |
|:------------------------------|:--------------------------------|
| سرقة البيانات من قبل المستخدمين المغادرين | أحمال العمل للموظفين|
| تسربات البيانات العامة                             | غير قابل للتطبيق|
| تسرب البيانات من قبل المستخدمين ذو الأولوية                   | غير قابل للتطبيق |
| تسرب البيانات من قبل المستخدمين الساخطين                | تغييرات مستوى الوظيفة، ومراجعات الأداء، وخطط تحسين الأداء|
| انتهاكات نهج الأمان العامة             | غير قابل للتطبيق |
| انتهاكات نهج الأمان من قبل المستخدمين المغادرين  | أحمال العمل للموظفين|
| انتهاكات نهج الأمان من قبل المستخدمين ذات الأولوية   | غير قابل للتطبيق|
| انتهاكات نهج الأمان من قبل المستخدمين الساخطين| تغييرات مستوى الوظيفة، ومراجعات الأداء، وخطط تحسين الأداء |
| لغة مسيئة في البريد الإلكتروني                    | غير قابل للتطبيق |
| نهج الرعاية الصحية| ملف تعريف الموظفين |
|||

لمزيد من المعلومات حول قوالب النهج لإدارة المخاطر الداخلية، راجع [نهج إدارة المخاطر من Insider](insider-risk-management-policies.md#policy-templates).

لكل سيناريو للموارد البشرية، ستحتاج إلى توفير بيانات الموارد البشرية المقابلة في ملف CSV واحد أو أكثر. تتم مناقشة عدد ملفات CSV التي يجب استخدامها لتنفيذ إدارة المخاطر الداخلية لاحقا في هذا القسم.

بعد إنشاء ملف CSV باستخدام بيانات الموارد البشرية المطلوبة، قم بتخزينه على الكمبيوتر المحلي الذي تقوم بتشغيل البرنامج النصي عليه في الخطوة 4. يجب عليك أيضا تنفيذ استراتيجية تحديث للتأكد من أن ملف CSV يحتوي دائما على أحدث المعلومات بحيث يتم تحميل بيانات الموارد البشرية الأحدث إلى سحابة Microsoft ويمكن الوصول إليها من قبل حل إدارة المخاطر من الداخل.

> [!IMPORTANT]
> أسماء الأعمدة الموضحة في الأقسام التالية ليست معلمات مطلوبة، بل أمثلة فقط. يمكنك استخدام أي اسم عمود في ملفات CSV. ومع ذلك، *يجب* تعيين أسماء الأعمدة التي تستخدمها في ملف CSV إلى نوع البيانات عند إنشاء موصل الموارد البشرية في الخطوة 3. لاحظ أيضا أن نماذج ملفات CSV في المقاطع التالية تظهر في طريقة عرض المفكرة. من الأسهل بكثير عرض ملفات CSV وتحريرها في Microsoft Excel.

تصف الأقسام التالية بيانات CSV المطلوبة لكل سيناريو للموارد البشرية.

### <a name="csv-file-for-employee-resignation-data"></a>ملف CSV لبيانات الموظف عن العمل

فيما يلي مثال على ملف CSV لبيانات الموظفين.

```text
EmailAddress,ResignationDate,LastWorkingDate
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,2019-04-29T15:18:02.4675041+05:30
pilarp@contoso.com,2019-04-24T09:15:49Z,2019-04-29T15:18:02.7117540
```

يصف الجدول التالي كل عمود في ملف CSV لبيانات الموظف.

|  العمود   |   الوصف |
|:------------|:----------------|
|**Emailaddress**| تحديد عنوان البريد الإلكتروني (UPN) للمستخدم الذي تم إنهاؤه.|
| **تاريخ المعالجة** | تحديد تاريخ إنهاء توظيف المستخدم رسميا في مؤسستك. على سبيل المثال، قد يكون هذا هو التاريخ الذي قدم فيه المستخدم إشعاره حول مغادرة مؤسستك. قد يكون هذا التاريخ مختلفا عن تاريخ آخر يوم عمل للشخص. استخدم تنسيق التاريخ التالي: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm`، وهو [تنسيق التاريخ والوقت ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **LastWorkingDate** | تحديد اليوم الأخير من العمل للمستخدم الذي تم إنهاؤه. استخدم تنسيق التاريخ التالي: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm`، وهو [تنسيق التاريخ والوقت ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
|||

### <a name="csv-file-for-job-level-changes-data"></a>ملف CSV لمستوى الوظيفة يغير البيانات

فيما يلي مثال على ملف CSV لبيانات تغيير مستوى الوظيفة.

```text
EmailAddress,EffectiveDate,OldLevel,NewLevel
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Level 61 - Sr. Manager,Level 60- Manager
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30,Level 62 - Director,Level 60- Sr. Manager
```

يصف الجدول التالي كل عمود في ملف CSV لتغيير البيانات على مستوى المهمة.

|  العمود | الوصف |
|:--------- |:------------- |
| **Emailaddress**  | تحديد عنوان البريد الإلكتروني للمستخدم (UPN).|
| **تاريخ الفعالية** | تحديد التاريخ الذي تم فيه تغيير مستوى مهمة المستخدم رسميا. استخدم تنسيق التاريخ التالي: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm`، وهو [تنسيق التاريخ والوقت ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **ملاحظات**| تحديد الملاحظات التي قدمها القائم بالتقييم حول تغيير مستوى الوظيفة. يمكنك إدخال حد 200 حرف. هذه المعلمة اختيارية. لست مضطرا لتضمينه في ملف CSV.|
| **OldLevel**| تحديد مستوى مهمة المستخدم قبل تغييره. هذه معلمة نص حر ويمكن أن تحتوي على تصنيف هرمي لمؤسستك. هذه المعلمة اختيارية. لست مضطرا لتضمينه في ملف CSV.|
| **NewLevel**| تحديد مستوى مهمة المستخدم بعد تغييره. هذه معلمة نص حر ويمكن أن تحتوي على تصنيف هرمي لمؤسستك. هذه المعلمة اختيارية. لست مضطرا لتضمينه في ملف CSV.|
|||

### <a name="csv-file-for-performance-review-data"></a>ملف CSV لبيانات مراجعة الأداء

فيما يلي مثال على ملف CSV لبيانات الأداء.

```text
EmailAddress,EffectiveDate,Remarks,Rating
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Met expectations but bad attitude,2-Below expectation
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team
```

يصف الجدول التالي كل عمود في ملف CSV لبيانات مراجعة الأداء.

|  العمود | الوصف |
|:----------|:--------------|
| **Emailaddress**  | تحديد عنوان البريد الإلكتروني للمستخدم (UPN).|
| **تاريخ الفعالية** | يحدد التاريخ الذي تم فيه إعلام المستخدم رسميا بنتيجة مراجعة أدائه. يمكن أن يكون هذا هو التاريخ الذي انتهت فيه دورة مراجعة الأداء. استخدم تنسيق التاريخ التالي: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm`، وهو [تنسيق التاريخ والوقت ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **ملاحظات**| تحديد أي ملاحظات قدمها القائم بالتقييم إلى المستخدم لمراجعة الأداء. هذه معلمة نص بحد أقصى 200 حرف. هذه المعلمة اختيارية. لست مضطرا لتضمينه في ملف CSV.|
| **تقييم الموقع**| تحديد التصنيف المقدم لمراجعة الأداء. هذه معلمة نص ويمكن أن تحتوي على أي نص حر تستخدمه مؤسستك للتعرف على التقييم. على سبيل المثال، "3 استيفاء التوقعات" أو "2 أقل من المتوسط". هذه معلمة نص بحد أقصى 25 حرفا. هذه المعلمة اختيارية. لست مضطرا لتضمينه في ملف CSV.|
|||

### <a name="csv-file-for-performance-improvement-plan-data"></a>ملف CSV لبيانات خطة تحسين الأداء

فيما يلي مثال على ملف CSV لبيانات بيانات خطة تحسين الأداء.

```text
EmailAddress,EffectiveDate,ImprovementRemarks,PerformanceRating
sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,Met expectation but bad attitude,2-Below expectation
pillar@contoso.com,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team
```

يصف الجدول التالي كل عمود في ملف CSV لبيانات مراجعة الأداء.

|  العمود |  الوصف |
|:----------|:---------------|
| **Emailaddress**  | تحديد عنوان البريد الإلكتروني للمستخدم (UPN).|
| **تاريخ الفعالية** | تحديد التاريخ الذي تم فيه إعلام المستخدم رسميا بخطة تحسين الأداء الخاصة به. يجب استخدام تنسيق التاريخ التالي: `yyyy-mm-ddThh:mm:ss.nnnnnn+|-hh:mm`، وهو [تنسيق التاريخ والوقت ISO 8601](https://www.iso.org/iso-8601-date-and-time-format.html).|
| **ملاحظات**| تحديد أي ملاحظات قدمها القائم بالتقييم حول خطة تحسين الأداء. هذه معلمة نص بحد أقصى 200 حرف. هذه معلمة اختيارية. لست مضطرا لتضمينه في ملف CSV. |
| **تقييم الموقع**| تحديد أي تصنيف أو معلومات أخرى تتعلق بمراجعة الأداء. هذه معلمة نص ويمكن أن تحتوي على أي نص نموذج مجاني تستخدمه مؤسستك للتعرف على التقييم. على سبيل المثال، "3 استيفاء التوقعات" أو "2 أقل من المتوسط". هذه معلمة نص بحد أقصى 25 حرفا. هذه معلمة اختيارية. لست مضطرا لتضمينه في ملف CSV.|
|||

### <a name="csv-file-for-employee-profile-data-preview"></a>ملف CSV لبيانات ملف تعريف الموظفين (معاينة)

> [!NOTE]
> القدرة على إنشاء موصل الموارد البشرية لبيانات ملف تعريف الموظفين في المعاينة العامة. لإنشاء موصل الموارد البشرية الذي يدعم بيانات ملف تعريف الموظف، انتقل إلى صفحة **موصلات البيانات** في مدخل التوافق، وحدد علامة التبويب **"الموصلات**"، ثم انقر فوق **إضافة موصلHR** >  **(معاينة).** اتبع الخطوات لإنشاء موصل في [الخطوة 3: إنشاء موصل الموارد البشرية](#step-3-create-the-hr-connector).

فيما يلي مثال على ملف CSV لبيانات بيانات ملف تعريف الموظف.

```text
EmailAddress,UserName,EmployeeFirstName,EmployeeLastName,EmployeeAddLine1,EmployeeAddLine2,EmployeeCity,EmployeeState,EmployeeZipCode,EmployeeDept,EmployeeType,EmployeeRole
jackq@contoso.com,jackq,jack,qualtz,50 Oakland Ave,#206,City,Florida,32104,Orthopaedic,Regular,Nurse
```

يصف الجدول التالي كل عمود في ملف CSV لبيانات ملف تعريف الموظفين.

|  العمود |  الوصف |
|:----------|:---------------|
| Emailaddress<sup>*</sup>    | اسم المستخدم الأساسي (UPN) أو عنوان البريد الإلكتروني للموظف.|
| EmployeeFirstName<sup>*</sup>   | الاسم الأول للموظف.|
| EmployeeLastName<sup>*</sup>   | اسم العائلة للموظف.|
| EmployeeAddressLine1<sup>*</sup>    | عنوان الشارع للموظف.|
| EmployeeAddressLine2   | معلومات العنوان الثانوي، مثل رقم منزل الموظف.|
| الموظف | مدينة الإقامة للموظف.|
| EmployeeState | حالة الإقامة للموظف.|
| EmployeeZipCode<sup>*</sup>  | الرمز البريدي لمحل إقامة الموظف. |
| حساب الموظف| بلد إقامة الموظف.|
| إدارة الموظفين | قسم الموظف في المؤسسة.|
| نوع الموظف |نوع التوظيف للموظف، مثل عادي أو معفي أو مقاول.|
| EmployeeRole |دور الموظفين أو تعيينهم أو المسمى الوظيفي في المؤسسة.|
|||

> [!NOTE]
> <sup>*</sup> هذا العمود إلزامي. إذا كان أحد الأعمدة الإلزامية مفقودا، فلن يتم التحقق من صحة ملف CSV ولن يتم استيراد بيانات أخرى في الملف.

نوصي بإنشاء موصل الموارد البشرية الذي يستورد بيانات ملف تعريف الموظفين فقط. لهذا الموصل، تأكد من تحديث بيانات ملف تعريف الموظف بشكل متكرر، ويفضل أن يكون ذلك كل 15 إلى 20 يوما. سيتم حذف سجلات ملفات تعريف الموظفين إذا لم يتم تحديثها في آخر 30 يوما.

### <a name="determining-how-many-csv-files-to-use-for-hr-data"></a>تحديد عدد ملفات CSV التي يجب استخدامها لبيانات الموارد البشرية

في الخطوة 3، يمكنك اختيار إنشاء موصلات منفصلة لكل نوع من أنواع بيانات الموارد البشرية أو يمكنك اختيار إنشاء موصل واحد لجميع أنواع البيانات. يمكنك استخدام ملفات CSV منفصلة تحتوي على بيانات لسيناريو واحد للموارد البشرية (مثل أمثلة ملفات CSV الموضحة في الأقسام السابقة). بدلا من ذلك، يمكنك استخدام ملف CSV واحد يحتوي على بيانات لسيناريو الموارد البشرية اثنين أو أكثر. فيما يلي بعض الإرشادات لمساعدتك في تحديد عدد ملفات CSV التي يجب استخدامها لبيانات الموارد البشرية.

- إذا كان نهج إدارة المخاطر الداخلية الذي تريد تنفيذه يتطلب أنواع بيانات موارد بشرية متعددة، ففكر في استخدام ملف CSV واحد يحتوي على جميع أنواع البيانات المطلوبة.

- قد تحدد طريقة إنشاء بيانات الموارد البشرية أو جمعها عدد ملفات CSV. على سبيل المثال، إذا كانت الأنواع المختلفة من بيانات الموارد البشرية المستخدمة لتكوين موصل الموارد البشرية موجودة في نظام موارد بشرية واحد في مؤسستك، فقد تتمكن من تصدير البيانات إلى ملف CSV واحد. ولكن إذا تم توزيع البيانات عبر أنظمة موارد بشرية مختلفة، فقد يكون من الأسهل تصدير البيانات إلى ملفات CSV مختلفة. على سبيل المثال، قد تكون بيانات الموظف في نظام موارد بشرية مختلف عن مستوى الوظيفة أو بيانات مراجعة الأداء. في هذه الحالة، قد يكون من الأسهل أن يكون لديك ملفات CSV منفصلة بدلا من الحاجة إلى دمج البيانات يدويا في ملف CSV واحد. لذلك، قد تحدد كيفية استرداد البيانات أو تصديرها من أنظمة الموارد البشرية كيفية عدد ملفات CSV التي ستحتاج إليها.

- كقاعدة عامة، يتم تحديد عدد موصلات الموارد البشرية التي ستحتاج إلى إنشائها بواسطة أنواع البيانات في ملف CSV. على سبيل المثال، إذا كان ملف CSV يحتوي على جميع أنواع البيانات المطلوبة لدعم تنفيذ إدارة المخاطر الداخلية الخاصة بك، فأنت بحاجة إلى موصل موارد بشرية واحد فقط. ولكن إذا كان لديك ملفي CSV منفصلين يحتوي كل منهما على نوع بيانات واحد، فسيضطر إلى إنشاء موصلين للموارد البشرية. استثناء من هذا هو أنه إذا أضفت عمود **HRScenario** إلى ملف CSV (راجع القسم التالي)، يمكنك تكوين موصل موارد بشرية واحد يمكنه معالجة ملفات CSV مختلفة.

### <a name="configuring-a-single-csv-file-for-multiple-hr-data-types"></a>تكوين ملف CSV واحد لأنواع بيانات الموارد البشرية المتعددة

يمكنك إضافة أنواع بيانات موارد بشرية متعددة إلى ملف CSV واحد. يعد هذا مفيدا إذا كان حل إدارة المخاطر الداخلية الذي تنفذه يتطلب أنواع بيانات متعددة للموارد البشرية أو إذا كانت أنواع البيانات موجودة في نظام موارد بشرية واحد في مؤسستك. وجود عدد أقل من ملفات CSV يسمح لك دائما أن يكون لديك عدد أقل من موصلات الموارد البشرية لإنشاء وإدارة.

فيما يلي متطلبات لتكوين ملف CSV مع أنواع بيانات متعددة:

- يجب إضافة الأعمدة المطلوبة (والاختيارية إذا كنت تستخدمها) لكل نوع بيانات واسم العمود المقابل في صف الرأس. إذا لم يتوافق نوع البيانات مع عمود، يمكنك ترك القيمة فارغة.

- لاستخدام ملف CSV مع أنواع متعددة من بيانات الموارد البشرية، يحتاج موصل الموارد البشرية إلى معرفة الصفوف في ملف CSV التي تحتوي على نوع بيانات الموارد البشرية. يتم تحقيق ذلك عن طريق إضافة عمود **HRScenario** إضافي إلى ملف CSV. تحدد القيم الموجودة في هذا العمود نوع بيانات الموارد البشرية في كل صف. على سبيل المثال، يمكن أن تكون القيم التي تتوافق مع سيناريوهات الموارد البشرية الأربعة هي \`"سهى\`"، \`وتغيير\` مستوى الوظيفة، \`ومراجعة\` الأداء، \`وخطة\` تحسين الأداء، وملف \`تعريف\` الموظفين.

- إذا كان لديك ملفات CSV متعددة تحتوي على عمود HRScenario**، فتأكد من أن كل ملف يستخدم نفس اسم العمود ونفس القيم التي تحدد سيناريوهات الموارد البشرية المحددة.

يوضح المثال التالي ملف CSV يحتوي على عمود **HRScenario** . تحدد القيم الموجودة في عمود HRScenario نوع البيانات في الصف المقابل.

```text
HRScenario,EmailAddress,ResignationDate,LastWorkingDate,EffectiveDate,Remarks,Rating,OldLevel,NewLevel
Resignation,sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,2019-04-29T15:18:02.4675041+05:30,,,,
Resignation,pilarp@contoso.com,2019-04-24T09:15:49Z,2019-04-29T15:18:02.7117540,,,,
Job level change,sarad@contoso.com,2019-04-23T15:18:02.4675041+05:30,,,,,Level 61 Sr. Manager, Level 60 Manager
Job level change,pillarp@contoso.com,2019-04-23T15:18:02.4675041+05:30,,,,,Level 62 Director,Level 60 Sr Manager
Performance review,sarad@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Met expectation but bad attitude,2 Below expectations,,
Performance review,pillarp@contoso.com,,,2019-04-23T15:18:02.4675041+05:30, Multiple conflicts with the team,,
Performance improvement plan,sarad@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Met expectations but bad attitude,2 Below expectations,,
Performance improvement plan,pillarp@contoso.com,,,2019-04-23T15:18:02.4675041+05:30,Multiple conflicts with the team,,
```

> [!NOTE]
> يمكنك استخدام أي اسم للعمود الذي يحدد نوع بيانات الموارد البشرية لأنك ستقوم بتعيين اسم العمود في ملف CSV كعمود يحدد نوع بيانات الموارد البشرية عند إعداد الموصل في الخطوة 3. ستقوم أيضا بتعيين القيم المستخدمة لعمود نوع البيانات عند إعداد الموصل.

### <a name="adding-the-hrscenario-column-to-a-csv-file-that-contains-a-single-data-type"></a>إضافة عمود HRScenario إلى ملف CSV يحتوي على نوع بيانات واحد

استنادا إلى أنظمة الموارد البشرية في مؤسستك وكيف ستقوم بتصدير بيانات الموارد البشرية إلى ملف CSV، قد تحتاج إلى إنشاء ملفات CSV متعددة تحتوي على نوع بيانات موارد بشرية واحد. في هذه الحالة، لا يزال بإمكانك إنشاء موصل موارد بشرية واحد لاستيراد البيانات من ملفات CSV مختلفة. للقيام بذلك، سيتعين عليك فقط إضافة عمود HRScenario إلى ملف CSV وتحديد نوع بيانات الموارد البشرية. ثم يمكنك تشغيل البرنامج النصي لكل ملف CSV، ولكن استخدم نفس معرف المهمة للموصل. راجع [الخطوة 4](#step-4-run-the-sample-script-to-upload-your-hr-data).

## <a name="step-2-create-an-app-in-azure-active-directory"></a>الخطوة 2: إنشاء تطبيق في Azure Active Directory

الخطوة التالية هي إنشاء تطبيق جديد وتسجيله في Azure Active Directory (Azure AD). سيتطابق التطبيق مع موصل الموارد البشرية الذي تقوم بإنشائه في الخطوة 3. سيسمح إنشاء هذا التطبيق ل Azure AD بمصادقة موصل الموارد البشرية عند تشغيله ومحاولة الوصول إلى مؤسستك. سيتم استخدام هذا التطبيق أيضا لمصادقة البرنامج النصي الذي تقوم بتشغيله في الخطوة 4 لتحميل بيانات الموارد البشرية إلى سحابة Microsoft. أثناء إنشاء تطبيق Azure AD هذا، تأكد من حفظ المعلومات التالية. سيتم استخدام هذه القيم في الخطوة 3 والخطوة 4.

- معرف تطبيق Azure AD (يسمى أيضا *معرف التطبيق* أو *معرف العميل*)

- سر تطبيق Azure AD (يسمى أيضا *سر العميل*)

- معرف المستأجر (يسمى أيضا *معرف الدليل*)

للحصول على إرشادات مفصلة خطوة بخطوة لإنشاء تطبيق في Azure AD، راجع [تسجيل تطبيق باستخدام النظام الأساسي للهويات في Microsoft](/azure/active-directory/develop/quickstart-register-app).

## <a name="step-3-create-the-hr-connector"></a>الخطوة 3: إنشاء موصل الموارد البشرية

الخطوة التالية هي إنشاء موصل الموارد البشرية في مدخل التوافق. بعد تشغيل البرنامج النصي في الخطوة 4، سيستوعب موصل الموارد البشرية الذي تقوم بإنشائه بيانات الموارد البشرية من ملف CSV إلى مؤسسة Microsoft 365. قبل إنشاء موصل، تأكد من أن لديك قائمة بسيناريوهات الموارد البشرية وأسماء أعمدة CSV المقابلة لكل واحد. يجب تعيين البيانات المطلوبة لكل سيناريو إلى أسماء الأعمدة الفعلية في ملف CSV عند تكوين الموصل. بدلا من ذلك، يمكنك تحميل نموذج ملف CSV عند تكوين الموصل وسيساعدك المعالج على تعيين اسم الأعمدة إلى أنواع البيانات المطلوبة.

بعد إكمال هذه الخطوة، تأكد من نسخ معرف المهمة الذي تم إنشاؤه عند إنشاء الموصل. ستستخدم معرف المهمة عند تشغيل البرنامج النصي.

1. انتقل إلى مدخل التوافق، وحدد <a href="https://go.microsoft.com/fwlink/p/?linkid=2173865" target="_blank">**موصلات البيانات**</a>.

2. في صفحة **موصلات البيانات**، انقر فوق **الموارد البشرية (معاينة).**

3. في صفحة **الموارد البشرية (معاينة)،** انقر فوق **"إضافة موصل**".

4. في صفحة **إعداد الاتصال** ، قم بما يلي ثم انقر فوق **"التالي**":

   1. اكتب معرف تطبيق Azure AD أو الصقه لتطبيق Azure الذي أنشأته في الخطوة 2.

   2. اكتب اسما لموصل الموارد البشرية.

5. في صفحة سيناريوهات الموارد البشرية، حدد سيناريو موارد بشرية واحد أو أكثر تريد استيراد البيانات له ثم انقر فوق **"التالي**".

   ![حدد سيناريو موارد بشرية واحد أو أكثر.](../media/HRConnectorScenarios.png)

6. في صفحة أسلوب تعيين الملفات، حدد نوع ملف إذا لزم الأمر، ثم حدد أحد الخيارات التالية ثم انقر فوق **"التالي**".

   - **Upload ملف عينة**. إذا حددت هذا الخيار، فانقر فوق **Upload نموذج الملف** لتحميل ملف CSV الذي قمت بإعداده في الخطوة 1. يسمح لك هذا الخيار بتحديد أسماء الأعمدة بسرعة في ملف CSV من قائمة منسدلة لتعيينها إلى أنواع البيانات لسيناريوهات الموارد البشرية التي حددتها مسبقا.

   او

   - **توفير تفاصيل التعيين يدويا**. إذا حددت هذا الخيار، يجب كتابة اسم الأعمدة في ملف CSV لتعيينها إلى أنواع البيانات لسيناريوهات الموارد البشرية التي حددتها مسبقا.

7. في صفحة تفاصيل تعيين الملف، قم بأحد الإجراءات التالية، اعتمادا على ما إذا قمت بتحميل نموذج ملف CSV وما إذا كنت تقوم بتكوين الموصل لسيناريو موارد بشرية واحد أو لسيناريوهات متعددة. إذا قمت بتحميل نموذج ملف، فلن تحتاج إلى كتابة أسماء الأعمدة. يمكنك اختيارها من قائمة منسدلة.

    - إذا قمت بتحديد سيناريو موارد بشرية واحد في الخطوة السابقة، فاكتب أسماء رؤوس الأعمدة (تسمى أيضا *معلمات*) من ملف CSV الذي قمت بإنشائه في الخطوة 1 في كل مربع من المربعات المناسبة. أسماء الأعمدة التي تكتبها ليست حساسة لحالة الأحرف، ولكن تأكد من تضمين مسافات إذا كانت أسماء الأعمدة في ملف CSV تتضمن مسافات. كما هو موضح سابقا، يجب أن تتطابق الأسماء التي تكتبها في هذه المربعات مع أسماء المعلمات في ملف CSV. على سبيل المثال، تظهر لقطة الشاشة التالية أسماء المعلمات من نموذج ملف CSV لسيناريو الموارد البشرية للموظف الذي يظهر في الخطوة 1.

    - إذا قمت بتحديد أنواع بيانات متعددة في الخطوة أعلاه، فستحتاج إلى إدخال اسم عمود المعرف الذي سيحدد نوع بيانات الموارد البشرية في ملف CSV. بعد إدخال اسم عمود المعرف، اكتب القيمة التي تعرف نوع بيانات الموارد البشرية هذا، واكتب أسماء رؤوس الأعمدة لأنواع البيانات المحددة من ملف (ملفات) CSV التي قمت بإنشائها في الخطوة 1 في كل مربع من المربعات المناسبة لكل نوع بيانات محدد. كما هو موضح سابقا، يجب أن تتطابق الأسماء التي تكتبها في هذه المربعات مع أسماء الأعمدة في ملف CSV.

8. في صفحة **المراجعة** ، راجع الإعدادات ثم انقر فوق **"إنهاء** " لإنشاء الموصل.

   يتم عرض صفحة حالة تؤكد إنشاء الموصل. تحتوي هذه الصفحة على أمرين مهمين تحتاجهما لإكمال الخطوة التالية لتشغيل نموذج البرنامج النصي لتحميل بيانات الموارد البشرية.

   ![مراجعة الصفحة مع معرف المهمة والارتباط إلى github لنموذج البرنامج النصي.](../media/HRConnector_Confirmation.png)

   1. **معرف المهمة.** ستحتاج إلى معرف المهمة هذا لتشغيل البرنامج النصي في الخطوة التالية. يمكنك نسخه من هذه الصفحة أو من صفحة القائمة المنبثقة للموصل.

   2. **ارتباط إلى نموذج البرنامج النصي.** انقر فوق الارتباط **هنا** للانتقال إلى موقع GitHub للوصول إلى نموذج البرنامج النصي (يفتح الارتباط نافذة جديدة). احتفظ بهذه النافذة مفتوحة بحيث يمكنك نسخ البرنامج النصي في الخطوة 4. بدلا من ذلك، يمكنك وضع إشارة مرجعية على الوجهة أو نسخ عنوان URL حتى تتمكن من الوصول إليه مرة أخرى عند تشغيل البرنامج النصي. يتوفر هذا الارتباط أيضا على صفحة القائمة المنبثقة للموصل.

9. انقر فوق **"تم**".

   يتم عرض الموصل الجديد في القائمة على علامة التبويب **"الموصلات** ".

10. انقر فوق موصل الموارد البشرية الذي قمت بإنشائه للتو لعرض صفحة القائمة المنبثقة، والتي تحتوي على خصائص ومعلومات أخرى حول الموصل.

   ![صفحة القائمة المنبثقة لموصل الموارد البشرية الجديد.](../media/HRConnectorWizard7.png)

إذا لم تكن قد فعلت ذلك بالفعل، يمكنك نسخ قيم **معرف تطبيق Azure** **ومعرف مهمة الموصل**. ستحتاج إلى هذه لتشغيل البرنامج النصي في الخطوة التالية. يمكنك أيضا تنزيل البرنامج النصي من صفحة القائمة المنبثقة (أو تنزيله باستخدام الارتباط في الخطوة التالية.)

يمكنك أيضا النقر فوق **"تحرير"** لتغيير معرف تطبيق Azure أو أسماء رؤوس الأعمدة التي قمت بتعريفها في صفحة **تعيين الملف** .

## <a name="step-4-run-the-sample-script-to-upload-your-hr-data"></a>الخطوة 4: تشغيل نموذج البرنامج النصي لتحميل بيانات الموارد البشرية

الخطوة الأخيرة في إعداد موصل الموارد البشرية هي تشغيل نموذج البرنامج النصي الذي سيقوم بتحميل بيانات الموارد البشرية في ملف CSV (الذي قمت بإنشائه في الخطوة 1) إلى سحابة Microsoft. على وجه التحديد، يقوم البرنامج النصي بتحميل البيانات إلى موصل الموارد البشرية. بعد تشغيل البرنامج النصي، يقوم موصل الموارد البشرية الذي قمت بإنشائه في الخطوة 3 باستيراد بيانات الموارد البشرية إلى مؤسسة Microsoft 365 حيث يمكن الوصول إليها بواسطة أدوات التوافق الأخرى، مثل حل إدارة مخاطر Insider. بعد تشغيل البرنامج النصي، ضع في اعتبارك جدولة مهمة لتشغيلها تلقائيا بشكل يومي بحيث يتم تحميل أحدث بيانات إنهاء الموظف إلى سحابة Microsoft. راجع [جدولة البرنامج النصي لتشغيله تلقائيا](#optional-step-6-schedule-the-script-to-run-automatically).

1. انتقل إلى النافذة التي تركتها مفتوحة من الخطوة السابقة للوصول إلى موقع GitHub باستخدام نموذج البرنامج النصي. بدلا من ذلك، افتح الموقع المرجعي أو استخدم عنوان URL الذي نسخته. يمكنك أيضا الوصول إلى البرنامج النصي [هنا](https://github.com/microsoft/m365-compliance-connector-sample-scripts/blob/main/sample_script.ps1).

2. انقر فوق الزر **Raw** لعرض البرنامج النصي في طريقة عرض النص.

3. انسخ كافة الأسطر في نموذج البرنامج النصي ثم احفظها في ملف نصي.

4. تعديل نموذج البرنامج النصي لمؤسستك، إذا لزم الأمر.

5. احفظ الملف النصي كملف برنامج نصي Windows PowerShell باستخدام لاحقة اسم الملف ؛ `.ps1`على سبيل المثال، `HRConnector.ps1`. بدلا من ذلك، يمكنك استخدام اسم الملف GitHub للبرنامج النصي، وهو `upload_termination_records.ps1`.

6. افتح موجه الأوامر على الكمبيوتر المحلي، وانتقل إلى الدليل حيث قمت بحفظ البرنامج النصي.

7. قم بتشغيل الأمر التالي لتحميل بيانات الموارد البشرية في ملف CSV إلى سحابة Microsoft؛ على سبيل المثال:

    ```powershell
    .\HRConnector.ps1 -tenantId <tenantId> -appId <appId>  -appSecret <appSecret>  -jobId <jobId>  -filePath '<filePath>'
    ```

   يصف الجدول التالي المعلمات التي يجب استخدامها مع هذا البرنامج النصي وقيمها المطلوبة. يتم استخدام المعلومات التي حصلت عليها في الخطوات السابقة في قيم هذه المعلمات.

   | المعلمه | الوصف |
   |:-----|:-----|:-----|
   |`tenantId`|هذا هو المعرف الخاص بمؤسستك Microsoft 365 التي حصلت عليها في الخطوة 2. يمكنك أيضا الحصول على معرف المستأجر لمؤسستك على جزء **Overview** في مركز إدارة Azure AD. يتم استخدام هذا لتحديد مؤسستك.|
   |`appId` |هذا هو معرف تطبيق Azure AD للتطبيق الذي أنشأته في Azure AD في الخطوة 2. يستخدم Azure AD هذا للمصادقة عندما يحاول البرنامج النصي الوصول إلى مؤسسة Microsoft 365. | 
   |`appSecret`|هذا هو سر تطبيق Azure AD للتطبيق الذي أنشأته في Azure AD في الخطوة 2. يستخدم هذا أيضا للمصادقة.|
   |`jobId`|هذا هو معرف المهمة لموصل الموارد البشرية الذي قمت بإنشائه في الخطوة 3. يستخدم هذا لربط بيانات الموارد البشرية التي يتم تحميلها إلى سحابة Microsoft بموصل الموارد البشرية.|
   |`filePath`|هذا هو مسار الملف (المخزن على نفس النظام مثل البرنامج النصي) الذي قمت بإنشائه في الخطوة 1. حاول تجنب المسافات في مسار الملف؛ وإلا استخدم علامات اقتباس مفردة.|
   |||

   فيما يلي مثال على بناء الجملة للبرنامج النصي لموصل الموارد البشرية باستخدام القيم الفعلية لكل معلمة:

   ```powershell
    .\HRConnector.ps1 -tenantId d5723623-11cf-4e2e-b5a5-01d1506273g9 -appId 29ee526e-f9a7-4e98-a682-67f41bfd643e -appSecret MNubVGbcQDkGCnn -jobId b8be4a7d-e338-43eb-a69e-c513cd458eba -filePath 'C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv'
    ```

   إذا كان التحميل ناجحا، يعرض البرنامج النصي الرسالة **"Upload Successful**".

   > [!NOTE]
   > إذا كانت لديك مشاكل في تشغيل الأمر السابق بسبب نهج التنفيذ، فراجع ["حول نهج التنفيذ](/powershell/module/microsoft.powershell.core/about/about_execution_policies) " و" [Set-ExecutionPolicy](/powershell/module/microsoft.powershell.security/set-executionpolicy) " للحصول على إرشادات حول تعيين نهج التنفيذ.

## <a name="step-5-monitor-the-hr-connector"></a>الخطوة 5: مراقبة موصل الموارد البشرية

بعد إنشاء موصل الموارد البشرية وتشغيل البرنامج النصي لتحميل بيانات الموارد البشرية، يمكنك عرض الموصل وتحميل الحالة في مدخل التوافق. إذا قمت بجدولة البرنامج النصي لتشغيله تلقائيا بشكل منتظم، يمكنك أيضا عرض الحالة الحالية بعد المرة الأخيرة التي تم فيها تشغيل البرنامج النصي.

1. انتقل إلى مدخل التوافق، وحدد <a href="https://go.microsoft.com/fwlink/p/?linkid=2173865" target="_blank">**موصلات البيانات**</a>.

2. انقر فوق علامة التبويب **"الموصلات** "، ثم حدد موصل الموارد البشرية لعرض صفحة القائمة المنبثقة. تحتوي هذه الصفحة على الخصائص والمعلومات حول الموصل.

   ![صفحة القائمة المنبثقة لموصل الموارد البشرية مع الخصائص والحالة.](../media/HRConnectorFlyout1.png)

3. ضمن **التقدم**، انقر فوق ارتباط **سجل التنزيل** لفتح (أو حفظ) سجل الحالة للموصل. يحتوي هذا السجل على معلومات حول كل مرة يتم فيها تشغيل البرنامج النصي وتحميل البيانات من ملف CSV إلى سحابة Microsoft. 

   ![يعرض ملف سجل موصل الموارد البشرية صفوف الأرقام من ملف CSV الذي تم تحميله.](../media/HRConnectorLogFile.png)

   `RecordsSaved` يشير الحقل إلى عدد الصفوف في ملف CSV الذي تم تحميله. على سبيل المثال، إذا كان ملف CSV يحتوي على أربعة صفوف، فإن قيمة `RecordsSaved` الحقول هي 4، إذا نجح البرنامج النصي في تحميل كافة الصفوف في ملف CSV.

إذا لم تكن قد قمت بتشغيل البرنامج النصي في الخطوة 4، يتم عرض ارتباط لتنزيل البرنامج النصي ضمن **الاستيراد الأخير**. يمكنك تنزيل البرنامج النصي ثم اتباع الخطوات لتشغيل البرنامج النصي.

## <a name="optional-step-6-schedule-the-script-to-run-automatically"></a>(اختياري) الخطوة 6: جدولة البرنامج النصي لتشغيله تلقائيا

للتأكد من توفر أحدث بيانات الموارد البشرية من مؤسستك لأدوات مثل حل إدارة المخاطر من الداخل، نوصي بجدولة البرنامج النصي للتشغيل تلقائيا على أساس متكرر، مثل مرة واحدة في اليوم. يتطلب هذا أيضا تحديث بيانات الموارد البشرية في ملف CSV على جدول مماثل (إن لم يكن نفسه) بحيث يحتوي على أحدث المعلومات حول الموظفين الذين يغادرون مؤسستك. الهدف هو تحميل أحدث بيانات الموارد البشرية بحيث يمكن لموصل الموارد البشرية إتاحتها لحل إدارة المخاطر الداخلية.

يمكنك استخدام تطبيق Task Scheduler في Windows لتشغيل البرنامج النصي تلقائيا كل يوم.

1. على الكمبيوتر المحلي، انقر فوق الزر "Windows **ابدأ**" ثم اكتب **"جدولة المهام**".

2. انقر فوق تطبيق **"جدولة المهام"** لفتحه.

3. في المقطع **"إجراءات"** ، انقر فوق **"إنشاء مهمة**".

4. في علامة التبويب **"عام** "، اكتب اسما وصفيا للمهمة المجدولة؛ على سبيل المثال، **برنامج HR Connector Script**. يمكنك أيضا إضافة وصف اختياري.

5. ضمن **خيارات الأمان**، قم بما يلي:

   1. حدد ما إذا كنت تريد تشغيل البرنامج النصي فقط عند تسجيل الدخول إلى الكمبيوتر أو تشغيله عند تسجيل الدخول أم لا.

   1. تأكد من تحديد **خانة الاختيار "تشغيل مع أعلى الامتيازات** ".

6. حدد علامة التبويب **"مشغلات** "، وانقر فوق **"جديد**"، ثم قم بالأشياء التالية:

   1. ضمن **الإعدادات**، حدد الخيار **"يوميا**"، ثم اختر تاريخا ووقتا لتشغيل البرنامج النصي للمرة الأولى. سيتم تشغيل البرنامج النصي كل يوم في نفس الوقت المحدد.

   1. ضمن **الإعدادات المتقدمة**، تأكد من تحديد خانة الاختيار **الممكنة** .

   1. انقر فوق **"موافق**".

7. حدد علامة التبويب **"إجراءات** "، وانقر فوق **"جديد**"، ثم قم بما يلي:

   ![إعدادات الإجراء لإنشاء مهمة مجدولة جديدة للبرنامج النصي لموصل الموارد البشرية.](../media/HRConnectorScheduleTask1.png)

   1. في القائمة المنسدلة **"إجراء** "، تأكد من تحديد **بدء برنامج** .

   1. في مربع **البرنامج/البرنامج النصي** ، انقر فوق **"استعراض**"، وانتقل إلى الموقع التالي وحدده بحيث يتم عرض المسار في المربع: `C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe`.

   1. في المربع **إضافة وسيطات (اختياري)،** الصق الأمر نفسه للبرنامج النصي الذي قمت بتشغيله في الخطوة 4. على سبيل المثال `.\HRConnector.ps1 -tenantId "d5723623-11cf-4e2e-b5a5-01d1506273g9" -appId "c12823b7-b55a-4989-faba-02de41bb97c3" -appSecret "MNubVGbcQDkGCnn"  -jobId "e081f4f4-3831-48d6-7bb3-fcfab1581458" -filePath "C:\Users\contosoadmin\Desktop\Data\employee_termination_data.csv"`

   1. في مربع **البدء في (اختياري)،** الصق موقع مجلد البرنامج النصي الذي قمت بتشغيله في الخطوة 4. على سبيل المثال، `C:\Users\contosoadmin\Desktop\Scripts`.

   1. انقر فوق **"موافق** " لحفظ إعدادات الإجراء الجديد.

8. في النافذة **"إنشاء مهمة** "، انقر فوق **"موافق** " لحفظ المهمة المجدولة. قد تتم مطالبتك بإدخال بيانات اعتماد حساب المستخدم.

   يتم عرض المهمة الجديدة في مكتبة جدولة المهام.

   ![يتم عرض المهمة الجديدة في مكتبة جدولة المهام.](../media/HRConnectorTaskSchedulerLibrary.png)

   في المرة الأخيرة التي تم فيها تشغيل البرنامج النصي وفي المرة التالية التي يتم فيها جدولته للتشغيل يتم عرضه. يمكنك النقر نقرا مزدوجا فوق المهمة لتحريرها.

   يمكنك أيضا التحقق من آخر مرة تم فيها تشغيل البرنامج النصي على صفحة القائمة المنبثقة لموصل الموارد البشرية المطابق في مركز التوافق.

## <a name="existing-hr-connectors"></a>موصلات الموارد البشرية الموجودة

في 13 ديسمبر 2021، أصدرنا سيناريو بيانات ملف تعريف الموظفين لموصلات الموارد البشرية. إذا قمت بإنشاء موصل الموارد البشرية قبل هذا التاريخ، فسنرحل المثيلات الحالية أو موصلات الموارد البشرية الخاصة بمؤسستك حتى يستمر استيراد بيانات الموارد البشرية إلى سحابة Microsoft. لا يتعين عليك القيام بأي شيء للحفاظ على هذه الوظيفة. يمكنك الاستمرار في استخدام هذه الموصلات دون انقطاع.

إذا كنت ترغب في تنفيذ سيناريو بيانات ملف تعريف الموظف، يمكنك إنشاء موصل موارد بشرية جديد وتكوينه كما هو مطلوب. بعد إنشاء موصل موارد بشرية جديد، قم بتشغيل البرنامج النصي باستخدام معرف المهمة للموصل الجديد وملفات CSV مع [بيانات ملف تعريف الموظفين](#csv-file-for-employee-profile-data-preview) الموضحة مسبقا في هذه المقالة.
