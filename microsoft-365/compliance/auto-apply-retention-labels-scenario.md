---
title: استخدم تسميات الاستبقاء لإدارة دورة حياة المستندات المخزنة في SharePoint
f1.keywords:
- NOCSH
ms.author: cabailey
author: cabailey
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
ms.localizationpriority: high
ms.collection:
- M365-security-compliance
- SPO_Content
ms.custom:
- admindeeplinkCOMPLIANCE
- admindeeplinkSPO
search.appverid:
- MOE150
- MET150
description: كيف يمكنك استخدام تسميات الاستبقاء لإدارة دورة حياة المستندات في SharePoint باستخدام بيانات التعريف لتصنيف المحتوى وتطبيق التسميات تلقائيا واستخدام الاستبقاء المستند إلى الحدث لبدء فترة الاستبقاء.
ms.openlocfilehash: 35c43a96e07fe52d9e5e0cc0a72195353b6f5da6
ms.sourcegitcommit: bdd6ffc6ebe4e6cb212ab22793d9513dae6d798c
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 03/08/2022
ms.locfileid: "63565951"
---
# <a name="use-retention-labels-to-manage-the-lifecycle-of-documents-stored-in-sharepoint"></a>استخدم تسميات الاستبقاء لإدارة دورة حياة المستندات المخزنة في SharePoint

>*[Microsoft 365 إرشادات الترخيص لتوافق & الأمان](/office365/servicedescriptions/microsoft-365-service-descriptions/microsoft-365-tenantlevel-services-licensing-guidance/microsoft-365-security-compliance-licensing-guidance).*

تصف هذه المقالة كيفية إدارة دورة حياة المستندات المخزنة في SharePoint باستخدام تسميات الاستبقاء المطبقة تلقائيا والاستبقاء المستند إلى الأحداث.

تستخدم وظيفة التطبيق التلقائي بيانات SharePoint التعريف لتصنيف المستند. المثال في هذه المقالة هو للمستندات ذات الصلة بالمنتج، ولكن يمكن استخدام المفاهيم نفسها لسيناريوهات أخرى. على سبيل المثال، في مجال صناعة حقول الطاقة والغاز، يمكنك استخدامها لإدارة دورة حياة المستندات حول الأصول المادية مثل الأنظمة الأساسية لزيت أو سجلات التراخيص أو تراخيص الإنتاج. في مجال الخدمات المالية، يمكنك إدارة مستندات تعاقدات التأمين أو رهن أو حساب بنكي. في القطاع العام، يمكنك إدارة رخص الإنشاء أو النماذج الضريبية.

في هذه المقالة، سننظر في بنية المعلومات وتعريف تسميات الاستبقاء. بعد ذلك، سنقوم بتصنيف المستندات من خلال تطبيق التسميات بشكل تلقائي. وأخيرا، سنقوم بإنشاء الأحداث التي تبدأ فترة الاستبقاء.

## <a name="information-architecture"></a>هندسة المعلومات

السيناريو لدينا هو شركة تصنيع تستخدم SharePoint لتخزين كل المستندات حول المنتجات التي تقوم الشركة بتطويرها. تتضمن هذه المستندات مواصفات المنتج والاتفاقيات مع الموردين ويدويات المستخدمين. عندما يتم تخزين هذه المستندات في SharePoint من خلال سياسات إدارة محتوى المؤسسة، يتم تعريف بيانات تعريف المستند، والتي يتم استخدامها لتصنيفها. يحتوي كل مستند على خصائص بيانات التعريف التالية:

- **نوع المواصفة** (مثل مواصفة المنتج أو الاتفاقية أو دليل المستخدم)

- **اسم المنتج**

- **الحالة** (مسودة أو نهائي)

تشكل بيانات التعريف هذه نوع محتوى أساس يسمى *"مستند الإنتاج* " لكل المستندات.

![جدول بيانات التعريف لوثائق المنتج.](../media/SPRetention1.png)

> [!NOTE]
> تستخدم **خصائص نوع الملصق** الحالة ونوعه بواسطة سياسات الاستبقاء لاحقا في هذا السيناريو لتصنيف تسميات الاستبقاء وتطبيقها بشكل تلقائي.

قد يكون لدينا العديد من أنواع المحتويات التي تمثل أنواعا مختلفة من المستندات، ولكن دعنا نركز على وثائق المنتج.

في هذا السيناريو، نستخدم خدمة بيانات التعريف المدارة ومخزن المصطلحات لإنشاء مجموعة مصطلحات لنوع المستند وآخر  *لاسم المنتج*. لكل مجموعة مصطلحات، نقوم بإنشاء مصطلح لكل قيمة. قد يبدو مثل هذا في مخزن المصطلحات SharePoint مؤسستك:

![مجموعة مصطلحات نموذجية لوثائق المنتجات في مخزن المصطلحات.](../media/SPRetention2.png)

*يمكن إنشاء* نوع المحتوى ونشره باستخدام مركز [نوع المحتوى](https://support.office.com/article/manage-content-type-publishing-06f39ac0-5576-4b68-abbc-82b68334889b). يمكنك أيضا إنشاء نوع محتوى ونشره باستخدام أدوات توفير الموقع، مثل إطار [عمل توفير PnP](/sharepoint/dev/solution-guidance/pnp-provisioning-framework) أو مخطط [تصميم الموقع JSON](/sharepoint/dev/declarative-customization/site-design-json-schema#define-a-new-content-type).

يحتوي كل منتج على موقع SharePoint يحتوي على مكتبة مستندات واحدة تم تمكين أنواع المحتويات المناسبة لها. يتم تخزين كل المستندات في مكتبة المستندات هذه.

[![مكتبة المستندات لوثائق المنتج.](../media/SPRetention3.png) ](../media/SPRetention3.png#lightbox)

> [!NOTE]
> بدلا من امتلاك موقع SharePoint لكل منتج، يمكن لشركة التصنيع في هذا السيناريو استخدام Microsoft Team لكل منتج لدعم التعاون بين أعضاء الفريق، مثل الدردشة الثابتة، واستخدام علامة التبويب ملفات في Teams لإدارة المستندات. في هذه المقالة، نركز فقط على المستندات، لذا سنستخدم الموقع فقط.

فيما يلي طريقة عرض لمكتبة المستندات لمنتج 'عنصر واجهة المستخدم الدوار':

[![مكتبة مستندات 'عنصر واجهة مستخدم دوان'.](../media/SPRetention4.png) ](../media/SPRetention4.png#lightbox)

الآن وقد أصبح لدينا بنية المعلومات الأساسية لإدارة المستندات، دعنا نطلع على استراتيجية الاستبقاء والتخلص للمستندات التي تستخدم بيانات التعريف وكيفية تصنيف هذه المستندات.

## <a name="retention-and-disposition"></a>الاستبقاء والتصرف

تملي سياسات التوافق وإدارة البيانات الخاصة بالشركة المصنعة كيفية الاحتفاظ بالبيانات والتخلص منها. يجب الاحتفاظ بالمستندات ذات الصلة بالمنتج طالما تم تصنيع المنتج ولفترة إضافية معينة. تختلف الفترة الإضافية لمواصفات المنتج والاتفاقيات ويدويات المستخدمين. يشير الجدول التالي إلى متطلبات الاستبقاء والتصرف:

|   نوع المستند            |   استبقاء                            |   الترتيب                                |
| -------------------------- | -------------------------------------- | -------------------------------------------- |
| مواصفات المنتج      | 5 سنوات بعد توقف الإنتاج  | حذف                                       |
| اتفاقيات المنتجات          | 10 سنوات بعد توقف الإنتاج | مراجعة                                       |
| كتيبات المستخدمين                | 5 سنوات بعد توقف الإنتاج  | حذف                                       |
| كل أنواع المستندات الأخرى | عدم الاحتفاظ بشكل نشط  | الحذف عندما يكون المستند أقدم من 3 سنوات <br /><br /> يعتبر المستند أقدم من 3 سنوات إذا لم يتم تعديله خلال آخر 3 سنوات. |
|||

نستخدم مركز التوافق في Microsoft 365 لإنشاء تسميات [الاستبقاء التالية](retention.md#retention-labels):

  - مواصفات المنتج

  - اتفاقية المنتج

  - دليل المستخدم

في هذه المقالة، نعرض فقط كيفية إنشاء تسمية استبقاء مواصفات المنتج وتطبيقها بشكل تلقائي. لتنفيذ السيناريو الكامل، يمكنك أيضا إنشاء تسميات استبقاء لتطبيقها بشكل تلقائي على نوعي المستندات الآخرين.

### <a name="settings-for-the-product-specification-retention-label"></a>الإعدادات تسمية استبقاء "مواصفات المنتج"

فيما يلي خطة [الملف لتسمية](file-plan-manager.md) استبقاء مواصفات المنتج:

- **الاسم:** مواصفات المنتج

- **وصف للمستخدمين:** الاحتفاظ لمدة 5 سنوات بعد توقف الإنتاج.

- **وصف للمسؤولين:** استبقاء لمدة 5 سنوات بعد توقف الإنتاج والحذف التلقائي والاستبقاء المستند إلى الحدث ونوع الحدث هو *توقف المنتج*.

- **إجراء الاستبقاء:** الاحتفاظ والحذف.

- **مدة الاستبقاء:** 5 سنوات (1825 يوما).

- **تسمية السجل**: قم بتكوين تسمية الاستبقاء بحيث يتم وضع [](records-management.md#records)علامة على العناصر كسجل، مما يعني أنه لا يمكن بعد ذلك تعديل المستندات الملصقات أو حذفها من قبل المستخدمين.

- **واصفات خطة الملف:** لتبسيط السيناريو، لا يتم توفير واصفات ملفات اختيارية.

تعرض لقطة الشاشة التالية الإعدادات عند إنشاء تسمية استبقاء مواصفات المنتج في مركز التوافق في Microsoft 365. يمكنك إنشاء نوع الحدث *توقف* المنتج عند إنشاء تسمية الاستبقاء. راجع الإجراء في المقطع التالي.

![إعدادات الاستبقاء لتسمية "مواصفات المنتج".](../media/SPRetention5.png)

> [!NOTE]
> لتجنب الانتظار لمدة 5 سنوات لحذف المستند، قم بتعيين مدة الاستبقاء إلى ***يوم*** واحد إذا كنت تعيد إنشاء هذا السيناريو في بيئة اختبار.

### <a name="create-an-event-type-when-you-create-a-retention-label"></a>إنشاء نوع حدث عند إنشاء تسمية استبقاء

1. في الصفحة **تعريف إعدادات الاستبقاء** من معالج إنشاء تسمية استبقاء، بعد بدء فترة الاستبقاء استنادا إلى، حدد **إنشاء نوع حدث جديد**:

    ![إنشاء نوع حدث جديد لمربع الحوار تسمية مواصفات المنتج.](../media/SPRetention6.png)

3. في الصفحة **تسمية نوع الحدث** ، أدخل **توقف المنتج** ووصفا اختياريا. ثم حدد **التالي****، إرسال****، تم**.

4. مرة أخرى في **الصفحة تعريف إعدادات** الاستبقاء، بالنسبة لبدء فترة الاستبقاء استنادا إلى، استخدم مربع القائمة المنسدلة لتحديد نوع الحدث **توقف** المنتج الذي أنشأته.

    فيما يلي شكل الإعدادات لتسمية استبقاء مواصفات المنتج:

   ![الإعدادات لتسمية "مواصفات المنتج" الجديدة.](../media/SPRetention7.png)

6. حدد **إنشاء تسمية**، وفي الصفحة التالية عندما ترى خيارات نشر التسمية، أو تطبيق التسمية بشكل تلقائي، أو حفظ التسمية فقط: حدد حفظ التسمية فقط في الوقت الحالي، ثم حدد **تم**.

    > [!TIP]
    > للحصول على خطوات أكثر تفصيلا، راجع [إنشاء تسمية تستند فترة استبقاءها إلى حدث](event-driven-retention.md#step-1-create-a-label-whose-retention-period-is-based-on-an-event).

دعنا نطلع الآن على كيفية تطبيق تسمية الاستبقاء على محتوى مواصفات المنتج.

## <a name="auto-apply-retention-labels-to-documents"></a>تطبيق تسميات الاستبقاء على المستندات

سنستخدم لغة استعلام الكلمة الأساسية (KQL) لتطبيق تسميات [](apply-retention-labels-automatically.md) الاستبقاء التي أنشأناها بشكل تلقائي. KQL هي اللغة المستخدمة لإنشاء استعلامات البحث. في KQL، يمكنك البحث باستخدام الكلمات الأساسية أو الخصائص المدارة. لمزيد من المعلومات، راجع مرجع بناء جملة لغة [استعلام الكلمة الأساسية (KQL](/sharepoint/dev/general-development/keyword-query-language-kql-syntax-reference)).

بشكل أساسي، نريد Microsoft 365 "تطبيق تسمية استبقاء مواصفات المنتج على كل  المستندات التي لها الحالة "نهائي" و"نوع المستند  **لمواصفات المنتج**".  تذكر أن **الحالة** **ونوع المستند** من أعمدة الموقع التي قمنا بتعريفها لنوع محتوى وثائق المنتج في [المقطع هندسة](#information-architecture) المعلومات. للقيام بذلك، نحتاج إلى تكوين مخطط البحث.

عند SharePoint المحتوى، فإنه ينشئ تلقائيا خصائص تم تتبع ارتباطاتها لكل عمود موقع. بالنسبة إلى هذا السيناريو، يهمنا خصائص نوع "الموضع" و **"الحالة".**  نحتاج إلى مستندات في المكتبة التي تكون من نوع المحتوى الصحيح وتملأ أعمدة الموقع للبحث عنها لإنشاء الخصائص التي تم تتبع ارتباطاتها.

في مركز <a href="https://go.microsoft.com/fwlink/?linkid=2185219" target="_blank">SharePoint،</a> افتح تكوين البحث، وحدد إدارة **مخطط** البحث لعرض الخصائص التي تم تتبع ارتباطاتها وتكوينها.

![الخصائص التي تم تتبع ارتباطاتها في مخطط البحث.](../media/SPRetention8.png)

إذا قمنا بكتبة ***status** _ في المربع _ *Crawled properties** وحددنا السهم الأخضر، يجب أن نشاهد نتيجة مثل هذه:

![الخاصية ows_Status تتبع ارتباطاتها.](../media/SPRetention9.png)

إن **خاصية owsStatus\_\_** (لاحظ أن أسفلها المزدوج) هي الخاصية التي يهمنا. يتم الخرائط إلى **الخاصية الحالة** لنوع محتوى مستند الإنتاج.

الآن، إذا قمنا ***بكاتب owsdoc\_*** وحددنا السهم الأخضر، يجب أن نرى شيئا مثل هذا:

![الخاصية ows_Doc_Type تتبع ارتباطاتها.](../media/SPRetention10.png)

خاصية **owsDocx0020Type\_\_\_** هي الخاصية الثانية التي يهمنا. وهي تقوم بالخرائط إلى **الخاصية نوع المستند** لنوع محتوى مستند الإنتاج.

> [!TIP]
> لتحديد اسم خاصية تم تتبع ارتباطاتها لهذا السيناريو، انتقل إلى مكتبة المستندات التي تحتوي على مستندات الإنتاج. ثم انتقل إلى إعدادات المكتبة. بالنسبة **إلى الأعمدة**، حدد اسم العمود (على سبيل المثال، الحالة  أو نوع **الموضع) لفتح** صفحة عمود الموقع. تحتوي *معلمة* الحقل في عنوان URL لهذه الصفحة على اسم الحقل. اسم الحقل هذا، الملباد ows_"، هو اسم الخاصية التي تم تتبع ارتباطاتها. على سبيل المثال، يتطابق عنوان URL `https://tenantname.sharepoint.com/sites/SpinningWidget/_layouts/15/FldEdit.aspx?List=%7BC38C2F45-3BD6-4C3B-AA3B-EF5DF6B3D172%7D&Field=_Status` مع *الخاصية owsStatus\_\_ التي تم تتبع ارتباطاتها* .

إذا لم تظهر الخصائص التي تم تتبع ارتباطاتها التي تبحث عنها في المقطع إدارة مخطط البحث في SharePoint مركز الإدارة:

- ربما لم يتم فهرسة المستندات. يمكنك فرض رنين  >  المكتبة عن طريق الذهاب إلى إعدادات مكتبة **المستنداتadvanced الإعدادات**.

- إذا كانت مكتبة المستندات في موقع حديث، فتأكد من أن SharePoint مسؤول مجموعة المواقع.

لمزيد من المعلومات حول الخصائص التي تم تتبع ارتباطاتها وإدارتها، راجع الخصائص المدارة التي تم [إنشاؤها تلقائيا في SharePoint Server](/sharepoint/technical-reference/automatically-created-managed-properties-in-sharepoint).

### <a name="map-crawled-properties-to-pre-defined-managed-properties"></a>تعيين الخصائص التي تم تتبع ارتباطاتها إلى الخصائص المدارة المعرفة مسبقا

لا يمكن ل KQL استخدام الخصائص التي تم تتبع ارتباطاتها في استعلامات البحث. يجب أن يستخدم خاصية مدارة. في سيناريو البحث النموذجي، نقوم بإنشاء خاصية مدارة و تعيينها إلى الخاصية التي تم تتبع ارتباطاتها التي نحتاج إليها. ومع ذلك، لتطبيق تسميات الاستبقاء بشكل تلقائي، يمكنك فقط تحديد الخصائص المدارة المعرفة مسبقا في KQL، وليس الخصائص المدارة المخصصة. هناك مجموعة من الخصائص المدارة المحددة مسبقا في نظام سلسلة *RefinableString00* إلى *RefinableString199* يمكنك استخدامها. للحصول على قائمة كاملة، راجع [الخصائص المدارة الافتراضية غير المدارة](/sharepoint/manage-search-schema#default-unused-managed-properties). تستخدم هذه الخصائص المدارة الافتراضية عادة لتعريف مصافي البحث.

لكي يقوم استعلام KQL بتطبيق تسمية الاستبقاء الصحيحة تلقائيا على محتوى مستند المنتج، نقوم برسم خريطة للخصائص التي تم تتبع ارتباطها **owsDocx0020Type\_\_\_* *وowsStatus\_\_** إلى خصائص مدارة قابلة لإعادة التعريف. في بيئة الاختبار لهذا السيناريو، لا يتم استخدام **RefinableString00** و **RefinableString01** . لقد حددنا ذلك من خلال النظر إلى الخصائص **المدارة** في **إدارة مخطط البحث** في <a href="https://go.microsoft.com/fwlink/?linkid=2185219" target="_blank">SharePoint الإدارة</a>.

[![الخصائص المدارة في مخطط البحث.](../media/SPRetention12.png) ](../media/SPRetention12.png#lightbox)

لاحظ أن **العمود خصائص تم تعيينها تم تتبع** ارتباطاتها في لقطة الشاشة السابقة فارغ.

لخريطة **الخاصية owsDocx0020Type\_\_\_** التي تم تتبع ارتباطها، اتبع الخطوات التالية:

1. في المربع **تصفية الخاصية** المدارة، اكتب **_RefinableString00_** وحدد السهم الأخضر.

2. في قائمة النتائج، حدد الارتباط **RefinableString00** ، ثم قم بالتمرير لأسفل وصولا إلى المقطع تعيينات إلى خصائص تم **تتبع** ارتباطاتها.

3. حدد **إضافة تعيين**، ثم اكتب **_owsDocx0020Type\_\_\__*_ في المربع _* Search for a crawled property name** in the **Crawled property selection** window. حدد **البحث**.

4. في قائمة النتائج، حدد **owsDocx0020Type\_\_\_** ثم حدد **موافق**.

   في المقطع **خصائص تم تعيينها تم تتبع** ارتباطاتها، يجب أن ترى شيئا مماثلا لشاشة الشاشة هذه:

   [![حدد إضافة تعيين في المقطع خصائص تم تعيينها تم تتبع ارتباطاتها.](../media/SPRetention13.png) ](../media/SPRetention13.png#lightbox)


5. قم بالتمرير إلى أسفل الصفحة وحدد **موافق** لحفظ التعيين.

كرر هذه الخطوات ل **تعيين RefinableString01** **وowsStatus\_\_**.

يجب أن يكون لديك الآن خصائص مدارة تم تعيينها إلى الخصائص التي تم تتبع ارتباطاتها:

[![الخصائص المدارة التي يتم تعيينها إلى الخصائص التي تم تتبع ارتباطاتها.](../media/SPRetention14.png) ](../media/SPRetention14.png#lightbox)

دعنا نتحقق من صحة الإعداد من خلال تشغيل بحث المؤسسة. في المستعرض، انتقل إلى https://*\<your_tenant>.sharepoint.com/search*. في مربع البحث، اكتب ***RefinableString00:"مواصفات المنتج"** _ واضغط على Enter. يجب أن تقوم عملية البحث هذه بإرجاع كل المستندات التي لها _ *Product Specification** من **_نوع المستند_**.

الآن في مربع البحث، اكتب **RefinableString00:"مواصفات المنتج" و RefinableString01:Final** واضغط على Enter. يجب أن يتم إرجاع كل المستندات **التي لها مواصفات** المنتج **_من Doc Type_*_ و_* Status** of **_Final_**.

### <a name="create-auto-apply-label-policies"></a>إنشاء تطبيق تلقائي لنهج التسميات

الآن وقد تحققنا من عمل استعلام KQL، دعنا ننشئ نهج تسمية تطبيق تلقائي يستخدم استعلام KQL لتطبيق تسمية استبقاء مواصفات المنتج تلقائيا على المستندات المناسبة.

1. في <a href="https://go.microsoft.com/fwlink/p/?linkid=2077149" target="_blank">مركز التوافق في Microsoft 365،</a> انتقل إلى **إدارة** **السجلاتنهجLabelsAuto-apply** >  >  **a label**.

   [![حدد "تطبيق تسمية تلقائي" على صفحة "التسميات"](../media/SPRetention16.png) ](../media/SPRetention16.png#lightbox)

2. في معالج إنشاء نهج التسمية التلقائية، في صفحة تسمية  نهج التسمية التلقائية، أدخل اسما مثل تسمية تطبيق مواصفات المنتج التلقائي ووصفا اختياريا. ثم حدد **التالي**.

3. في الصفحة **اختيار** نوع المحتوى الذي تريد تطبيق هذه التسمية عليه، حدد تطبيق تسمية على المحتوى الذي يحتوي على كلمات أو عبارات أو **خصائص** معينة، ثم حدد **التالي**.

   [![حدد تطبيق التسمية على المحتوى الذي يحتوي على كلمات أو عبارات أو خصائص معينة.](../media/SPRetention17.png) ](../media/SPRetention17.png#lightbox)

   يتيح لنا هذا الخيار توفير استعلام بحث KQL نفسه الذي اختبرناه في القسم السابق. يرجع الاستعلام كل مستندات "مواصفات المنتج" التي لها حالة *"نهائي*". عندما نستخدم هذا الاستعلام نفسه في نهج تسمية التطبيق التلقائي، سيتم تطبيق تسمية استبقاء مواصفات المنتج تلقائيا على كل المستندات التي تتطابق مع ذلك.

4. في صفحة **تطبيق التسمية** على المحتوى المطابق لهذا الاستعلام، اكتب **RefinableString00:"مواصفات المنتج" و RefinableString01:Final**، ثم حدد **التالي**.

   ![حدد الاستعلام في مربع محرر استعلام الكلمة الأساسية.](../media/SPRetention19.png)

5. في **الصفحة اختيار مواقع لتطبيق النهج** ، حدد مواقع المحتوى التي تريد تطبيق النهج عليها. بالنسبة إلى هذا السيناريو، نقوم بتطبيق النهج SharePoint المواقع فقط، لأن كل مستندات الإنتاج مخزنة في مكتبات SharePoint المستندات. تبديل حالة البريد الإلكتروني Exchange **الإلكتروني** OneDrive **الحسابات** Microsoft 365 **المجموعات إلى** **إيقاف التشغيل**. تأكد من تعيين حالة المواقع SharePoint إلى **"على**" قبل تحديد **"التالي"**:

    ![اختر مواقع معينة لتطبيق التسميات عليها.](../media/SPRetentionSPlocations.png)

   > [!TIP]
   > بدلا من تطبيق النهج على SharePoint المواقع، يمكنك تحديد اختيار موقع وإضافة عناوين URL لمواقع  SharePoint معينة.

6. في **الصفحة اختيار تسمية لتطبيقها** التلقائي، حدد **إضافة تسمية**.

7. من قائمة تسميات الاستبقاء، حدد **مواصفات المنتج**. ثم حدد **إضافة** وت **التالي**.

8. مراجعة الإعدادات:

    ![الإعدادات لتطبيق التسمية.](../media/SPRetention18.png)

9. حدد **إرسال** لإنشاء نهج تسمية التطبيق التلقائي.

   > [!NOTE]
   > يستغرق تطبيق تسمية "مواصفات المنتج" تلقائيا على كل المستندات التي تتطابق مع استعلام بحث KQL ما يصل إلى 7 أيام.

### <a name="verify-that-the-retention-label-was-automatically-applied"></a>التحقق من تطبيق تسمية الاستبقاء تلقائيا

بعد مرور 7 أيام، استخدم [](data-classification-activity-explorer.md) مستكشف النشاط في مركز التوافق للتحقق من أن نهج التسمية الذي أنشأناه قد طبق تلقائيا تسميات الاستبقاء على مستندات المنتج.

انظر أيضا إلى خصائص المستندات في مكتبة المستندات. في لوحة المعلومات، يمكنك رؤية تطبيق تسمية الاستبقاء على مستند محدد.

[![تحقق من تطبيق هذه التسمية بالنظر إلى خصائص المستند في مكتبة المستندات.](../media/SPRetention21.png) ](../media/SPRetention21.png#lightbox)

نظرا لأنه تم تطبيق تسميات الاستبقاء تلقائيا على المستندات، فإن هذه المستندات محمية من الحذف لأنه تم تكوين تسمية الاستبقاء لإعلان المستندات *كسجلات*. كمثال على هذه الحماية، تظهر رسالة الخطأ التالية عندما نحاول حذف أحد هذه المستندات:

[![تظهر رسالة خطأ أنه لا يمكن حذف المستندات لأن التسمية تعلن أن المستندات هي سجلات.](../media/SPRetention22.png) ](../media/SPRetention22.png#lightbox)

## <a name="generate-the-event-that-triggers-the-retention-period"></a>إنشاء الحدث الذي يقوم بتشغيل فترة الاستبقاء

الآن وقد تم تطبيق تسميات الاستبقاء، دعنا نركز على الحدث الذي سيشير إلى نهاية إنتاج منتج معين. يؤدي هذا الحدث إلى تشغيل بداية فترة الاستبقاء المعرفة في تسميات الاستبقاء. على سبيل المثال، بالنسبة لمستندات مواصفات المنتج، تبدأ فترة الاستبقاء لمدة 5 سنوات عند تشغيل حدث "نهاية الإنتاج".

يمكنك إنشاء الحدث يدويا في مركز التوافق في Microsoft 365 من خلال الذهاب إلى **إدارة** **السجلاتEvents** > . يمكنك اختيار نوع الحدث، ثم تعيين "معرّف الأصول" الصحيح، ثم إدخال تاريخ للحدث. لمزيد من المعلومات، راجع [بدء الاستبقاء عند وقوع حدث](event-driven-retention.md).

ولكن في هذا السيناريو، سنقوم تلقائيا بإنشاء الحدث من نظام إنتاج خارجي. النظام هو قائمة SharePoint بسيطة تشير إلى ما إذا كان المنتج في الإنتاج أم لا. يؤدي [Power Automate](/power-automate/getting-started) تدفق البيانات المقترن بالقائمة إلى تشغيل الحدث. في سيناريو حقيقي، يمكنك استخدام أنظمة مختلفة لإنشاء الحدث، مثل نظام الموارد البشرية أو إدارة حقوق استخدام المعلومات (CRM). يحتوي Power Automate على العديد من التفاعلات الجاهزة للاستخدام وك كتلة إنشاء لأحمال عمل Microsoft 365، مثل Microsoft Exchange و SharePoint و Teams و Dynamics 365، بالإضافة إلى تطبيقات 365 من جهة خارجية مثل Twitter و Box و Salesforce و Workdays. تجعل هذه الميزة من السهل Power Automate مع الأنظمة المختلفة. لمزيد من المعلومات، راجع أتمتة الاستبقاء الذي [يحركه الحدث](./event-driven-retention.md#automate-events-by-using-a-rest-api).

تعرض لقطة الشاشة التالية SharePoint التي سيتم استخدامها لمشغل الحدث:

[![القائمة التي ستشغل حدث الاستبقاء.](../media/SPRetention23.png) ](../media/SPRetention23.png#lightbox)

يوجد حاليا نوعان من المنتجات قيد الإنتاج، كما هو مشار إليه في العمود ***Yes** _ في العمود _ *In Production** . عندما يتم تعيين القيمة في هذا العمود إلى **_لا_** لمنتج، سينتج تلقائيا التدفق المقترن بالقائمة الحدث. يبدأ الحدث ببدء فترة الاستبقاء لتسمية الاستبقاء التي تم تطبيقها بشكل تلقائي على مستندات المنتج المقابلة.

بالنسبة إلى هذا السيناريو، نستخدم التدفق التالي لتحريك الحدث:

[![تكوين التدفق الذي سيشغل الحدث.](../media/SPRetention24.png) ](../media/SPRetention24.png#lightbox)

لإنشاء هذا التدفق، ابدأ من موصل SharePoint وحدد المشغل عند إنشاء عنصر أو **تعديله**. حدد عنوان الموقع واسم القائمة. بعد ذلك، أضف شرطا استنادا إلى وقت  تعيين قيمة عمود قائمة "في الإنتاج" إلى **_No_* _ (أو تساوي _false* على بطاقة الشرط). بعد ذلك، أضف إجراء استنادا إلى قالب HTTP المضمن. استخدم القيم في المقطع التالي لتكوين إجراء HTTP. يمكنك نسخ قيم خصائص **URI** والنموذج **الأساسية** من المقطع التالي ولصقها في القالب.

- **الأسلوب**: POST
- **URI**: `https://ps.compliance.protection.outlook.com/psws/service.svc/ComplianceRetentionEvent`
- **رؤوس**: Key = Content-Type, Value = application/atom+xml
- **الجسم**:

    ```xml
    <?xml version='1.0' encoding='utf-8' standalone='yes'>
    <entry xmlns:d='http://schemas.microsoft.com/ado/2007/08/dataservices' xmlns:m='http://schemas.microsoft.com/ado/2007/08/dataservices/metadata' xmlns='https://www.w3.org/2005/Atom'>
    <category scheme='http://schemas.microsoft.com/ado/2007/08/dataservices/scheme' term='Exchange.ComplianceRetentionEvent'>
    <updated>9/9/2017 10:50:00 PM</updated>
    <content type='application/xml'>
    <m:properties>
    <d:Name>Cessation Production @{triggerBody()?['Product_x0020_Name']?['Value']}</d:Name>
    <d:EventType>Product Cessation&lt;</d:EventType>
    <d:SharePointAssetIdQuery>ProductName:&quot;@{triggerBody()?['Product_x0020_Name']?['Value']}<d:SharePointAssetIdQuery>
    <d:EventDateTime>@{formatDateTime(utcNow(),'yyyy-MM-dd')}</d:EventDateTime>
    </m:properties>
    </content&gt>
    </entry>
    ```

تصف هذه القائمة المعلمات في الخاصية **Body** لل الإجراء الذي يجب تكوينه لهذا السيناريو:

- **الاسم**: تحدد هذه المعلمة اسم الحدث الذي سيتم إنشاؤه في مركز التوافق في Microsoft 365. في هذا السيناريو، يكون الاسم "إنتاج التوقف *xxx*"، حيث *xxx* هو قيمة الخاصية **المدارة ProductName** التي أنشأناها سابقا.
- **EventType**: تتطابق قيمة هذه المعلمة مع نوع الحدث الذي سيتم تطبيق الحدث الذي تم إنشاؤه عليه. تم تعريف نوع الحدث هذا عند إنشاء تسمية الاستبقاء. بالنسبة لهذا السيناريو، يكون نوع الحدث هو "توقف المنتج".
- **SharePointAssetIdQuery**: تعرف هذه المعلمة "المعرف الأصل" للحدث. يحتاج الاستبقاء المستند إلى الحدث إلى معرف فريد للمستند. يمكننا استخدام "معرفة الأصول" لتحديد المستندات التي ينطبق عليها حدث معين أو، كما هو الحال في هذا السيناريو، عمود بيانات التعريف **اسم المنتج**. للقيام بذلك، نحتاج إلى إنشاء خاصية **مدارة ProductName** جديدة يمكن استخدامها في استعلام KQL. (بدلا من ذلك، يمكننا استخدام **RefinableString00** بدلا من إنشاء خاصية مدارة جديدة). نحتاج أيضا إلى تعيين هذه الخاصية المدارة **الجديدة إلى** الخاصية ows_Product_x0020_Name تتبع ارتباطاتها. إليك لقطة شاشة لهذه الخاصية المدارة.

    [![الخاصية المدارة في Rentention.](../media/SPRetention25.png) ](../media/SPRetention25.png#lightbox)

- **EventDateTime**: تحدد هذه المعلمة تاريخ وقوع الحدث. استخدم تنسيق التاريخ الحالي:<br/><br/>*formatDateTime(utcNow(),'yyyy-MM-dd'*)

### <a name="putting-it-all-together"></a>وضع كل ذلك معا

يتم الآن إنشاء تسمية الاستبقاء وتطبيقها بشكل تلقائي، كما يتم تكوين التدفق وإنشاءه. عند تغيير القيمة في العمود **In Production** لمنتج 'عنصر واجهة المستخدم الدوار' في قائمة المنتجات من **_Yes_*_ إلى _*_No_ _، يتم تشغيل التدفق *لإنشاء الحدث. لرؤية هذا الحدث في مركز التوافق، انتقل إلى _* Records** **managementEvents** > .

[![يتم عرض الحدث الذي تم تشغيله بواسطة التدفق على صفحة الأحداث في مركز التوافق.](../media/SPRetention28.png) ](../media/SPRetention28.png#lightbox)

حدد الحدث لعرض التفاصيل على صفحة منتحلة. لاحظ أنه على الرغم من إنشاء الحدث، تظهر حالة الحدث أنه لم تتم معالجة SharePoint أو المستندات.

![تفاصيل الحدث.](../media/SPRetention29.png)

ولكن بعد حدوث تأخير، تظهر حالة الحدث أنه تمت معالجة SharePoint موقع SharePoint مستند.

![تظهر تفاصيل الحدث أنه تمت معالجة المستندات.](../media/SPRetention31.png)

يظهر هذا أنه قد تم بدء فترة استبقاء التسمية المطبقة على مستند منتج 'عنصر واجهة مستخدم دواعية'، استنادا إلى تاريخ حدث حدث *'* عنصر واجهة مستخدم إنتاج التوقف'. إذا افترضنا أنك قمت بتنفيذ السيناريو في بيئة الاختبار من خلال تكوين فترة استبقاء لمدة يوم واحد، يمكنك الانتقال إلى مكتبة المستندات لمستندات المنتج بعد أيام قليلة من إنشاء الحدث والتحقق من حذف المستند (بعد تشغيل مهمة الحذف في SharePoint).

### <a name="more-about-asset-ids"></a>مزيد من المعلومات حول "هويات الأصول"

كما تشرح المقالة بدء [الاستبقاء](event-driven-retention.md) عند وقوع حدث، من المهم فهم العلاقة بين أنواع الأحداث وتسميات الاستبقاء والأحداث وم IDs الأصول. إن "معرّف الأصول" هو ببساطة خاصية مستند في SharePoint OneDrive. يساعدك ذلك على تحديد المستندات التي سيتم تشغيل فترة استبقاءها بواسطة الحدث. بشكل افتراضي، SharePoint الخاصية **Asset Id** التي يمكنك استخدامها للاحتفاظ بالأحداث:

![يتم عرض الخاصية Asset Id على صفحة تفاصيل خصائص المستند.](../media/SPRetention26.png)

كما تظهر لقطة الشاشة التالية، تسمى الخاصية المدارة لم ID الأصل **ComplianceAssetId**.

[![خاصية ComplianceAssetId المدارة.](../media/SPRetention27.png) ](../media/SPRetention27.png#lightbox)

بدلا من استخدام الخاصية **Default Asset Id** كما هو حالنا في هذا السيناريو، يمكنك استخدام أي خاصية أخرى. ولكن من المهم أن تدرك أنه إذا لم تحدد اسما أو كلمات أساسية لحدث ما، فإن كل المحتوى الذي لديه تسمية من نوع الحدث هذا سيشغل فترة استبقاء الحدث.

### <a name="using-advanced-search-in-sharepoint"></a>استخدام بحث متقدم في SharePoint

في لقطة الشاشة السابقة، يمكنك رؤية أن هناك خاصية مدارة أخرى مرتبطة ملصقات الاستبقاء تسمى **علامة** التوافق تم تعيينها إلى خاصية تم تتبع ارتباطاتها. يتم **أيضا تعيين الخاصية ComplianceAssetId** المدارة إلى خاصية تم تتبع ارتباطاتها. وهذا يعني أنه يمكنك استخدام هذه الخصائص المدارة في البحث المتقدم لاسترداد كل المستندات التي تم وضع علامة عليها باستخدام تسمية استبقاء.