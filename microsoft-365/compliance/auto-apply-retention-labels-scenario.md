---
title: استخدام تسميات الاستبقاء لإدارة دورة حياة مستند SharePoint
f1.keywords:
- NOCSH
ms.author: cabailey
author: cabailey
manager: laurawi
audience: Admin
ms.topic: article
ms.service: O365-seccomp
ms.localizationpriority: high
ms.collection:
- M365-security-compliance
- SPO_Content
ms.custom:
- admindeeplinkCOMPLIANCE
- admindeeplinkSPO
search.appverid:
- MOE150
- MET150
description: كيف يمكنك استخدام تسميات الاستبقاء لإدارة دورة حياة المستندات في SharePoint باستخدام بيانات التعريف لتصنيف المحتوى وتطبيق التسميات تلقائيا واستخدام الاستبقاء المستند إلى الحدث لبدء فترة الاستبقاء.
ms.openlocfilehash: ed054995943fc5366539fb6bc524757a6a6f820e
ms.sourcegitcommit: c29fc9d7477c3985d02d7a956a9f4b311c4d9c76
ms.translationtype: MT
ms.contentlocale: ar-SA
ms.lasthandoff: 07/06/2022
ms.locfileid: "66632960"
---
# <a name="use-retention-labels-to-manage-the-lifecycle-of-documents-stored-in-sharepoint"></a>استخدام تسميات الاستبقاء لإدارة دورة حياة المستندات المخزنة في SharePoint

>*[إرشادات ترخيص Microsoft 365 للامتثال & الأمان](/office365/servicedescriptions/microsoft-365-service-descriptions/microsoft-365-tenantlevel-services-licensing-guidance/microsoft-365-security-compliance-licensing-guidance).*

تصف هذه المقالة كيفية إدارة دورة حياة المستندات المخزنة في SharePoint باستخدام تسميات الاستبقاء المطبقة تلقائيا والاستبقاء المستند إلى الحدث.

تستخدم وظيفة التطبيق التلقائي بيانات تعريف SharePoint لتصنيف المستندات. المثال في هذه المقالة هو للمستندات المتعلقة بال منتج، ولكن يمكن استخدام نفس المفاهيم لسيناريوهات أخرى. على سبيل المثال، في صناعة النفط والغاز، يمكنك استخدامه لإدارة دورة حياة المستندات حول الأصول المادية مثل منصات النفط أو سجلات السجلات أو تراخيص الإنتاج. في مجال الخدمات المالية، يمكنك إدارة مستندات الحسابات المصرفية أو الرهونات أو عقود التأمين. في القطاع العام، يمكنك إدارة تراخيص البناء أو النماذج الضريبية.

في هذه المقالة، سنلقي نظرة على بنية المعلومات وتعريف تسميات الاستبقاء. ثم سنقوم بتصنيف المستندات من خلال تطبيق التسميات تلقائيا. وأخيرا سننشئ الأحداث التي تبدأ فترة الاستبقاء.

## <a name="information-architecture"></a>بنية المعلومات

السيناريو الخاص بنا هو شركة تصنيع تستخدم SharePoint لتخزين جميع المستندات حول المنتجات التي تطورها الشركة. تتضمن هذه المستندات مواصفات المنتج والاتفاقيات مع الموردين ودلائل المستخدم. عند تخزين هذه المستندات في SharePoint من خلال نهج إدارة محتوى المؤسسة، يتم تعريف بيانات تعريف المستند، والتي يتم استخدامها لتصنيفها. يحتوي كل مستند على خصائص بيانات التعريف التالية:

- **نوع المستند** (مثل مواصفات المنتج أو الاتفاقية أو دليل المستخدم)

- **اسم المنتج**

- **الحالة** (مسودة أو نهائية)

تشكل بيانات التعريف هذه نوع محتوى أساسي يسمى *"مستند الإنتاج* " لكافة المستندات.

![بيانات تعريف وثائق جدول المنتج.](../media/SPRetention1.png)

> [!NOTE]
> يتم **استخدام خصائص** **نوع المستند** وحالته بواسطة نهج الاستبقاء لاحقا في هذا السيناريو لتصنيف تسميات الاستبقاء وتطبيقها تلقائيا.

قد يكون لدينا العديد من أنواع المحتويات التي تمثل أنواعا مختلفة من المستندات، ولكن دعونا نركز على وثائق المنتج.

في هذا السيناريو، نستخدم خدمة بيانات التعريف المدارة ومخزن المصطلحات لإنشاء مجموعة مصطلحات لنوع *المستند* وأخرى *لاسم المنتج*. لكل مجموعة مصطلحات، نقوم بإنشاء مصطلح لكل قيمة. قد يبدو الأمر مماثلا لما يلي في مخزن المصطلحات لمؤسسة SharePoint:

![عينة مجموعة مصطلحات لوثائق المنتج في مخزن المصطلحات.](../media/SPRetention2.png)

يمكن إنشاء *نوع المحتوى* ونشره باستخدام [مركز نوع المحتوى](https://support.office.com/article/manage-content-type-publishing-06f39ac0-5576-4b68-abbc-82b68334889b). يمكنك أيضا إنشاء نوع محتوى ونشره باستخدام أدوات توفير الموقع، مثل [إطار عمل توفير PnP](/sharepoint/dev/solution-guidance/pnp-provisioning-framework) أو [مخطط JSON لتصميم الموقع](/sharepoint/dev/declarative-customization/site-design-json-schema#define-a-new-content-type).

يحتوي كل منتج على موقع SharePoint مخصص يحتوي على مكتبة مستندات واحدة تم تمكين أنواع المحتويات المناسبة لها. يتم تخزين كافة المستندات في مكتبة المستندات هذه.

[![مكتبة المستندات لوثائق المنتج.](../media/SPRetention3.png) ](../media/SPRetention3.png#lightbox)

> [!NOTE]
> بدلا من وجود موقع SharePoint لكل منتج، يمكن لشركة التصنيع في هذا السيناريو استخدام Microsoft Team لكل منتج لدعم التعاون بين أعضاء الفريق، على سبيل المثال من خلال الدردشة الثابتة، واستخدام علامة التبويب **"ملفات** " في Teams لإدارة المستندات. في هذه المقالة، نركز فقط على المستندات، لذلك، سنستخدم موقعا فقط.

فيما يلي طريقة عرض لمكتبة المستندات لمنتج Spinning Widget:

[![تثبيت مكتبة مستندات عنصر واجهة المستخدم.](../media/SPRetention4.png) ](../media/SPRetention4.png#lightbox)

الآن بعد أن أصبح لدينا بنية المعلومات الأساسية لإدارة المستندات، دعونا ننظر إلى استراتيجية الاستبقاء والتخلص من المستندات التي تستخدم بيانات التعريف وكيفية تصنيف هذه المستندات.

## <a name="retention-and-disposition"></a>الاستبقاء والتصرف

تملي سياسات الامتثال وإدارة البيانات الخاصة بشركة التصنيع كيفية الحفاظ على البيانات والتخلص منها. يجب الاحتفاظ بالمستندات المتعلقة بالناتج طالما تم تصنيع المنتج ولفترة إضافية معينة. تختلف الفترة الإضافية عن مواصفات المنتج والاتفاقيات ودلائل المستخدم. يشير الجدول التالي إلى متطلبات الاستبقاء والتصرف:

|   نوع المستند            |   الاحتفاظ                            |   التصرف                                |
| -------------------------- | -------------------------------------- | -------------------------------------------- |
| مواصفات المنتج      | 5 سنوات بعد توقف الإنتاج  | حذف                                       |
| اتفاقيات المنتجات          | بعد 10 سنوات من توقف الإنتاج | مراجعة                                       |
| دلائل المستخدم                | 5 سنوات بعد توقف الإنتاج  | حذف                                       |
| كافة أنواع المستندات الأخرى | عدم الاحتفاظ بنشاط  | حذف عندما يكون المستند أقدم من 3 سنوات <br /><br /> يعتبر المستند أقدم من 3 سنوات إذا لم يتم تعديله خلال آخر 3 سنوات. |
|||

نستخدم مدخل التوافق في Microsoft Purview لإنشاء [تسميات الاستبقاء](retention.md#retention-labels) التالية:

  - مواصفات المنتج

  - اتفاقية المنتج

  - دليل المستخدم

في هذه المقالة، نعرض فقط كيفية إنشاء تسمية استبقاء مواصفات المنتج وتطبيقها تلقائيا. لتنفيذ السيناريو الكامل، يمكنك أيضا إنشاء تسميات استبقاء وتطبيقها تلقائيا لنوعي المستندات الآخرين.

### <a name="settings-for-the-product-specification-retention-label"></a>إعدادات تسمية استبقاء مواصفات المنتج

فيما يلي [خطة الملف](file-plan-manager.md) لتسمية استبقاء مواصفات المنتج:

- **اسم:** مواصفات المنتج

- **وصف المستخدمين:** الاحتفاظ لمدة 5 سنوات بعد توقف الإنتاج.

- **وصف المسؤولين:** الاحتفاظ لمدة 5 سنوات بعد توقف الإنتاج، والحذف التلقائي، والاستبقاء المستند إلى الحدث، ونوع الحدث هو *Product Retention*.

- **إجراء الاستبقاء:** الاحتفاظ بها وحذفها.

- **مدة الاستبقاء:** 5 سنوات (1825 يوما).

- **تسمية السجل**: قم بتكوين تسمية الاستبقاء لوضع علامة على العناصر [كسجل](records-management.md#records)، مما يعني أنه لا يمكن بعد ذلك تعديل المستندات المسماة أو حذفها من قبل المستخدمين.

- **واصفات خطة الملفات:** لتبسيط السيناريو، لا يتم توفير واصفات ملفات اختيارية.

تعرض لقطة الشاشة التالية الإعدادات عند إنشاء تسمية استبقاء مواصفات المنتج في مدخل التوافق في Microsoft Purview. يمكنك إنشاء نوع الحدث *Product Headset* عند إنشاء تسمية الاستبقاء. راجع الإجراء في المقطع التالي.

![إعدادات الاستبقاء لتسمية "مواصفات المنتج".](../media/SPRetention5.png)

> [!NOTE]
> لتجنب انتظار 5 سنوات لحذف المستند، قم بتعيين مدة الاستبقاء إلى ***يوم واحد*** إذا كنت تعيد إنشاء هذا السيناريو في بيئة اختبار.

### <a name="create-an-event-type-when-you-create-a-retention-label"></a>إنشاء نوع حدث عند إنشاء تسمية استبقاء

1. في الصفحة **"تعريف إعدادات الاستبقاء** " في معالج إنشاء تسمية الاستبقاء، بعد **بدء فترة الاستبقاء استنادا إلى**، حدد **"إنشاء نوع حدث جديد**":

    ![إنشاء نوع حدث جديد لمربع الحوار "مواصفات المنتج".](../media/SPRetention6.png)

3. في صفحة **"Name your event type"** ، أدخل **"Product Optional"** ووصفا اختياريا. ثم حدد **"التالي**" و" **إرسال**" و" **تم**".

4. مرة أخرى في صفحة **"تعريف إعدادات الاستبقاء** "، **لبدء فترة الاستبقاء استنادا إلى**، استخدم مربع القائمة المنسدلة لتحديد نوع حدث **ProductDown** الذي أنشأته.

    إليك الشكل الذي تبدو عليه الإعدادات لتسمية استبقاء مواصفات المنتج:

   ![إعدادات تسمية "مواصفات المنتج" الجديدة.](../media/SPRetention7.png)

6. حدد **"إنشاء تسمية**"، وفي الصفحة التالية عندما ترى خيارات نشر التسمية، أو قم بتطبيق التسمية تلقائيا، أو ما عليك سوى حفظ التسمية: حدد **"ما عليك سوى حفظ التسمية في الوقت الحالي**"، ثم حدد **"تم**".

    > [!TIP]
    > للحصول على خطوات أكثر تفصيلا، راجع [إنشاء تسمية تستند فترة استبقاءها إلى حدث](event-driven-retention.md#step-1-create-a-label-whose-retention-period-is-based-on-an-event).

الآن دعونا ننظر في كيفية تطبيق تسمية الاستبقاء تلقائيا على محتوى مواصفات المنتج.

## <a name="auto-apply-retention-labels-to-documents"></a>تطبيق تسميات الاستبقاء تلقائيا على المستندات

سنستخدم لغة استعلام الكلمات الأساسية (KQL) لتطبيق تسميات الاستبقاء التي أنشأناها [تلقائيا](apply-retention-labels-automatically.md) . KQL هي اللغة المستخدمة لإنشاء استعلامات البحث. في KQL، يمكنك البحث باستخدام الكلمات الأساسية أو الخصائص المدارة. لمزيد من المعلومات، راجع [مرجع بناء جملة لغة استعلام الكلمات الأساسية (KQL](/sharepoint/dev/general-development/keyword-query-language-kql-syntax-reference)).

بشكل أساسي، نريد أن نخبر Microsoft 365 ب "تطبيق تسمية استبقاء **مواصفات المنتج** على كافة المستندات التي لها **حالة** **نهائية** **ونوع مستند** من **مواصفات المنتج**". تذكر أن **الحالة** **ونوع المستند** هما أعمدة الموقع التي قمنا بتعريفها لنوع محتوى وثائق المنتج في قسم [بنية المعلومات](#information-architecture) . للقيام بذلك، نحتاج إلى تكوين مخطط البحث.

عندما يقوم SharePoint بفهرسة المحتوى، فإنه ينشئ تلقائيا خصائص تم تتبع ارتباطاتها لكل عمود موقع. لهذا السيناريو، نحن مهتمون بخصائص **نوع المستند** **وحالته** . نحن بحاجة إلى مستندات في المكتبة التي هي نوع المحتوى المناسب وملء أعمدة الموقع للبحث لإنشاء الخصائص التي تم تتبع ارتباطاتها.

في <a href="https://go.microsoft.com/fwlink/?linkid=2185219" target="_blank">مركز إدارة SharePoint</a>، افتح تكوين البحث، وحدد **"إدارة مخطط البحث** " لعرض الخصائص التي تم تتبع ارتباطاتها وتكوينها.

![الخصائص التي تم تتبع ارتباطاتها في مخطط البحث.](../media/SPRetention8.png)

إذا قمنا بكتابة ***status** _ في المربع _ *Crawled properties** وحددنا السهم الأخضر، يجب أن نرى نتيجة مثل هذا:

![الخاصية ows_Status التي تم تتبع ارتباطاتها.](../media/SPRetention9.png)

خاصية **حالة ows\_\_** (لاحظ السطر السفلي المزدوج) هي تلك التي تهمنا. يتم تعيينه إلى الخاصية **"الحالة** " لنوع محتوى "مستند الإنتاج".

الآن، إذا قمنا ***بكتابة مستند ows\_*** وحددنا السهم الأخضر، يجب أن نرى شيئا مثل هذا:

![الخاصية ows_Doc_Type التي تم تتبع ارتباطاتها.](../media/SPRetention10.png)

خاصية **ows\_Doc\_x0020\_Type** هي الخاصية الثانية التي تهمنا. يتم تعيينه إلى **الخاصية "نوع المستند** " لنوع محتوى "مستند الإنتاج".

> [!TIP]
> لتعريف اسم خاصية تم تتبع ارتباطاتها لهذا السيناريو، انتقل إلى مكتبة المستندات التي تحتوي على مستندات الإنتاج. ثم انتقل إلى إعدادات المكتبة. بالنسبة **للأعمدة**، حدد اسم العمود (على سبيل المثال، **الحالة** أو **نوع المستند**) لفتح صفحة عمود الموقع. تحتوي معلمة *الحقل* في URL لتلك الصفحة على اسم الحقل. اسم الحقل هذا، مسبوق ب "ows_"، هو اسم الخاصية التي تم تتبع ارتباطاتها. على سبيل المثال، يتوافق URL `https://tenantname.sharepoint.com/sites/SpinningWidget/_layouts/15/FldEdit.aspx?List=%7BC38C2F45-3BD6-4C3B-AA3B-EF5DF6B3D172%7D&Field=_Status` مع *الخاصية "حالة ows\_\_*" التي تم تتبع ارتباطاتها.

إذا لم تظهر الخصائص التي تم تتبع ارتباطاتها التي تبحث عنها في القسم "إدارة مخطط البحث" في مركز إدارة SharePoint:

- ربما لم تتم فهرسة المستندات. يمكنك فرض إعادة فهرسة المكتبة بالانتقال إلى **الإعدادات المتقدمة لإعدادات** >  مكتبة المستندات.

- إذا كانت مكتبة المستندات موجودة في موقع حديث، فتأكد من أن مسؤول SharePoint هو أيضا مسؤول مجموعة مواقع مشتركة.

لمزيد من المعلومات حول الخصائص المدارة والمتتبعة، راجع [الخصائص المدارة التي تم إنشاؤها تلقائيا في SharePoint Server](/sharepoint/technical-reference/automatically-created-managed-properties-in-sharepoint).

### <a name="map-crawled-properties-to-pre-defined-managed-properties"></a>تعيين الخصائص التي تم تتبع ارتباطاتها إلى خصائص مدارة معرفة مسبقا

لا يمكن ل KQL استخدام الخصائص التي تم تتبع ارتباطاتها في استعلامات البحث. يجب أن تستخدم خاصية مدارة. في سيناريو بحث نموذجي، نقوم بإنشاء خاصية مدارة وتعيينها إلى الخاصية التي تم تتبع ارتباطاتها التي نحتاجها. ومع ذلك، لتطبيق تسميات الاستبقاء تلقائيا، يمكنك فقط تحديد الخصائص المدارة المعرفة مسبقا في KQL، وليس الخصائص المدارة المخصصة. هناك مجموعة من الخصائص المدارة المعرفة مسبقا في النظام لسلسلة *RefinableString00* إلى *RefinableString199* التي يمكنك استخدامها. للحصول على قائمة كاملة، راجع [الخصائص المدارة غير المستخدمة الافتراضية](/sharepoint/manage-search-schema#default-unused-managed-properties). تستخدم هذه الخصائص المدارة الافتراضية عادة لتعريف مدققات البحث.

لكي يقوم استعلام KQL بتطبيق تسمية الاستبقاء الصحيحة تلقائيا على محتوى مستند المنتج، نقوم بتعيين الخصائص التي تم تتبع ارتباطاتها إلى **نوع المستند\_x0020\_وتعيين الحالة إلى اثنتين من الخصائص المدارة القابلة للتنقيح.\_* *\_\_** في بيئة الاختبار الخاصة بنا لهذا السيناريو، لا يتم استخدام **RefinableString00** و **RefinableString01** . لقد حددنا ذلك من خلال النظر إلى **"الخصائص المدارة** " في **"إدارة مخطط البحث** " في <a href="https://go.microsoft.com/fwlink/?linkid=2185219" target="_blank">مركز إدارة SharePoint</a>.

[![الخصائص المدارة في مخطط البحث.](../media/SPRetention12.png) ](../media/SPRetention12.png#lightbox)

لاحظ أن عمود **الخصائص المعينة التي تم تتبع ارتباطاتها** في لقطة الشاشة السابقة فارغ.

لتعيين **الخاصية ows\_Doc\_x0020\_Type** التي تم تتبع ارتباطاتها، اتبع الخطوات التالية:

1. في مربع تصفية **الخاصية المدارة** ، اكتب **_RefinableString00_** وحدد السهم الأخضر.

2. في قائمة النتائج، حدد الارتباط **RefinableString00** ، ثم قم بالتمرير لأسفل وصولا إلى **"التعيينات" لقسم الخصائص التي تم تتبع ارتباطاتها** .

3. حدد **"إضافة تعيين**"، ثم اكتب **_ows\_Doc\_x0020\_Type_*_ في مربع _* Search for a crawled property name** in the **Crawled property selection** window. حدد **"بحث**".

4. في قائمة النتائج، حدد **ows\_Doc\_x0020\_Type** ثم حدد **"OK**".

   في قسم **"الخصائص التي تم تتبع ارتباطاتها" المعينة** ، يجب أن ترى شيئا مشابها للقطة الشاشة هذه:

   [![حدد إضافة تعيين في قسم الخصائص التي تم تتبع ارتباطاتها المعينة.](../media/SPRetention13.png) ](../media/SPRetention13.png#lightbox)


5. قم بالتمرير إلى أسفل الصفحة وحدد **"موافق** " لحفظ التعيين.

كرر هذه الخطوات لتعيين **RefinableString01** **وows\_\_Status**.

الآن يجب أن يكون لديك اثنين من الخصائص المدارة المعينة إلى الخاصيتين المتتبعتين:

[![الخصائص المدارة المعروضة معينة إلى الخصائص التي تم تتبع ارتباطاتها.](../media/SPRetention14.png) ](../media/SPRetention14.png#lightbox)

دعونا نتحقق من صحة إعدادنا عن طريق تشغيل بحث المؤسسة. في المستعرض، انتقل إلى *https://\<your_tenant>.sharepoint.com/search*. في مربع البحث، اكتب ***RefinableString00:"Product Specification"** _ واضغط على مفتاح الإدخال Enter. يجب أن يرجع هذا البحث كافة المستندات التي تحتوي على _ *Product Specification** من **_نوع المستند_**.

الآن في مربع البحث، اكتب **RefinableString00:"Product Specification" AND RefinableString01:Final** واضغط على مفتاح الإدخال Enter. يجب أن يؤدي ذلك إلى إرجاع كافة المستندات التي تحتوي **على مواصفات المنتج** ل **_Doc Type_*_ و_* Status** of **_Final_**.

### <a name="create-auto-apply-label-policies"></a>إنشاء نهج تطبيق تلقائي للتسمية

الآن بعد أن تحققنا من أن استعلام KQL يعمل، دعنا ننشئ نهج تسمية تطبيق تلقائي يستخدم استعلام KQL لتطبيق تسمية استبقاء مواصفات المنتج تلقائيا على المستندات المناسبة.

1. في <a href="https://go.microsoft.com/fwlink/p/?linkid=2077149" target="_blank">مدخل التوافق في Microsoft Purview</a>، انتقل إلى **نهج** >  تسمية **إدارة** >  السجلات **لتطبيق تسمية تلقائيا**.

   [![حدد "تطبيق تسمية تلقائيا" على صفحة](../media/SPRetention16.png) التسميات ](../media/SPRetention16.png#lightbox)

2. في معالج إنشاء نهج التسمية التلقائية، في صفحة **"تسمية نهج التسمية التلقائية** "، أدخل اسما مثل **تطبيق تسمية "مواصفات المنتج تلقائيا"**، ووصفا اختياريا. ثم حدد **"التالي**".

3. في **"اختيار نوع المحتوى" الذي تريد تطبيق هذه التسمية على** الصفحة، حدد **"تطبيق تسمية" على المحتوى الذي يحتوي على كلمات أو عبارات أو خصائص معينة**، ثم حدد **"التالي**".

   [![حدد تطبيق تسمية على المحتوى الذي يحتوي على كلمات أو عبارات أو خصائص معينة.](../media/SPRetention17.png) ](../media/SPRetention17.png#lightbox)

   يتيح لنا هذا الخيار توفير نفس استعلام بحث KQL الذي قمنا باختباره في القسم السابق. يقوم الاستعلام بإرجاع كافة مستندات "مواصفات المنتج" التي لها حالة *"نهائي*". عندما نستخدم هذا الاستعلام نفسه في نهج التطبيق التلقائي للتسمية، سيتم تطبيق تسمية استبقاء مواصفات المنتج تلقائيا على جميع المستندات التي تتطابق معها.

4. **في التسمية "تطبيق" على محتوى مطابق لصفحة الاستعلام هذه**، اكتب **RefinableString00:"Product Specification" AND RefinableString01:Final**، ثم حدد **"التالي**".

   ![حدد الاستعلام في مربع محرر استعلام الكلمة الأساسية.](../media/SPRetention19.png)

5. في **"اختيار المواقع" لتطبيق صفحة النهج** ، يمكنك تحديد مواقع المحتوى التي تريد تطبيق النهج عليها. بالنسبة لهذا السيناريو، نقوم بتطبيق النهج فقط على مواقع SharePoint، لأنه يتم تخزين كافة مستندات الإنتاج في مكتبات مستندات SharePoint. تبديل حالة **البريد الإلكتروني في Exchange** **وحسابات OneDrive** **مجموعات Microsoft 365** إلى **إيقاف التشغيل**. تأكد من تعيين حالة مواقع SharePoint إلى **"تشغيل** " قبل تحديد **"التالي"**:

    ![اختر مواقع معينة لتطبيق التسميات عليها تلقائيا.](../media/SPRetentionSPlocations.png)

   > [!TIP]
   > بدلا من تطبيق النهج على كافة مواقع SharePoint، يمكنك تحديد **"اختيار موقع** " وإضافة عناوين URL لمواقع SharePoint معينة.

6. في صفحة **"اختيار تسمية" لتطبيقها تلقائيا** ، حدد **"إضافة تسمية**".

7. من قائمة تسميات الاستبقاء، حدد **"مواصفات المنتج**". ثم حدد **"إضافة** " و" **التالي**".

8. راجع الإعدادات:

    ![إعدادات لتطبيق التسمية تلقائيا.](../media/SPRetention18.png)

9. حدد **"إرسال** " لإنشاء نهج تطبيق التسمية تلقائيا.

   > [!NOTE]
   > يستغرق الأمر ما يصل إلى 7 أيام لتطبيق تسمية "مواصفات المنتج" تلقائيا على كافة المستندات التي تتطابق مع استعلام البحث KQL.

### <a name="verify-that-the-retention-label-was-automatically-applied"></a>تحقق من تطبيق تسمية الاستبقاء تلقائيا

بعد 7 أيام، استخدم [مستكشف النشاط](data-classification-activity-explorer.md) في مدخل التوافق في Microsoft Purview للتحقق من تطبيق نهج التسمية تلقائيا الذي أنشأناه تلقائيا على مستندات المنتج.

انظر أيضا إلى خصائص المستندات في مكتبة المستندات. في لوحة المعلومات، يمكنك رؤية تطبيق تسمية الاستبقاء على مستند محدد.

[![تحقق من تطبيق التسمية من خلال النظر إلى خصائص المستند في مكتبة المستندات.](../media/SPRetention21.png) ](../media/SPRetention21.png#lightbox)

نظرا لتطبيق تسميات الاستبقاء تلقائيا على المستندات، فإن هذه المستندات محمية من الحذف لأنه تم تكوين تسمية الاستبقاء للإعلان عن المستندات *كسجلات*. كمثال على هذه الحماية، نحصل على رسالة الخطأ التالية عندما نحاول حذف أحد هذه المستندات:

[![تظهر رسالة خطأ أنه لا يمكن حذف المستندات لأن التسمية تعلن أن المستندات عبارة عن سجلات.](../media/SPRetention22.png) ](../media/SPRetention22.png#lightbox)

## <a name="generate-the-event-that-triggers-the-retention-period"></a>إنشاء الحدث الذي يشغل فترة الاستبقاء

الآن بعد تطبيق تسميات الاستبقاء، دعونا نركز على الحدث الذي سيشير إلى نهاية الإنتاج لمنتج معين. يشغل هذا الحدث بداية فترة الاستبقاء المحددة في تسميات الاستبقاء. على سبيل المثال، بالنسبة لمستندات مواصفات المنتج، تبدأ فترة الاستبقاء لمدة 5 سنوات عند تشغيل حدث "نهاية الإنتاج".

يمكنك إنشاء الحدث يدويا في مدخل التوافق في Microsoft Purview بالانتقال إلى **أحداث** **إدارة السجلات** > . يمكنك اختيار نوع الحدث وتعيين معرفات الأصول الصحيحة وإدخال تاريخ للحدث. لمزيد من المعلومات، راجع [بدء الاستبقاء عند وقوع حدث](event-driven-retention.md).

ولكن بالنسبة لهذا السيناريو، سنقوم تلقائيا بإنشاء الحدث من نظام إنتاج خارجي. النظام عبارة عن قائمة SharePoint بسيطة تشير إلى ما إذا كان المنتج قيد الإنتاج. سيؤدي تدفق [Power Automate](/power-automate/getting-started) المقترن بالقائمة إلى تشغيل الحدث. في سيناريو العالم الحقيقي، يمكنك استخدام أنظمة مختلفة لإنشاء الحدث، مثل الموارد البشرية أو نظام إدارة علاقات العملاء. يحتوي Power Automate على العديد من التفاعلات الجاهزة للاستخدام وكتلة الإنشاء لأحمال عمل Microsoft 365، مثل Microsoft Exchange وSharePoint وTeams وDynamics 365، بالإضافة إلى تطبيقات الجهات الخارجية مثل Twitter و Box وSalesforce و Workdays. تسهل هذه الميزة دمج Power Automate مع الأنظمة المختلفة. لمزيد من المعلومات، راجع [الاستبقاء المستند إلى الحدث تلقائيا](./event-driven-retention.md#automate-events-by-using-a-rest-api).

تعرض لقطة الشاشة التالية قائمة SharePoint التي سيتم استخدامها لتشغيل الحدث:

[![القائمة التي ستقوم بتشغيل حدث الاستبقاء.](../media/SPRetention23.png) ](../media/SPRetention23.png#lightbox)

هناك منتجان قيد الإنتاج حاليا، كما هو موضح في العمود ***Yes** _ في العمود _ *In Production**. عند تعيين القيمة الموجودة في هذا العمود إلى **_"لا_** " لمنتج ما، سيقوم التدفق المقترن بالقائمة بإنشاء الحدث تلقائيا. يشغل الحدث بداية فترة الاستبقاء لتسمية الاستبقاء التي تم تطبيقها تلقائيا على مستندات المنتج المقابلة.

بالنسبة لهذا السيناريو، نستخدم التدفق التالي لتشغيل الحدث:

[![تكوين التدفق الذي سيؤدي إلى تشغيل الحدث.](../media/SPRetention24.png) ](../media/SPRetention24.png#lightbox)

لإنشاء هذا التدفق، ابدأ من موصل SharePoint وحدد المشغل **"عند إنشاء عنصر أو تعديله** ". حدد عنوان الموقع واسم القائمة. ثم أضف شرطا استنادا إلى وقت تعيين قيمة عمود قائمة **"في الإنتاج** " إلى **_No_* _ (أو يساوي _false* على بطاقة الشرط). ثم أضف إجراء استنادا إلى قالب HTTP المضمن. استخدم القيم الموجودة في القسم التالي لتكوين إجراء HTTP. يمكنك نسخ قيم خصائص **URI** **والنص الأساسي** من القسم التالي ولصقها في القالب.

- **الأسلوب**: POST
- **URI**: `https://ps.compliance.protection.outlook.com/psws/service.svc/ComplianceRetentionEvent`
- **الرؤوس**: Key = Content-Type, Value = application/atom+xml
- **النص الأساسي**:

    ```xml
    <?xml version='1.0' encoding='utf-8' standalone='yes'>
    <entry xmlns:d='http://schemas.microsoft.com/ado/2007/08/dataservices' xmlns:m='http://schemas.microsoft.com/ado/2007/08/dataservices/metadata' xmlns='https://www.w3.org/2005/Atom'>
    <category scheme='http://schemas.microsoft.com/ado/2007/08/dataservices/scheme' term='Exchange.ComplianceRetentionEvent'>
    <updated>9/9/2017 10:50:00 PM</updated>
    <content type='application/xml'>
    <m:properties>
    <d:Name>Cessation Production @{triggerBody()?['Product_x0020_Name']?['Value']}</d:Name>
    <d:EventType>Product Cessation&lt;</d:EventType>
    <d:SharePointAssetIdQuery>ProductName:&quot;@{triggerBody()?['Product_x0020_Name']?['Value']}<d:SharePointAssetIdQuery>
    <d:EventDateTime>@{formatDateTime(utcNow(),'yyyy-MM-dd')}</d:EventDateTime>
    </m:properties>
    </content&gt>
    </entry>
    ```

تصف هذه القائمة المعلمات الموجودة في خاصية **النص الأساسي** للإجراء الذي يجب تكوينه لهذا السيناريو:

- **الاسم**: تحدد هذه المعلمة اسم الحدث الذي سيتم إنشاؤه في مدخل التوافق في Microsoft Purview. بالنسبة لهذا السيناريو، الاسم هو " *Xxx* الإنتاج الفوري"، حيث *xxx* هو قيمة **الخاصية المدارة ProductName** التي أنشأناها سابقا.
- **EventType**: تتوافق قيمة هذه المعلمة مع نوع الحدث الذي سيتم تطبيق الحدث الذي تم إنشاؤه عليه. تم تعريف نوع الحدث هذا عند إنشاء تسمية الاستبقاء. بالنسبة إلى هذا السيناريو، يكون نوع الحدث هو "Product Headset".
- **SharePointAssetIdQuery**: تعرف هذه المعلمة معرف الأصل للحدث. يحتاج الاستبقاء المستند إلى الحدث إلى معرف فريد للمستند. يمكننا استخدام معرفات الأصول لتحديد المستندات التي ينطبق عليها حدث معين أو، كما هو الحال في هذا السيناريو، **اسم المنتج** لعمود بيانات التعريف. للقيام بذلك، نحتاج إلى إنشاء خاصية مدارة جديدة **ل ProductName** يمكن استخدامها في استعلام KQL. (بدلا من ذلك، يمكننا استخدام **RefinableString00** بدلا من إنشاء خاصية مدارة جديدة). نحتاج أيضا إلى تعيين هذه الخاصية المدارة الجديدة إلى **الخاصية ows_Product_x0020_Name** التي تم تتبع ارتباطاتها. فيما يلي لقطة شاشة لهذه الخاصية المدارة.

    [![الخاصية المدارة للتأجير.](../media/SPRetention25.png) ](../media/SPRetention25.png#lightbox)

- **EventDateTime**: تحدد هذه المعلمة تاريخ وقوع الحدث. استخدم تنسيق التاريخ الحالي:<br/><br/>*formatDateTime(utcNow(),'yyyy-MM-dd'*)

### <a name="putting-it-all-together"></a>وضع كل شيء معا

الآن يتم إنشاء تسمية الاستبقاء وتطبيقها تلقائيا، ويتم تكوين التدفق وإنشاءه. عند تغيير القيمة الموجودة في العمود **"In Production**" لمنتج عنصر واجهة المستخدم "Spinning Widget" في قائمة المنتجات من **_Yes_*_ إلى _*_No_*_، يتم تشغيل التدفق لإنشاء الحدث. لمشاهدة هذا الحدث في مدخل التوافق في Microsoft Purview، انتقل إلى _* Records management** > **Events**.

[![يتم عرض الحدث الذي تم تشغيله بواسطة التدفق على صفحة الأحداث في مدخل التوافق في Microsoft Purview.](../media/SPRetention28.png) ](../media/SPRetention28.png#lightbox)

حدد الحدث لعرض التفاصيل في صفحة القائمة المنبثقة. لاحظ أنه على الرغم من إنشاء الحدث، تظهر حالة الحدث أنه لم تتم معالجة أي مواقع أو مستندات في SharePoint.

![تفاصيل الحدث.](../media/SPRetention29.png)

ولكن بعد حدوث تأخير، تظهر حالة الحدث أنه تمت معالجة موقع SharePoint ومستند SharePoint.

![توضح تفاصيل الحدث أنه تمت معالجة المستندات.](../media/SPRetention31.png)

يوضح هذا أنه تم بدء فترة الاستبقاء للتسمية المطبقة على مستند منتج Spinning Widget، استنادا إلى تاريخ الحدث الخاص بحدث عنصر *واجهة مستخدم تثبيت إنتاج الإنتاج* . بافتراض أنك نفذت السيناريو في بيئة الاختبار عن طريق تكوين فترة استبقاء لمدة يوم واحد، يمكنك الانتقال إلى مكتبة المستندات لمستندات المنتج بعد بضعة أيام من إنشاء الحدث والتحقق من حذف المستند (بعد تشغيل مهمة الحذف في SharePoint).

### <a name="more-about-asset-ids"></a>المزيد حول معرفات الأصول

كما توضح المقالة ["بدء الاستبقاء عند وقوع حدث](event-driven-retention.md) "، من المهم فهم العلاقة بين أنواع الأحداث وتسميات الاستبقاء والأحداث ومعرف الأصول. معرف الأصل هو ببساطة خاصية مستند في SharePoint وOneDrive. يساعدك على تحديد المستندات التي سيتم تشغيل فترة الاستبقاء فيها بواسطة الحدث. بشكل افتراضي، يحتوي SharePoint على خاصية **"معرف الأصل"** التي يمكنك استخدامها للاستبقاء المستند إلى الحدث:

![يتم عرض خاصية "معرف الأصل" على صفحة تفاصيل خصائص المستند.](../media/SPRetention26.png)

كما تظهر لقطة الشاشة التالية، تسمى الخاصية المدارة بمعرف الأصل **ComplianceAssetId**.

[![الخاصية المدارة ComplianceAssetId.](../media/SPRetention27.png) ](../media/SPRetention27.png#lightbox)

بدلا من استخدام خاصية **معرف الأصل** الافتراضية كما نفعل في هذا السيناريو، يمكنك استخدام أي خاصية أخرى. ولكن من المهم أن نفهم أنه إذا لم تحدد معرف أصل أو كلمات أساسية لحدث ما، فسيحصل كل المحتوى الذي يحتوي على تسمية من هذا النوع من الأحداث على فترة الاستبقاء الخاصة به التي يشغلها الحدث.

### <a name="using-advanced-search-in-sharepoint"></a>استخدام البحث المتقدم في SharePoint

في لقطة الشاشة السابقة، يمكنك أن ترى أن هناك خاصية أخرى مدارة تتعلق بتسميات الاستبقاء تسمى **ComplianceTag** التي تم تعيينها إلى خاصية تم تتبع ارتباطاتها. كما يتم تعيين الخاصية المدارة **ComplianceAssetId** إلى خاصية تم تتبع ارتباطاتها. وهذا يعني أنه يمكنك استخدام هذه الخصائص المدارة في البحث المتقدم لاسترداد كافة المستندات التي تم وضع علامة عليها باستخدام تسمية استبقاء.
